"use strict";function _typeof(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function i(i,o){try{var a=e[i](o),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(r,s)}var r=i.bind(null,"next"),s=i.bind(null,"throw");r()})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t){function e(t,e,n,r){var s=Object.create((e||i).prototype),o=new f(r||[]);return s._invoke=c(t,n,o),s}function n(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(i){return{type:"throw",arg:i}}}function i(){}function r(){}function s(){}function o(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function a(t){this.arg=t}function u(t){function e(i,r,s,o){var u=n(t[i],t,r);if("throw"!==u.type){var c=u.arg,l=c.value;return l instanceof a?Promise.resolve(l.arg).then(function(t){e("next",t,s,o)},function(t){e("throw",t,s,o)}):Promise.resolve(l).then(function(t){c.value=t,s(c)},o)}o(u.arg)}function i(t,n){function i(){return new Promise(function(i,r){e(t,n,i,r)})}return r=r?r.then(i,i):i()}"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.domain&&(e=process.domain.bind(e));var r;this._invoke=i}function c(t,e,i){var r=k;return function(s,o){if(r===x)throw new Error("Generator is already running");if(r===S){if("throw"===s)throw o;return p()}for(;;){var a=i.delegate;if(a){if("return"===s||"throw"===s&&a.iterator[s]===v){i.delegate=null;var u=a.iterator["return"];if(u){var c=n(u,a.iterator,o);if("throw"===c.type){s="throw",o=c.arg;continue}}if("return"===s)continue}var c=n(a.iterator[s],a.iterator,o);if("throw"===c.type){i.delegate=null,s="throw",o=c.arg;continue}s="next",o=v;var l=c.arg;if(!l.done)return r=L,l;i[a.resultName]=l.value,i.next=a.nextLoc,i.delegate=null}if("next"===s)r===L?i.sent=o:i.sent=v;else if("throw"===s){if(r===k)throw r=S,o;i.dispatchException(o)&&(s="next",o=v)}else"return"===s&&i.abrupt("return",o);r=x;var c=n(t,e,i);if("normal"===c.type){r=i.done?S:L;var l={value:c.arg,done:i.done};if(c.arg!==E)return l;i.delegate&&"next"===s&&(o=v)}else"throw"===c.type&&(r=S,s="throw",o=c.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function f(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function d(t){if(t){var e=t[g];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(m.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=v,r.done=!0,r};return i.next=i}}return{next:p}}function p(){return{value:v,done:!0}}var v,m=Object.prototype.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},g=y.iterator||"@@iterator",b=y.toStringTag||"@@toStringTag",_="object"===("undefined"==typeof module?"undefined":_typeof(module)),w=t.regeneratorRuntime;if(w)return void(_&&(module.exports=w));w=t.regeneratorRuntime=_?module.exports:{},w.wrap=e;var k="suspendedStart",L="suspendedYield",x="executing",S="completed",E={},T=s.prototype=i.prototype;r.prototype=T.constructor=s,s.constructor=r,s[b]=r.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return e?e===r||"GeneratorFunction"===(e.displayName||e.name):!1},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(T),t},w.awrap=function(t){return new a(t)},o(u.prototype),w.async=function(t,n,i,r){var s=new u(e(t,n,i,r));return w.isGeneratorFunction(n)?s:s.next().then(function(t){return t.done?t.value:s.next()})},o(T),T[g]=function(){return this},T[b]="Generator",T.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},w.values=d,f.prototype={constructor:f,reset:function(t){if(this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return s.type="throw",s.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var o=m.call(r,"catchLoc"),a=m.call(r,"finallyLoc");if(o&&a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&m.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?this.next=r.finallyLoc:this.complete(s),E},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),E}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;h(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},E}}}("object"===("undefined"==typeof global?"undefined":_typeof(global))?global:"object"===("undefined"==typeof window?"undefined":_typeof(window))?window:"object"===("undefined"==typeof self?"undefined":_typeof(self))?self:void 0);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.favorites=document.querySelector(".favorite"),null!==this.favorites){var t=this.favorites.querySelectorAll(".product");if(this.count=t.length,0==this.count)return this.favorites.parentNode.removeChild(this.favorites),delete this.count,void delete this.favorites;if(this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.wrapper=this.favorites.querySelector(".favorite__wrapper-inner"),this.next_button=this.favorites.querySelector(".favorite__button_next"),this.prev_button=this.favorites.querySelector(".favorite__button_prev"),this.menu=this.favorites.querySelector(".favorite__menu"),this.next_button.addEventListener("click",this.next.bind(this)),this.prev_button.addEventListener("click",this.prev.bind(this)),this.margin=20,this.current=0,this.width=t[0].offsetWidth+this.margin,this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?this.menu.classList.toggle("favorite__menu_hidden",!0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.animation=!1,this.timer=null,this.transitions){var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(e[Modernizr.prefixed("transition")],this.stopAnimation.bind(this))}window.addEventListener("resize",this.resize.bind(this))}}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"stopAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.animation=!1}},{key:"dropAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),250)}},{key:"next",value:function(){this.current++,this.current==this.count-this.inline+1&&(this.current=0),this.scroll(),this.next_button.blur()}},{key:"prev",value:function(){this.current--,-1==this.current&&(this.current=this.count-this.inline),this.scroll(),this.prev_button.blur()}},{key:"resize",value:function(){this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?(this.menu.classList.toggle("favorite__menu_hidden",!0),this.current=0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.scroll()}},{key:"scroll",value:function(){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.width*this.current+"px)":this.wrapper.style.right=-this.width*this.current+"px",this.dropAnimation()}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.navigation=document.querySelector(".navigation"),null!==this.navigation){var e=this.navigation.querySelectorAll(".navigation__label");[].forEach.call(e,function(e){e.addEventListener("click",t.openDropdown.bind(t))}),this.toggle=document.querySelector(".navigation__toggle"),this.toggle.addEventListener("click",this.toggleNavigation.bind(this))}}},{key:"toggleNavigation",value:function(){this.navigation.classList.toggle("navigation_open"),this.toggle.blur(),document.body.classList.toggle("navigation_open")}},{key:"openDropdown",value:function(t){t.currentTarget.classList.toggle("navigation__label_open"),t.currentTarget.nextElementSibling.classList.toggle("navigation__container_open")}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.scroller=document.querySelector(".scroller"),null!==this.scroller){if(this.wrapper=this.scroller.querySelector(".scroller__wrapper-inner"),this.slides=this.wrapper.querySelectorAll(".scroller__slide"),this.count=this.slides.length,0===this.count)return this.scroller.parentNode.removeChild(this.slides),delete this.wrapper,delete this.slides,delete this.scroller,void delete this.count;this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.paginator=this.scroller.querySelector(".scroller__paginator"),this.prev_button=this.scroller.querySelector(".scroller__prev"),this.next_button=this.scroller.querySelector(".scroller__next"),this.prev_button.addEventListener("click",this.openPrevSlide.bind(this)),this.next_button.addEventListener("click",this.openNextSlide.bind(this));var t=this.slides[0].cloneNode(!0),e=this.slides[this.count-1].cloneNode(!0);t.classList.add("cloned"),e.classList.add("cloned"),this.wrapper.appendChild(t),this.wrapper.insertBefore(e,this.slides[0]);for(var n=this.count;n--;)this.createButton(this.count-n-1);if(this.current_page=0,this.paginator_buttons=this.paginator.querySelectorAll(".scroller__page"),this.current_button=this.paginator_buttons[0],this.current_button.classList.add("scroller__page_current"),this.animation=!1,this.tansition_timer=null,this.transitions){var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(i[Modernizr.prefixed("transition")],this.checkIndex.bind(this))}this.moveToFirst().delay().then(this.turnOn.bind(this)),window.addEventListener("resize",this.resized.bind(this))}}},{key:"moveToCurrent",value:function(){return this.move(this.current_page),this}},{key:"moveToFirst",value:function(){return this.current_page=0,this.reposSlide(),this}},{key:"moveToLast",value:function(){return this.current_page=this.count-1,this.reposSlide(),this}},{key:"turnOn",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]=Modernizr.prefixed("transform")+" .25s",this}},{key:"turnOff",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]="none",this}},{key:"move",value:function(t){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.wrapper.offsetWidth*(t+1)+"px)":this.wrapper.style.right=-this.wrapper.offsetWidth*(t+1)+"px"}},{key:"resized",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.turnOff(),t.next=3,this.delay(25);case 3:return this.moveToCurrent(),t.next=6,this.delay(25);case 6:this.turnOn();case 7:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"delay",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){setTimeout(e,t)}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"checkIndex",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!=this.current_page){t.next=10;break}return this.turnOff(),t.next=4,this.delay(25);case 4:return this.moveToLast(),t.next=7,this.delay(25);case 7:this.turnOn(),t.next=18;break;case 10:if(this.current_page!=this.count){t.next=18;break}return this.turnOff(),t.next=14,this.delay(25);case 14:return this.moveToFirst(),t.next=17,this.delay(25);case 17:this.turnOn();case 18:this.stopAnimation();case 19:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stopAnimation",value:function(){this.animation=!1}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"dropAnimation",value:function(){"undefined"!=typeof this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),350)}},{key:"createButton",value:function(t){var e=document.createElement("BUTTON"),n=document.createElement("SPAN");e.setAttribute("type","button"),e.setAttribute("data-page",t),e.classList.add("scroller__page"),e.appendChild(n),e.addEventListener("click",this.scrollToSlide.bind(this)),this.paginator.appendChild(e)}},{key:"openSlide",value:function(){this.reposSlide(),this.dropAnimation(),this.transitions||(null!=this.tansition_timer&&clearTimeout(this.tansition_timer),this.tansition_timer=setTimeout(this.checkIndex.bind(this),250))}},{key:"openPrevSlide",value:function(){this.animation!==!0&&(this.startAnimation(),this.current_page--,this.prev_button.blur(),this.openSlide())}},{key:"openNextSlide",value:function(){this.animation!==!0&&(this.startAnimation(),this.current_page++,this.next_button.blur(),this.openSlide())}},{key:"scrollToSlide",value:function(t){if(this.animation!==!0){this.startAnimation();var e=t.currentTarget;this.current_page=parseInt(e.getAttribute("data-page"),10),e.blur(),this.openSlide()}}},{key:"reposSlide",value:function(){this.current_button.classList.toggle("scroller__page_current",!1),this.current_button=this.paginator_buttons[Math.min(Math.max(this.current_page,0),this.count-1)],this.current_button.classList.toggle("scroller__page_current",!0),this.move(this.current_page)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){this.form=document.querySelector(".subscribe"),null!==this.form&&(this.input=this.form.querySelector(".subscribe__email"),this.success_message=this.form.querySelector(".subscribe__state_success"),this.success_fail=this.form.querySelector(".subscribe__state_fail"),this.success_progress=this.form.querySelector(".subscribe__state_in-progress"),this.form.setAttribute("novalidate",!0),this.form.addEventListener("submit",this.validateForm.bind(this)))}},{key:"validateForm",value:function(t){var e=this;t.preventDefault();var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$");if(this.input.value.trim().length>0&&n.test(this.input.value.trim())===!1||0===this.input.value.trim().length||0===this.input.value.trim().length)return void this.setState("fail");var i=4,r=200,s=new XMLHttpRequest,o=new Promise(function(t,n){try{s.open("GET","js/subscribe.json"),s.send(new FormData(e.form)),s.onreadystatechange=function(){s.readyState===i&&(e.form.reset(),e.setState(),s.status===r?t(s.response):n(new Error(s.code+": "+s.statusText)))}}catch(o){n(o)}});this.setState("progress"),o.then(this.success.bind(this))["catch"](this.fail.bind(this))}},{key:"success",value:function(t){var e=JSON.parse(t);e.success?this.setState("success"):this.setState("fail")}},{key:"fail",value:function(t){this.setState("fail")}},{key:"setState",value:function(t){var e=!1,n=!1,i=!1;switch(t){case"fail":e=!0,this.input.focus();break;case"success":n=!0,this.input.blur();break;case"progress":i=!0}this.form.classList.toggle("subscribe_fail",e),this.form.classList.toggle("subscribe_success",n),this.form.classList.toggle("subscribe_progress",i)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.widget=document.querySelector(".tabs"),null!==this.widget){var t=4,e=200,n=new XMLHttpRequest,i=new Promise(function(i,r){try{n.open("GET","js/tabs.json"),n.send(),n.onreadystatechange=function(){n.readyState===t&&(n.status===e?i(n.response):r(new Error(n.code+": "+n.statusText)))}}catch(s){r(s)}});i.then(this.build.bind(this))}}},{key:"build",value:function(t){var e=JSON.parse(t.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f"));if(this.current_button=null,this.current_tab=null,0==e.length)return this.widget.parentNode.removeChild(this.widget),void delete this.widget;var n=document.createElement("MENU");n.setAttribute("type","toolbar"),n.classList.add("tabs__menu"),this.widget.appendChild(n);var i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var u=o.value,c=document.createElement("BUTTON"),l=document.createElement("SECTION"),h=u.Content.split("\n\n");c.setAttribute("type","button"),c.setAttribute("data-target",u.Title),c.classList.add("tabs__button"),c.appendChild(document.createTextNode(u.Title)),c.addEventListener("click",this.openTab.bind(this)),n.appendChild(c),l.setAttribute("data-tab",u.Title),l.classList.add("tabs__tab");var f=!0,d=!1,p=void 0;try{for(var v,m=h[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var y=v.value,g=document.createElement("P");g.appendChild(document.createTextNode(y)),l.appendChild(g)}}catch(b){d=!0,p=b}finally{try{!f&&m["return"]&&m["return"]()}finally{if(d)throw p}}this.widget.appendChild(l)}}catch(b){r=!0,s=b}finally{try{!i&&a["return"]&&a["return"]()}finally{if(r)throw s}}n.querySelector("button").click(),this.widget.classList.add("tabs_builded")}},{key:"openTab",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-target");null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!1),null!=this.current_button&&this.current_button.classList.toggle("tabs__button_current",!1),this.current_button=e,this.current_button.classList.toggle("tabs__button_current",!0),this.current_tab=this.widget.querySelector("[data-tab="+n+"]"),null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!0)}}]),t}();new t}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiLCJydW50aW1lLmpzIiwiZmF2b3JpdGUuanMiLCJuYXZpZ2F0aW9uLmpzIiwic2Nyb2xsZXIuanMiLCJzdWJzY3JpYmUuanMiLCJ0YWJzLmpzIl0sIm5hbWVzIjpbIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJjb25zdHJ1Y3RvciIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfYXN5bmNUb0dlbmVyYXRvciIsImZuIiwiZ2VuIiwiYXBwbHkiLCJ0aGlzIiwiYXJndW1lbnRzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdGVwIiwia2V5IiwiYXJnIiwiaW5mbyIsInZhbHVlIiwiZXJyb3IiLCJkb25lIiwidGhlbiIsImNhbGxOZXh0IiwiY2FsbFRocm93IiwiYmluZCIsImdsb2JhbCIsIndyYXAiLCJpbm5lckZuIiwib3V0ZXJGbiIsInNlbGYiLCJ0cnlMb2NzTGlzdCIsImdlbmVyYXRvciIsIk9iamVjdCIsImNyZWF0ZSIsIkdlbmVyYXRvciIsInByb3RvdHlwZSIsImNvbnRleHQiLCJDb250ZXh0IiwiX2ludm9rZSIsIm1ha2VJbnZva2VNZXRob2QiLCJ0cnlDYXRjaCIsInR5cGUiLCJjYWxsIiwiZXJyIiwiR2VuZXJhdG9yRnVuY3Rpb24iLCJHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSIsImRlZmluZUl0ZXJhdG9yTWV0aG9kcyIsImZvckVhY2giLCJtZXRob2QiLCJBd2FpdEFyZ3VtZW50IiwiQXN5bmNJdGVyYXRvciIsImludm9rZSIsInJlY29yZCIsInJlc3VsdCIsInVud3JhcHBlZCIsImVucXVldWUiLCJjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyIsInByZXZpb3VzUHJvbWlzZSIsInByb2Nlc3MiLCJkb21haW4iLCJzdGF0ZSIsIkdlblN0YXRlU3VzcGVuZGVkU3RhcnQiLCJHZW5TdGF0ZUV4ZWN1dGluZyIsIkVycm9yIiwiR2VuU3RhdGVDb21wbGV0ZWQiLCJkb25lUmVzdWx0IiwiZGVsZWdhdGUiLCJpdGVyYXRvciIsInVuZGVmaW5lZCIsInJldHVybk1ldGhvZCIsIkdlblN0YXRlU3VzcGVuZGVkWWllbGQiLCJyZXN1bHROYW1lIiwibmV4dCIsIm5leHRMb2MiLCJzZW50IiwiZGlzcGF0Y2hFeGNlcHRpb24iLCJhYnJ1cHQiLCJDb250aW51ZVNlbnRpbmVsIiwicHVzaFRyeUVudHJ5IiwibG9jcyIsImVudHJ5IiwidHJ5TG9jIiwiY2F0Y2hMb2MiLCJmaW5hbGx5TG9jIiwiYWZ0ZXJMb2MiLCJ0cnlFbnRyaWVzIiwicHVzaCIsInJlc2V0VHJ5RW50cnkiLCJjb21wbGV0aW9uIiwicmVzZXQiLCJ2YWx1ZXMiLCJpdGVyYWJsZSIsIml0ZXJhdG9yTWV0aG9kIiwiaXRlcmF0b3JTeW1ib2wiLCJpc05hTiIsImxlbmd0aCIsImkiLCJoYXNPd24iLCJoYXNPd25Qcm9wZXJ0eSIsIiRTeW1ib2wiLCJ0b1N0cmluZ1RhZ1N5bWJvbCIsInRvU3RyaW5nVGFnIiwiaW5Nb2R1bGUiLCJtb2R1bGUiLCJydW50aW1lIiwicmVnZW5lcmF0b3JSdW50aW1lIiwiZXhwb3J0cyIsIkdwIiwiZGlzcGxheU5hbWUiLCJpc0dlbmVyYXRvckZ1bmN0aW9uIiwiZ2VuRnVuIiwiY3RvciIsIm5hbWUiLCJtYXJrIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJhd3JhcCIsImFzeW5jIiwiaXRlciIsInRvU3RyaW5nIiwia2V5cyIsIm9iamVjdCIsInJldmVyc2UiLCJwb3AiLCJza2lwVGVtcFJlc2V0IiwicHJldiIsImNoYXJBdCIsInNsaWNlIiwic3RvcCIsInJvb3RFbnRyeSIsInJvb3RSZWNvcmQiLCJydmFsIiwiZXhjZXB0aW9uIiwiaGFuZGxlIiwibG9jIiwiY2F1Z2h0IiwiaGFzQ2F0Y2giLCJoYXNGaW5hbGx5IiwiZmluYWxseUVudHJ5IiwiY29tcGxldGUiLCJmaW5pc2giLCJjYXRjaCIsInRocm93biIsImRlbGVnYXRlWWllbGQiLCJ3aW5kb3ciLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJGYXZvcml0ZXMiLCJyZWFkeSIsImRvY3VtZW50IiwicmVhZHlTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbml0IiwiZmF2b3JpdGVzIiwicXVlcnlTZWxlY3RvciIsInByb2R1Y3RzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvdW50IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidHJhbnNpdGlvbnMiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInRyYW5zZm9ybXMiLCJ3cmFwcGVyIiwibmV4dF9idXR0b24iLCJwcmV2X2J1dHRvbiIsIm1lbnUiLCJtYXJnaW4iLCJjdXJyZW50Iiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImlubGluZSIsIk1hdGgiLCJmbG9vciIsInRvZ2dsZSIsImFuaW1hdGlvbiIsInRpbWVyIiwidHJhbnNFbmRFdmVudE5hbWVzIiwiV2Via2l0VHJhbnNpdGlvbiIsIk1velRyYW5zaXRpb24iLCJPVHJhbnNpdGlvbiIsIm1zVHJhbnNpdGlvbiIsInRyYW5zaXRpb24iLCJNb2Rlcm5penIiLCJwcmVmaXhlZCIsInN0b3BBbmltYXRpb24iLCJyZXNpemUiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsIiwiYmx1ciIsInN0eWxlIiwicmlnaHQiLCJkcm9wQW5pbWF0aW9uIiwiTmF2aWdhdGlvbiIsIl90aGlzIiwibmF2aWdhdGlvbiIsImxhYmVscyIsImxhYmVsIiwib3BlbkRyb3Bkb3duIiwidG9nZ2xlTmF2aWdhdGlvbiIsImJvZHkiLCJldmVudCIsImN1cnJlbnRUYXJnZXQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJTY3JvbGxlciIsInNjcm9sbGVyIiwic2xpZGVzIiwicGFnaW5hdG9yIiwib3BlblByZXZTbGlkZSIsIm9wZW5OZXh0U2xpZGUiLCJmaXJzdF9zbGlkZSIsImNsb25lTm9kZSIsImxhc3Rfc2xpZGUiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsImluZGV4IiwiY3JlYXRlQnV0dG9uIiwiY3VycmVudF9wYWdlIiwicGFnaW5hdG9yX2J1dHRvbnMiLCJjdXJyZW50X2J1dHRvbiIsInRhbnNpdGlvbl90aW1lciIsImNoZWNrSW5kZXgiLCJtb3ZlVG9GaXJzdCIsImRlbGF5IiwidHVybk9uIiwicmVzaXplZCIsIm1vdmUiLCJyZXBvc1NsaWRlIiwicmVmIiwiX2NhbGxlZSIsIl9jb250ZXh0IiwidHVybk9mZiIsIm1vdmVUb0N1cnJlbnQiLCJfY2FsbGVlMiIsIm1pbGxpc2Vjb25kcyIsIl9jb250ZXh0MiIsIl94IiwiX2NhbGxlZTMiLCJfY29udGV4dDMiLCJtb3ZlVG9MYXN0IiwiYnV0dG9uIiwiY3JlYXRlRWxlbWVudCIsInNwYW4iLCJzZXRBdHRyaWJ1dGUiLCJzY3JvbGxUb1NsaWRlIiwic3RhcnRBbmltYXRpb24iLCJvcGVuU2xpZGUiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsIm1pbiIsIm1heCIsIlN1YnNjcmliZSIsImZvcm0iLCJpbnB1dCIsInN1Y2Nlc3NfbWVzc2FnZSIsInN1Y2Nlc3NfZmFpbCIsInN1Y2Nlc3NfcHJvZ3Jlc3MiLCJ2YWxpZGF0ZUZvcm0iLCJwcmV2ZW50RGVmYXVsdCIsImVtYWlsX3JlZ2V4IiwiUmVnRXhwIiwidHJpbSIsInRlc3QiLCJzZXRTdGF0ZSIsIkRPTkUiLCJPSyIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwic2VuZGVyIiwib3BlbiIsInNlbmQiLCJGb3JtRGF0YSIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInN0YXR1cyIsInJlc3BvbnNlIiwiY29kZSIsInN0YXR1c1RleHQiLCJzdWNjZXNzIiwiZmFpbCIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJwcm9ncmVzcyIsImZvY3VzIiwiVGFicyIsIndpZGdldCIsImJ1aWxkIiwiZGF0YSIsInJlcGxhY2UiLCJjdXJyZW50X3RhYiIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJ0YWIiLCJjb250YWluZXIiLCJ0ZXh0IiwiQ29udGVudCIsInNwbGl0IiwiVGl0bGUiLCJjcmVhdGVUZXh0Tm9kZSIsIm9wZW5UYWIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJwYXJhZ3JhcGgiLCJwIiwiY2xpY2siXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsU0FBU0EsU0FBUUMsR0FBTyxNQUFPQSxJQUF5QixtQkFBWEMsU0FBMEJELEVBQUlFLGNBQWdCRCxPQUFTLGVBQWtCRCxHQW1vQnRILFFBQVNHLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQTZMaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBa0ZoSCxRQUFTQyxtQkFBa0JDLEdBQU0sTUFBTyxZQUFjLEdBQUlDLEdBQU1ELEVBQUdFLE1BQU1DLEtBQU1DLFVBQVksT0FBTyxJQUFJQyxTQUFRLFNBQVVDLEVBQVNDLEdBQTRGLFFBQVNDLEdBQUtDLEVBQUtDLEdBQU8sSUFBTSxHQUFJQyxHQUFPVixFQUFJUSxHQUFLQyxHQUFVRSxFQUFRRCxFQUFLQyxNQUFTLE1BQU9DLEdBQXdCLFdBQWZOLEdBQU9NLEdBQXNCRixFQUFLRyxLQUFRUixFQUFRTSxHQUFpQlAsUUFBUUMsUUFBUU0sR0FBT0csS0FBS0MsRUFBVUMsR0FBL1IsR0FBSUQsR0FBV1IsRUFBS1UsS0FBSyxLQUFNLFFBQWFELEVBQVlULEVBQUtVLEtBQUssS0FBTSxRQUF1T0YsUUFF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TixRQUNFLEdBQUlILEVBQ0EsS0FBTUMsSU12aER0QmhJLEVBQUtkLGNBQWMsVUFBVWdLLFFBQzdCMVQsS0FBS2lTLE9BQU8vSCxVQUFVc0QsSUFBSSxtQk4raEQxQmxOLElBQUssVUFDTEcsTUFBTyxTTTdoREZtTSxHQUNMLEdBQUl3QyxHQUFTeEMsRUFBTUMsY0FDYm5FLEVBQVMwRyxFQUFPUSxhQUFhLGNBRVgsT0FBcEI1UCxLQUFLcVMsYUFDTHJTLEtBQUtxUyxZQUFZbkksVUFBVWMsT0FBTyxxQkFBcUIsR0FHaEMsTUFBdkJoTCxLQUFLK04sZ0JBQ0wvTixLQUFLK04sZUFBZTdELFVBQVVjLE9BQU8sd0JBQXdCLEdBR2pFaEwsS0FBSytOLGVBQWlCcUIsRUFDdEJwUCxLQUFLK04sZUFBZTdELFVBQVVjLE9BQU8sd0JBQXdCLEdBRTdEaEwsS0FBS3FTLFlBQWNyUyxLQUFLaVMsT0FBT3ZJLGNBQWMsYUFBZWhCLEVBQVMsS0FDN0MsTUFBcEIxSSxLQUFLcVMsYUFDTHJTLEtBQUtxUyxZQUFZbkksVUFBVWMsT0FBTyxxQkFBcUIsT0E5RzdEZ0gsSUFtSE4sSUFBSUEiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfVxuXG4vKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBodHRwczovL3Jhdy5naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL21hc3Rlci9MSUNFTlNFIGZpbGUuIEFuXG4gKiBhZGRpdGlvbmFsIGdyYW50IG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW5cbiAqIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4hKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIHZhciBpbk1vZHVsZSA9ICh0eXBlb2YgbW9kdWxlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YobW9kdWxlKSkgPT09IFwib2JqZWN0XCI7XG4gIHZhciBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZTtcbiAgaWYgKHJ1bnRpbWUpIHtcbiAgICBpZiAoaW5Nb2R1bGUpIHtcbiAgICAgIC8vIElmIHJlZ2VuZXJhdG9yUnVudGltZSBpcyBkZWZpbmVkIGdsb2JhbGx5IGFuZCB3ZSdyZSBpbiBhIG1vZHVsZSxcbiAgICAgIC8vIG1ha2UgdGhlIGV4cG9ydHMgb2JqZWN0IGlkZW50aWNhbCB0byByZWdlbmVyYXRvclJ1bnRpbWUuXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHJ1bnRpbWU7XG4gICAgfVxuICAgIC8vIERvbid0IGJvdGhlciBldmFsdWF0aW5nIHRoZSByZXN0IG9mIHRoaXMgZmlsZSBpZiB0aGUgcnVudGltZSB3YXNcbiAgICAvLyBhbHJlYWR5IGRlZmluZWQgZ2xvYmFsbHkuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRGVmaW5lIHRoZSBydW50aW1lIGdsb2JhbGx5IChhcyBleHBlY3RlZCBieSBnZW5lcmF0ZWQgY29kZSkgYXMgZWl0aGVyXG4gIC8vIG1vZHVsZS5leHBvcnRzIChpZiB3ZSdyZSBpbiBhIG1vZHVsZSkgb3IgYSBuZXcsIGVtcHR5IG9iamVjdC5cbiAgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWUgPSBpbk1vZHVsZSA/IG1vZHVsZS5leHBvcnRzIDoge307XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQsIHRoZW4gb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IuXG4gICAgdmFyIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUoKG91dGVyRm4gfHwgR2VuZXJhdG9yKS5wcm90b3R5cGUpO1xuICAgIHZhciBjb250ZXh0ID0gbmV3IENvbnRleHQodHJ5TG9jc0xpc3QgfHwgW10pO1xuXG4gICAgLy8gVGhlIC5faW52b2tlIG1ldGhvZCB1bmlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcy5cbiAgICBnZW5lcmF0b3IuX2ludm9rZSA9IG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG5cbiAgICByZXR1cm4gZ2VuZXJhdG9yO1xuICB9XG4gIHJ1bnRpbWUud3JhcCA9IHdyYXA7XG5cbiAgLy8gVHJ5L2NhdGNoIGhlbHBlciB0byBtaW5pbWl6ZSBkZW9wdGltaXphdGlvbnMuIFJldHVybnMgYSBjb21wbGV0aW9uXG4gIC8vIHJlY29yZCBsaWtlIGNvbnRleHQudHJ5RW50cmllc1tpXS5jb21wbGV0aW9uLiBUaGlzIGludGVyZmFjZSBjb3VsZFxuICAvLyBoYXZlIGJlZW4gKGFuZCB3YXMgcHJldmlvdXNseSkgZGVzaWduZWQgdG8gdGFrZSBhIGNsb3N1cmUgdG8gYmVcbiAgLy8gaW52b2tlZCB3aXRob3V0IGFyZ3VtZW50cywgYnV0IGluIGFsbCB0aGUgY2FzZXMgd2UgY2FyZSBhYm91dCB3ZVxuICAvLyBhbHJlYWR5IGhhdmUgYW4gZXhpc3RpbmcgbWV0aG9kIHdlIHdhbnQgdG8gY2FsbCwgc28gdGhlcmUncyBubyBuZWVkXG4gIC8vIHRvIGNyZWF0ZSBhIG5ldyBmdW5jdGlvbiBvYmplY3QuIFdlIGNhbiBldmVuIGdldCBhd2F5IHdpdGggYXNzdW1pbmdcbiAgLy8gdGhlIG1ldGhvZCB0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCwgc2luY2UgdGhhdCBoYXBwZW5zIHRvIGJlIHRydWVcbiAgLy8gaW4gZXZlcnkgY2FzZSwgc28gd2UgZG9uJ3QgaGF2ZSB0byB0b3VjaCB0aGUgYXJndW1lbnRzIG9iamVjdC4gVGhlXG4gIC8vIG9ubHkgYWRkaXRpb25hbCBhbGxvY2F0aW9uIHJlcXVpcmVkIGlzIHRoZSBjb21wbGV0aW9uIHJlY29yZCwgd2hpY2hcbiAgLy8gaGFzIGEgc3RhYmxlIHNoYXBlIGFuZCBzbyBob3BlZnVsbHkgc2hvdWxkIGJlIGNoZWFwIHRvIGFsbG9jYXRlLlxuICBmdW5jdGlvbiB0cnlDYXRjaChmbiwgb2JqLCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJub3JtYWxcIiwgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKSB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ0aHJvd1wiLCBhcmc6IGVyciB9O1xuICAgIH1cbiAgfVxuXG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0ID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCA9IFwic3VzcGVuZGVkWWllbGRcIjtcbiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gXCJleGVjdXRpbmdcIjtcbiAgdmFyIEdlblN0YXRlQ29tcGxldGVkID0gXCJjb21wbGV0ZWRcIjtcblxuICAvLyBSZXR1cm5pbmcgdGhpcyBvYmplY3QgZnJvbSB0aGUgaW5uZXJGbiBoYXMgdGhlIHNhbWUgZWZmZWN0IGFzXG4gIC8vIGJyZWFraW5nIG91dCBvZiB0aGUgZGlzcGF0Y2ggc3dpdGNoIHN0YXRlbWVudC5cbiAgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTtcblxuICAvLyBEdW1teSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMgdGhhdCB3ZSB1c2UgYXMgdGhlIC5jb25zdHJ1Y3RvciBhbmRcbiAgLy8gLmNvbnN0cnVjdG9yLnByb3RvdHlwZSBwcm9wZXJ0aWVzIGZvciBmdW5jdGlvbnMgdGhhdCByZXR1cm4gR2VuZXJhdG9yXG4gIC8vIG9iamVjdHMuIEZvciBmdWxsIHNwZWMgY29tcGxpYW5jZSwgeW91IG1heSB3aXNoIHRvIGNvbmZpZ3VyZSB5b3VyXG4gIC8vIG1pbmlmaWVyIG5vdCB0byBtYW5nbGUgdGhlIG5hbWVzIG9mIHRoZXNlIHR3byBmdW5jdGlvbnMuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fVxuXG4gIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdwLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlW3RvU3RyaW5nVGFnU3ltYm9sXSA9IEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuXG4gIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlXG4gIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICBwcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvciA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8XG4gICAgLy8gRm9yIHRoZSBuYXRpdmUgR2VuZXJhdG9yRnVuY3Rpb24gY29uc3RydWN0b3IsIHRoZSBiZXN0IHdlIGNhblxuICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSBcIkdlbmVyYXRvckZ1bmN0aW9uXCIgOiBmYWxzZTtcbiAgfTtcblxuICBydW50aW1lLm1hcmsgPSBmdW5jdGlvbiAoZ2VuRnVuKSB7XG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgdmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50YCB0byBkZXRlcm1pbmUgaWYgdGhlIHlpZWxkZWQgdmFsdWUgaXNcbiAgLy8gbWVhbnQgdG8gYmUgYXdhaXRlZC4gU29tZSBtYXkgY29uc2lkZXIgdGhlIG5hbWUgb2YgdGhpcyBtZXRob2QgdG9vXG4gIC8vIGN1dGVzeSwgYnV0IHRoZXkgYXJlIGN1cm11ZGdlb25zLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiBuZXcgQXdhaXRBcmd1bWVudChhcmcpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEF3YWl0QXJndW1lbnQoYXJnKSB7XG4gICAgdGhpcy5hcmcgPSBhcmc7XG4gIH1cblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHJlamVjdChyZWNvcmQuYXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWNvcmQuYXJnO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEF3YWl0QXJndW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlLmFyZykudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgZXJyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi4gSWYgdGhlIFByb21pc2UgaXMgcmVqZWN0ZWQsIGhvd2V2ZXIsIHRoZVxuICAgICAgICAgIC8vIHJlc3VsdCBmb3IgdGhpcyBpdGVyYXRpb24gd2lsbCBiZSByZWplY3RlZCB3aXRoIHRoZSBzYW1lXG4gICAgICAgICAgLy8gcmVhc29uLiBOb3RlIHRoYXQgcmVqZWN0aW9ucyBvZiB5aWVsZGVkIFByb21pc2VzIGFyZSBub3RcbiAgICAgICAgICAvLyB0aHJvd24gYmFjayBpbnRvIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIGFzIGlzIHRoZSBjYXNlXG4gICAgICAgICAgLy8gd2hlbiBhbiBhd2FpdGVkIFByb21pc2UgaXMgcmVqZWN0ZWQuIFRoaXMgZGlmZmVyZW5jZSBpblxuICAgICAgICAgIC8vIGJlaGF2aW9yIGJldHdlZW4geWllbGQgYW5kIGF3YWl0IGlzIGltcG9ydGFudCwgYmVjYXVzZSBpdFxuICAgICAgICAgIC8vIGFsbG93cyB0aGUgY29uc3VtZXIgdG8gZGVjaWRlIHdoYXQgdG8gZG8gd2l0aCB0aGUgeWllbGRlZFxuICAgICAgICAgIC8vIHJlamVjdGlvbiAoc3dhbGxvdyBpdCBhbmQgY29udGludWUsIG1hbnVhbGx5IC50aHJvdyBpdCBiYWNrXG4gICAgICAgICAgLy8gaW50byB0aGUgZ2VuZXJhdG9yLCBhYmFuZG9uIGl0ZXJhdGlvbiwgd2hhdGV2ZXIpLiBXaXRoXG4gICAgICAgICAgLy8gYXdhaXQsIGJ5IGNvbnRyYXN0LCB0aGVyZSBpcyBubyBvcHBvcnR1bml0eSB0byBleGFtaW5lIHRoZVxuICAgICAgICAgIC8vIHJlamVjdGlvbiByZWFzb24gb3V0c2lkZSB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBzbyB0aGVcbiAgICAgICAgICAvLyBvbmx5IG9wdGlvbiBpcyB0byB0aHJvdyBpdCBmcm9tIHRoZSBhd2FpdCBleHByZXNzaW9uLCBhbmRcbiAgICAgICAgICAvLyBsZXQgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiBoYW5kbGUgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCByZWplY3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICgodHlwZW9mIHByb2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihwcm9jZXNzKSkgPT09IFwib2JqZWN0XCIgJiYgcHJvY2Vzcy5kb21haW4pIHtcbiAgICAgIGludm9rZSA9IHByb2Nlc3MuZG9tYWluLmJpbmQoaW52b2tlKTtcbiAgICB9XG5cbiAgICB2YXIgcHJldmlvdXNQcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykge1xuICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAvLyBJZiBlbnF1ZXVlIGhhcyBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gd2Ugd2FudCB0byB3YWl0IHVudGlsXG4gICAgICAvLyBhbGwgcHJldmlvdXMgUHJvbWlzZXMgaGF2ZSBiZWVuIHJlc29sdmVkIGJlZm9yZSBjYWxsaW5nIGludm9rZSxcbiAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgIC8vIGVucXVldWUgaGFzIG5vdCBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gaXQgaXMgaW1wb3J0YW50IHRvXG4gICAgICAvLyBjYWxsIGludm9rZSBpbW1lZGlhdGVseSwgd2l0aG91dCB3YWl0aW5nIG9uIGEgY2FsbGJhY2sgdG8gZmlyZSxcbiAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAvLyBhbnkgbmVjZXNzYXJ5IHNldHVwIGluIGEgcHJlZGljdGFibGUgd2F5LiBUaGlzIHByZWRpY3RhYmlsaXR5XG4gICAgICAvLyBpcyB3aHkgdGhlIFByb21pc2UgY29uc3RydWN0b3Igc3luY2hyb25vdXNseSBpbnZva2VzIGl0c1xuICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgIC8vIGV4ZWN1dGUgY29kZSBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0LiBTaW5jZSB3ZSBpbXBsZW1lbnQgc2ltcGxlXG4gICAgICAvLyBhc3luYyBmdW5jdGlvbnMgaW4gdGVybXMgb2YgYXN5bmMgZ2VuZXJhdG9ycywgaXQgaXMgZXNwZWNpYWxseVxuICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsXG4gICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgLy8gaW52b2NhdGlvbnMgb2YgdGhlIGl0ZXJhdG9yLlxuICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcpIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuXG4gIC8vIE5vdGUgdGhhdCBzaW1wbGUgYXN5bmMgZnVuY3Rpb25zIGFyZSBpbXBsZW1lbnRlZCBvbiB0b3Agb2ZcbiAgLy8gQXN5bmNJdGVyYXRvciBvYmplY3RzOyB0aGV5IGp1c3QgcmV0dXJuIGEgUHJvbWlzZSBmb3IgdGhlIHZhbHVlIG9mXG4gIC8vIHRoZSBmaW5hbCByZXN1bHQgcHJvZHVjZWQgYnkgdGhlIGl0ZXJhdG9yLlxuICBydW50aW1lLmFzeW5jID0gZnVuY3Rpb24gKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcih3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSk7XG5cbiAgICByZXR1cm4gcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pID8gaXRlciAvLyBJZiBvdXRlckZuIGlzIGEgZ2VuZXJhdG9yLCByZXR1cm4gdGhlIGZ1bGwgaXRlcmF0b3IuXG4gICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgIHZhciBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzpcbiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZVxuICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuICAgICAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiIHx8IG1ldGhvZCA9PT0gXCJ0aHJvd1wiICYmIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gQSByZXR1cm4gb3IgdGhyb3cgKHdoZW4gdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBubyB0aHJvd1xuICAgICAgICAgICAgLy8gbWV0aG9kKSBhbHdheXMgdGVybWluYXRlcyB0aGUgeWllbGQqIGxvb3AuXG4gICAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgICAgLy8gY2hhbmNlIHRvIGNsZWFuIHVwLlxuICAgICAgICAgICAgdmFyIHJldHVybk1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW1wicmV0dXJuXCJdO1xuICAgICAgICAgICAgaWYgKHJldHVybk1ldGhvZCkge1xuICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2gocmV0dXJuTWV0aG9kLCBkZWxlZ2F0ZS5pdGVyYXRvciwgYXJnKTtcbiAgICAgICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmV0dXJuIG1ldGhvZCB0aHJldyBhbiBleGNlcHRpb24sIGxldCB0aGF0XG4gICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIHByZXZhaWwgb3ZlciB0aGUgb3JpZ2luYWwgcmV0dXJuIG9yIHRocm93LlxuICAgICAgICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICAgICAgLy8gQ29udGludWUgd2l0aCB0aGUgb3V0ZXIgcmV0dXJuLCBub3cgdGhhdCB0aGUgZGVsZWdhdGVcbiAgICAgICAgICAgICAgLy8gaXRlcmF0b3IgaGFzIGJlZW4gdGVybWluYXRlZC5cbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0sIGRlbGVnYXRlLml0ZXJhdG9yLCBhcmcpO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBMaWtlIHJldHVybmluZyBnZW5lcmF0b3IudGhyb3codW5jYXVnaHQpLCBidXQgd2l0aG91dCB0aGVcbiAgICAgICAgICAgIC8vIG92ZXJoZWFkIG9mIGFuIGV4dHJhIGZ1bmN0aW9uIGNhbGwuXG4gICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRGVsZWdhdGUgZ2VuZXJhdG9yIHJhbiBhbmQgaGFuZGxlZCBpdHMgb3duIGV4Y2VwdGlvbnMgc29cbiAgICAgICAgICAvLyByZWdhcmRsZXNzIG9mIHdoYXQgdGhlIG1ldGhvZCB3YXMsIHdlIGNvbnRpbnVlIGFzIGlmIGl0IGlzXG4gICAgICAgICAgLy8gXCJuZXh0XCIgd2l0aCBhbiB1bmRlZmluZWQgYXJnLlxuICAgICAgICAgIG1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcbiAgICAgICAgICBpZiAoaW5mby5kb25lKSB7XG4gICAgICAgICAgICBjb250ZXh0W2RlbGVnYXRlLnJlc3VsdE5hbWVdID0gaW5mby52YWx1ZTtcbiAgICAgICAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkWWllbGQpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2VudCA9IGFyZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihhcmcpKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZGlzcGF0Y2hlZCBleGNlcHRpb24gd2FzIGNhdWdodCBieSBhIGNhdGNoIGJsb2NrLFxuICAgICAgICAgICAgLy8gdGhlbiBsZXQgdGhhdCBjYXRjaCBibG9jayBoYW5kbGUgdGhlIGV4Y2VwdGlvbiBub3JtYWxseS5cbiAgICAgICAgICAgIG1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmUgPyBHZW5TdGF0ZUNvbXBsZXRlZCA6IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7XG5cbiAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgIHZhbHVlOiByZWNvcmQuYXJnLFxuICAgICAgICAgICAgZG9uZTogY29udGV4dC5kb25lXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBpZiAoY29udGV4dC5kZWxlZ2F0ZSAmJiBtZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0XG4gICAgICAgICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS5cbiAgICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZVxuICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSBjYWxsIGFib3ZlLlxuICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIERlZmluZSBHZW5lcmF0b3IucHJvdG90eXBlLntuZXh0LHRocm93LHJldHVybn0gaW4gdGVybXMgb2YgdGhlXG4gIC8vIHVuaWZpZWQgLl9pbnZva2UgaGVscGVyIG1ldGhvZC5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEdwKTtcblxuICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfTtcblxuICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykge1xuICAgIHZhciBlbnRyeSA9IHsgdHJ5TG9jOiBsb2NzWzBdIH07XG5cbiAgICBpZiAoMSBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV07XG4gICAgfVxuXG4gICAgaWYgKDIgaW4gbG9jcykge1xuICAgICAgZW50cnkuZmluYWxseUxvYyA9IGxvY3NbMl07XG4gICAgICBlbnRyeS5hZnRlckxvYyA9IGxvY3NbM107XG4gICAgfVxuXG4gICAgdGhpcy50cnlFbnRyaWVzLnB1c2goZW50cnkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVzZXRUcnlFbnRyeShlbnRyeSkge1xuICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uIHx8IHt9O1xuICAgIHJlY29yZC50eXBlID0gXCJub3JtYWxcIjtcbiAgICBkZWxldGUgcmVjb3JkLmFyZztcbiAgICBlbnRyeS5jb21wbGV0aW9uID0gcmVjb3JkO1xuICB9XG5cbiAgZnVuY3Rpb24gQ29udGV4dCh0cnlMb2NzTGlzdCkge1xuICAgIC8vIFRoZSByb290IGVudHJ5IG9iamVjdCAoZWZmZWN0aXZlbHkgYSB0cnkgc3RhdGVtZW50IHdpdGhvdXQgYSBjYXRjaFxuICAgIC8vIG9yIGEgZmluYWxseSBibG9jaykgZ2l2ZXMgdXMgYSBwbGFjZSB0byBzdG9yZSB2YWx1ZXMgdGhyb3duIGZyb21cbiAgICAvLyBsb2NhdGlvbnMgd2hlcmUgdGhlcmUgaXMgbm8gZW5jbG9zaW5nIHRyeSBzdGF0ZW1lbnQuXG4gICAgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiBcInJvb3RcIiB9XTtcbiAgICB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyk7XG4gICAgdGhpcy5yZXNldCh0cnVlKTtcbiAgfVxuXG4gIHJ1bnRpbWUua2V5cyA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cbiAgICBrZXlzLnJldmVyc2UoKTtcblxuICAgIC8vIFJhdGhlciB0aGFuIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBhIG5leHQgbWV0aG9kLCB3ZSBrZWVwXG4gICAgLy8gdGhpbmdzIHNpbXBsZSBhbmQgcmV0dXJuIHRoZSBuZXh0IGZ1bmN0aW9uIGl0c2VsZi5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0ga2V5cy5wb3AoKTtcbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5O1xuICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRvIGF2b2lkIGNyZWF0aW5nIGFuIGFkZGl0aW9uYWwgb2JqZWN0LCB3ZSBqdXN0IGhhbmcgdGhlIC52YWx1ZVxuICAgICAgLy8gYW5kIC5kb25lIHByb3BlcnRpZXMgb2ZmIHRoZSBuZXh0IGZ1bmN0aW9uIG9iamVjdCBpdHNlbGYuIFRoaXNcbiAgICAgIC8vIGFsc28gZW5zdXJlcyB0aGF0IHRoZSBtaW5pZmllciB3aWxsIG5vdCBhbm9ueW1pemUgdGhlIGZ1bmN0aW9uLlxuICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlKSB7XG4gICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07XG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGl0ZXJhYmxlLm5leHQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkge1xuICAgICAgICB2YXIgaSA9IC0xLFxuICAgICAgICAgICAgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIHJ1bnRpbWUudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICB0aGlzLnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KTtcblxuICAgICAgaWYgKCFza2lwVGVtcFJlc2V0KSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcykge1xuICAgICAgICAgIC8vIE5vdCBzdXJlIGFib3V0IHRoZSBvcHRpbWFsIG9yZGVyIG9mIHRoZXNlIGNvbmRpdGlvbnM6XG4gICAgICAgICAgaWYgKG5hbWUuY2hhckF0KDApID09PSBcInRcIiAmJiBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJiAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblxuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG4gICAgICBpZiAocm9vdFJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcm9vdFJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcblxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiBkaXNwYXRjaEV4Y2VwdGlvbihleGNlcHRpb24pIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcbiAgICAgICAgcmV0dXJuICEhY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIG91dHNpZGUgb2YgYW55IHRyeSBibG9jayB0aGF0IGNvdWxkIGhhbmRsZVxuICAgICAgICAgIC8vIGl0LCBzbyBzZXQgdGhlIGNvbXBsZXRpb24gdmFsdWUgb2YgdGhlIGVudGlyZSBmdW5jdGlvbiB0b1xuICAgICAgICAgIC8vIHRocm93IHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIik7XG4gICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJiBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpICYmIHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB2YXIgZmluYWxseUVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSAmJiAodHlwZSA9PT0gXCJicmVha1wiIHx8IHR5cGUgPT09IFwiY29udGludWVcIikgJiYgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiYgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGFcbiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLlxuICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJlY29yZC50eXBlID0gdHlwZTtcbiAgICAgIHJlY29yZC5hcmcgPSBhcmc7XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNvbXBsZXRlKHJlY29yZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcImJyZWFrXCIgfHwgcmVjb3JkLnR5cGUgPT09IFwiY29udGludWVcIikge1xuICAgICAgICB0aGlzLm5leHQgPSByZWNvcmQuYXJnO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICB0aGlzLnJ2YWwgPSByZWNvcmQuYXJnO1xuICAgICAgICB0aGlzLm5leHQgPSBcImVuZFwiO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIiAmJiBhZnRlckxvYykge1xuICAgICAgICB0aGlzLm5leHQgPSBhZnRlckxvYztcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbiBfY2F0Y2godHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIGRlbGVnYXRlWWllbGQoaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG59KShcbi8vIEFtb25nIHRoZSB2YXJpb3VzIHRyaWNrcyBmb3Igb2J0YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBnbG9iYWxcbi8vIG9iamVjdCwgdGhpcyBzZWVtcyB0byBiZSB0aGUgbW9zdCByZWxpYWJsZSB0ZWNobmlxdWUgdGhhdCBkb2VzIG5vdFxuLy8gdXNlIGluZGlyZWN0IGV2YWwgKHdoaWNoIHZpb2xhdGVzIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5KS5cbih0eXBlb2YgZ2xvYmFsID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoZ2xvYmFsKSkgPT09IFwib2JqZWN0XCIgPyBnbG9iYWwgOiAodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHdpbmRvdykpID09PSBcIm9iamVjdFwiID8gd2luZG93IDogKHR5cGVvZiBzZWxmID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2Yoc2VsZikpID09PSBcIm9iamVjdFwiID8gc2VsZiA6IHVuZGVmaW5lZCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIGZhdm9yaXRlcyBibG9ja1xuICAgICAqIEBjbGFzc1xuICAgICAqL1xuXG4gICAgdmFyIEZhdm9yaXRlcyA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1biBpbml0IHdoZW4gZG9tIGlzIHJlYWR5XG4gICAgICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICAgICAqL1xuXG4gICAgICAgIGZ1bmN0aW9uIEZhdm9yaXRlcygpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGYXZvcml0ZXMpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBhbmQgaW5pdGlhbGl6ZVxuICAgICAgICAgKi9cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoRmF2b3JpdGVzLCBbe1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZhdm9yaXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmF2b3JpdGVzID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdHMgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnQgPSBwcm9kdWN0cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhdm9yaXRlcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZmF2b3JpdGVzKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZhdm9yaXRlcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbnMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2l0aW9ucycpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtcyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zZm9ybXMnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fd3JhcHBlci1pbm5lcicpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX25leHQnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uID0gdGhpcy5mYXZvcml0ZXMucXVlcnlTZWxlY3RvcignLmZhdm9yaXRlX19idXR0b25fcHJldicpO1xuICAgICAgICAgICAgICAgIHRoaXMubWVudSA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fbWVudScpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMubmV4dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5wcmV2LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXJnaW4gPSAyMDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBwcm9kdWN0c1swXS5vZmZzZXRXaWR0aCArIHRoaXMubWFyZ2luO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoICsgdGhpcy5tYXJnaW4pIC8gdGhpcy53aWR0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbmxpbmUgPj0gdGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnZmF2b3JpdGVfX21lbnVfaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMudGltZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc0VuZEV2ZW50TmFtZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnV2Via2l0VHJhbnNpdGlvbic6ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdNb3pUcmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ09UcmFuc2l0aW9uJzogJ29UcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdtc1RyYW5zaXRpb24nOiAnTVNUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKHRyYW5zRW5kRXZlbnROYW1lc1tNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0sIHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldCBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0YXJ0QW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnRBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0b3BBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiZHJvcEFuaW1hdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyb3BBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGltZXIgIT0gbnVsbCkgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAyNTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNlbGVjdCBuZXh0IHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJuZXh0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQrKztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IHRoaXMuY291bnQgLSB0aGlzLmlubGluZSArIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGwoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZWxlY3QgcHJldmlvdXMgc2xpZGUgYW5kIHNjcm9sbFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInByZXZcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmV2KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudC0tO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnQgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5jb3VudCAtIHRoaXMuaW5saW5lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24uYmx1cigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlY291bnQgb24gcmVzaXplXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwicmVzaXplXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoICsgdGhpcy5tYXJnaW4pIC8gdGhpcy53aWR0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbmxpbmUgPj0gdGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnZmF2b3JpdGVfX21lbnVfaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGwoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY3JvbGwgdG8gY3VycmVudCBzbGlkZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInNjcm9sbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbCgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc2Zvcm1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpXSA9ICd0cmFuc2xhdGVYKCcgKyAtdGhpcy53aWR0aCAqIHRoaXMuY3VycmVudCArICdweCknO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZS5yaWdodCA9IC10aGlzLndpZHRoICogdGhpcy5jdXJyZW50ICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5kcm9wQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gRmF2b3JpdGVzO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgRmF2b3JpdGVzKCk7XG59KSgpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb250cm9scyBuYXZpZ2F0aW9uIG9uIGxvdyByZXNvbHV0aW9uXG4gICAgICogQGNsYXNzXG4gICAgICovXG5cbiAgICB2YXIgTmF2aWdhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1biBpbml0IHdoZW4gZG9tIGlzIHJlYWR5XG4gICAgICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICAgICAqL1xuXG4gICAgICAgIGZ1bmN0aW9uIE5hdmlnYXRpb24oKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTmF2aWdhdGlvbik7XG5cbiAgICAgICAgICAgIHZhciByZWFkeSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgZXZlbnRzIGFuZCBpbml0aWFsaXplXG4gICAgICAgICAqL1xuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhOYXZpZ2F0aW9uLCBbe1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbicpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hdmlnYXRpb24gPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHZhciBsYWJlbHMgPSB0aGlzLm5hdmlnYXRpb24ucXVlcnlTZWxlY3RvckFsbCgnLm5hdmlnYXRpb25fX2xhYmVsJyk7XG4gICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGxhYmVscywgZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3RoaXMub3BlbkRyb3Bkb3duLmJpbmQoX3RoaXMpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb25fX3RvZ2dsZScpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGVOYXZpZ2F0aW9uLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNob3cgYW5kIGhpZGUgbmF2aWdhdGlvbiBvbiBtb2JpbGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJ0b2dnbGVOYXZpZ2F0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlTmF2aWdhdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRpb24uY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9vcGVuJyk7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGUuYmx1cigpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9vcGVuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2hvdyBhbmQgaGlkZSBkcm9wZG93blxuICAgICAgICAgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQg4oCUwqBjbGljayBldmVudCwgc28gd2UgbWF5IGdldCBkcm9wZG93biB0byBvcGVuXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwib3BlbkRyb3Bkb3duXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbkRyb3Bkb3duKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX19sYWJlbF9vcGVuJyk7XG4gICAgICAgICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fY29udGFpbmVyX29wZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBOYXZpZ2F0aW9uO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgTmF2aWdhdGlvbigpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBnZW4gPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgY2FsbE5leHQgPSBzdGVwLmJpbmQobnVsbCwgXCJuZXh0XCIpOyB2YXIgY2FsbFRocm93ID0gc3RlcC5iaW5kKG51bGwsIFwidGhyb3dcIik7IGZ1bmN0aW9uIHN0ZXAoa2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKGNhbGxOZXh0LCBjYWxsVGhyb3cpOyB9IH0gY2FsbE5leHQoKTsgfSk7IH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb250cm9scyBzY3JvbGxlclxuICAgICAqIEBjbGFzc1xuICAgICAqL1xuXG4gICAgdmFyIFNjcm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUnVuIGluaXQgd2hlbiBkb20gaXMgcmVhZHlcbiAgICAgICAgICogQGNvbnN0cnVjdHNcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gU2Nyb2xsZXIoKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2Nyb2xsZXIpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBhbmQgaW5pdGlhbGl6ZVxuICAgICAgICAgKi9cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU2Nyb2xsZXIsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsZXIgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX193cmFwcGVyLWlubmVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zbGlkZXMgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVyX19zbGlkZScpO1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnQgPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5zbGlkZXMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53cmFwcGVyO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zbGlkZXM7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcm9sbGVyO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbnMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2l0aW9ucycpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtcyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zZm9ybXMnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3BhZ2luYXRvcicpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24gPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fcHJldicpO1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24gPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fbmV4dCcpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblByZXZTbGlkZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuTmV4dFNsaWRlLmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0X3NsaWRlID0gdGhpcy5zbGlkZXNbMF0uY2xvbmVOb2RlKHRydWUpLFxuICAgICAgICAgICAgICAgICAgICBsYXN0X3NsaWRlID0gdGhpcy5zbGlkZXNbdGhpcy5jb3VudCAtIDFdLmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgICAgICAgICAgIGZpcnN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgICAgIGxhc3Rfc2xpZGUuY2xhc3NMaXN0LmFkZCgnY2xvbmVkJyk7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFwcGVuZENoaWxkKGZpcnN0X3NsaWRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuaW5zZXJ0QmVmb3JlKGxhc3Rfc2xpZGUsIHRoaXMuc2xpZGVzWzBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24odGhpcy5jb3VudCAtIGluZGV4IC0gMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yX2J1dHRvbnMgPSB0aGlzLnBhZ2luYXRvci5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZXJfX3BhZ2UnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gdGhpcy5wYWdpbmF0b3JfYnV0dG9uc1swXTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy50YW5zaXRpb25fdGltZXIgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnT1RyYW5zaXRpb24nOiAnb1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ21zVHJhbnNpdGlvbic6ICdNU1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNFbmRFdmVudE5hbWVzW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSwgdGhpcy5jaGVja0luZGV4LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKS5kZWxheSgpLnRoZW4odGhpcy50dXJuT24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBNb3ZlIHRvIGN1cnJlbnQgc2xpZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJtb3ZlVG9DdXJyZW50XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZVRvQ3VycmVudCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmUodGhpcy5jdXJyZW50X3BhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE1vdmUgdG8gZmlyc3Qgc2xpZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJtb3ZlVG9GaXJzdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUb0ZpcnN0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBNb3ZlIHRvIGxhc3Qgc2xpZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJtb3ZlVG9MYXN0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZVRvTGFzdCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHRoaXMuY291bnQgLSAxO1xuICAgICAgICAgICAgICAgIHRoaXMucmVwb3NTbGlkZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFR1cm4gb24gc2Nyb2xsIGFuaW1hdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInR1cm5PblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHR1cm5PbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldID0gTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKSArICcgLjI1cyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHVybiBvZmYgc2Nyb2xsIGFuaW1hdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInR1cm5PZmZcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0dXJuT2ZmKCkge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0gPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2hvdyBzbGlkZVxuICAgICAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4wqDigJQgc2xpZGUgbnVtYmVyXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwibW92ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmUoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc2Zvcm1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpXSA9ICd0cmFuc2xhdGVYKCcgKyAtdGhpcy53cmFwcGVyLm9mZnNldFdpZHRoICogKGluZGV4ICsgMSkgKyAncHgpJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUucmlnaHQgPSAtdGhpcy53cmFwcGVyLm9mZnNldFdpZHRoICogKGluZGV4ICsgMSkgKyAncHgnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXdpbmQgc2xpZGVzIG9uIHJlc2l6ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInJlc2l6ZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWYgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVsYXkoMjUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvQ3VycmVudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gcmVzaXplZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSgpXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGVsYXksIHNvIGJyb3dzZXIgbWF5IHJlYnVpbGQgRE9NIGFuZCBDU1NcbiAgICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBtaWxsaXNlY29uZHMg4oCUIGRlbGF5IGR1cmF0aW9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiZGVsYXlcIixcbiAgICAgICAgICAgIHZhbHVlOiAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWYgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlbGF5KF94KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSkoKVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJld2luZCBzbGlkZXNcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJjaGVja0luZGV4XCIsXG4gICAgICAgICAgICB2YWx1ZTogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmN1cnJlbnRfcGFnZSA9PSAtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVUb0xhc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmN1cnJlbnRfcGFnZSA9PSB0aGlzLmNvdW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxNDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9GaXJzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNoZWNrSW5kZXgoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSkoKVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0b3BBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0IGFuaW1hdGlvbiBmbGFnXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic3RhcnRBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmVtb3ZlIGFuaW1hdGlvbiBmbGFnIGJ5IHRpbWVvdXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJkcm9wQW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMudGltZXIgIT0gJ3VuZGVmaW5lZCcpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCh0aGlzLnN0b3BBbmltYXRpb24uYmluZCh0aGlzKSwgMzUwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDcmVhdGUgcGFnaW5hdG9yIGJ1dHRvblxuICAgICAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IOKAlMKgc2xpZGUgbnVtYmVyXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiY3JlYXRlQnV0dG9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnV0dG9uKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpLFxuICAgICAgICAgICAgICAgICAgICBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnU1BBTicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlJywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZScpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChzcGFuKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNjcm9sbFRvU2xpZGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY3JvbGwgdG8gY3VycmVudCBzbGlkZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5TbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5TbGlkZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyb3BBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGFuc2l0aW9uX3RpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRhbnNpdGlvbl90aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFuc2l0aW9uX3RpbWVyID0gc2V0VGltZW91dCh0aGlzLmNoZWNrSW5kZXguYmluZCh0aGlzKSwgMjUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2Nyb2xsIHRvIHByZXZpb3VzIHNsaWRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwib3BlblByZXZTbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5QcmV2U2xpZGUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UtLTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNjcm9sbCB0byBuZXh0IHNsaWRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwib3Blbk5leHRTbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5OZXh0U2xpZGUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UrKztcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNjcm9sbCB0byBzZWxlY3RlZCBzbGlkZVxuICAgICAgICAgICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQg4oCUIGNsaWNrIGV2ZW50LCBzbyB3ZSBtYXkgZ2V0IHBhZ2luYXRvciBidXR0b25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzY3JvbGxUb1NsaWRlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsVG9TbGlkZShldmVudCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gcGFyc2VJbnQoYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS1wYWdlJyksIDEwKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYmx1cigpO1xuICAgICAgICAgICAgICAgIHRoaXMub3BlblNsaWRlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTW92ZSBzY3JvbGxlciB0byBzZWxlY3RlZCBzbGlkZSBhbmQgc2V0IGJ1dHRvbnMgc3RhdGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJyZXBvc1NsaWRlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVwb3NTbGlkZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IHRoaXMucGFnaW5hdG9yX2J1dHRvbnNbTWF0aC5taW4oTWF0aC5tYXgodGhpcy5jdXJyZW50X3BhZ2UsIDApLCB0aGlzLmNvdW50IC0gMSldO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZXJfX3BhZ2VfY3VycmVudCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZSh0aGlzLmN1cnJlbnRfcGFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gU2Nyb2xsZXI7XG4gICAgfSkoKTtcblxuICAgIG5ldyBTY3JvbGxlcigpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQGNsYXNzIENsYXNzIGhhbmRsZSBzdWJzY3JpcHRpb24gcHJvY2Vzc1xuICAgICAqL1xuXG4gICAgdmFyIFN1YnNjcmliZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gU3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1YnNjcmliZSk7XG5cbiAgICAgICAgICAgIHZhciByZWFkeSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTdWJzY3JpYmUsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvcm0gPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fZW1haWwnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3NfbWVzc2FnZSA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9zdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzX2ZhaWwgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfZmFpbCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19wcm9ncmVzcyA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9pbi1wcm9ncmVzcycpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLnNldEF0dHJpYnV0ZSgnbm92YWxpZGF0ZScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnZhbGlkYXRlRm9ybS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gVmFsaWRhdGluZyB1c2VyIGlucHV0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwidmFsaWRhdGVGb3JtXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZW1haWxfcmVnZXggPSBuZXcgUmVnRXhwKFwiXihbYS16QS1aMC05X1xcLlxcLV0pK1xcQCgoW2EtekEtWjAtOVxcLV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyRcIik7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDAgJiYgZW1haWxfcmVnZXgudGVzdCh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKSkgPT09IGZhbHNlIHx8IHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMCB8fCB0aGlzLmlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIERPTkUgPSA0LFxuICAgICAgICAgICAgICAgICAgICBPSyA9IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlciA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnanMvc3Vic2NyaWJlLmpzb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZW5kKG5ldyBGb3JtRGF0YShfdGhpcy5mb3JtKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gRE9ORSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb3JtLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSBPSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuY29kZSArICc6ICcgKyB4aHIuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5zdWNjZXNzLmJpbmQodGhpcykpLmNhdGNoKHRoaXMuZmFpbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gcmVxdWVzdCBoYXZlIHN1Y2NlZWRlZFxuICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2Ugc2VydmVyIGFuc3dlclxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBmYWlsZWRcbiAgICAgICAgICAgICAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIGVycm9yIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImZhaWxcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmYWlsKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvbiBTZXQgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RhdGUgbmV3IHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic2V0U3RhdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdGF0ZShzdGF0ZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGZhaWwgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZmFpbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInByb2dyZXNzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX2ZhaWwnLCBmYWlsKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3Byb2dyZXNzJywgcHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFN1YnNjcmliZTtcbiAgICB9KSgpO1xuXG4gICAgbmV3IFN1YnNjcmliZSgpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQGNsYXNzIENsYXNzIGhhbmRsZSB0YWJzIGxvYWRpbmdcbiAgICAgKi9cblxuICAgIHZhciBUYWJzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTdGFydCBpbml0aWFsaXphdGlvbiBvbiBkb21sb2FkXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cblxuICAgICAgICBmdW5jdGlvbiBUYWJzKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRhYnMpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkaW5nIGV2ZW50cyBhbmQgcHJvcGVydGllc1xuICAgICAgICAgKi9cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoVGFicywgW3tcbiAgICAgICAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpZGdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJzJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMud2lkZ2V0ID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgRE9ORSA9IDQsXG4gICAgICAgICAgICAgICAgICAgIE9LID0gMjAwLFxuICAgICAgICAgICAgICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKSxcbiAgICAgICAgICAgICAgICAgICAgc2VuZGVyID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdqcy90YWJzLmpzb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gRE9ORSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gT0spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeGhyLnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoeGhyLmNvZGUgKyAnOiAnICsgeGhyLnN0YXR1c1RleHQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzZW5kZXIudGhlbih0aGlzLmJ1aWxkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvbiBCdWlsZCB3aWRnZXRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJidWlsZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UobWVzc2FnZS5yZXBsYWNlKC9cXG4vZywgXCJcXFxcblwiKS5yZXBsYWNlKC9cXHIvZywgXCJcXFxcclwiKS5yZXBsYWNlKC9cXHQvZywgXCJcXFxcdFwiKS5yZXBsYWNlKC9cXGYvZywgXCJcXFxcZlwiKSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy53aWRnZXQpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53aWRnZXQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ01FTlUnKTtcbiAgICAgICAgICAgICAgICBtZW51LnNldEF0dHJpYnV0ZSgndHlwZScsICd0b29sYmFyJyk7XG4gICAgICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QuYWRkKCd0YWJzX19tZW51Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQobWVudSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gZGF0YVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWIgPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NFQ1RJT04nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGFiLkNvbnRlbnQuc3BsaXQoJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnLCB0YWIuVGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2J1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRhYi5UaXRsZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuVGFiLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChidXR0b24pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRhYicsIHRhYi5UaXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgndGFic19fdGFiJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0ZXh0W1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhZ3JhcGggPSBfc3RlcDIudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdQJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocGFyYWdyYXBoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gZXJyO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKS5jbGljaygpO1xuICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LmNsYXNzTGlzdC5hZGQoJ3RhYnNfYnVpbGRlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwib3BlblRhYlwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5UYWIoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX190YWJfY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X2J1dHRvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fYnV0dG9uX2N1cnJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IGJ1dHRvbjtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX2J1dHRvbl9jdXJyZW50JywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gdGhpcy53aWRnZXQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiPScgKyB0YXJnZXQgKyAnXScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX190YWJfY3VycmVudCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBUYWJzO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgVGFicygpO1xufSkoKTsiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBodHRwczovL3Jhdy5naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL21hc3Rlci9MSUNFTlNFIGZpbGUuIEFuXG4gKiBhZGRpdGlvbmFsIGdyYW50IG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW5cbiAqIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4hKGZ1bmN0aW9uKGdsb2JhbCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbiAgdmFyIHVuZGVmaW5lZDsgLy8gTW9yZSBjb21wcmVzc2libGUgdGhhbiB2b2lkIDAuXG4gIHZhciAkU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiID8gU3ltYm9sIDoge307XG4gIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCI7XG4gIHZhciB0b1N0cmluZ1RhZ1N5bWJvbCA9ICRTeW1ib2wudG9TdHJpbmdUYWcgfHwgXCJAQHRvU3RyaW5nVGFnXCI7XG5cbiAgdmFyIGluTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIjtcbiAgdmFyIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lO1xuICBpZiAocnVudGltZSkge1xuICAgIGlmIChpbk1vZHVsZSkge1xuICAgICAgLy8gSWYgcmVnZW5lcmF0b3JSdW50aW1lIGlzIGRlZmluZWQgZ2xvYmFsbHkgYW5kIHdlJ3JlIGluIGEgbW9kdWxlLFxuICAgICAgLy8gbWFrZSB0aGUgZXhwb3J0cyBvYmplY3QgaWRlbnRpY2FsIHRvIHJlZ2VuZXJhdG9yUnVudGltZS5cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gcnVudGltZTtcbiAgICB9XG4gICAgLy8gRG9uJ3QgYm90aGVyIGV2YWx1YXRpbmcgdGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGlmIHRoZSBydW50aW1lIHdhc1xuICAgIC8vIGFscmVhZHkgZGVmaW5lZCBnbG9iYWxseS5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBEZWZpbmUgdGhlIHJ1bnRpbWUgZ2xvYmFsbHkgKGFzIGV4cGVjdGVkIGJ5IGdlbmVyYXRlZCBjb2RlKSBhcyBlaXRoZXJcbiAgLy8gbW9kdWxlLmV4cG9ydHMgKGlmIHdlJ3JlIGluIGEgbW9kdWxlKSBvciBhIG5ldywgZW1wdHkgb2JqZWN0LlxuICBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZSA9IGluTW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgOiB7fTtcblxuICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gSWYgb3V0ZXJGbiBwcm92aWRlZCwgdGhlbiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvci5cbiAgICB2YXIgZ2VuZXJhdG9yID0gT2JqZWN0LmNyZWF0ZSgob3V0ZXJGbiB8fCBHZW5lcmF0b3IpLnByb3RvdHlwZSk7XG4gICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7XG5cbiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cbiAgcnVudGltZS53cmFwID0gd3JhcDtcblxuICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm5vcm1hbFwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcInRocm93XCIsIGFyZzogZXJyIH07XG4gICAgfVxuICB9XG5cbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSBcInN1c3BlbmRlZFN0YXJ0XCI7XG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gXCJzdXNwZW5kZWRZaWVsZFwiO1xuICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSBcImV4ZWN1dGluZ1wiO1xuICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSBcImNvbXBsZXRlZFwiO1xuXG4gIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXNcbiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50LlxuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZFxuICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXJcbiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG5cbiAgdmFyIEdwID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGVbdG9TdHJpbmdUYWdTeW1ib2xdID0gR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG5cbiAgLy8gSGVscGVyIGZvciBkZWZpbmluZyB0aGUgLm5leHQsIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcyBvZiB0aGVcbiAgLy8gSXRlcmF0b3IgaW50ZXJmYWNlIGluIHRlcm1zIG9mIGEgc2luZ2xlIC5faW52b2tlIG1ldGhvZC5cbiAgZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3JNZXRob2RzKHByb3RvdHlwZSkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgcHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgdmFyIGN0b3IgPSB0eXBlb2YgZ2VuRnVuID09PSBcImZ1bmN0aW9uXCIgJiYgZ2VuRnVuLmNvbnN0cnVjdG9yO1xuICAgIHJldHVybiBjdG9yXG4gICAgICA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8XG4gICAgICAgIC8vIEZvciB0aGUgbmF0aXZlIEdlbmVyYXRvckZ1bmN0aW9uIGNvbnN0cnVjdG9yLCB0aGUgYmVzdCB3ZSBjYW5cbiAgICAgICAgLy8gZG8gaXMgdG8gY2hlY2sgaXRzIC5uYW1lIHByb3BlcnR5LlxuICAgICAgICAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSBcIkdlbmVyYXRvckZ1bmN0aW9uXCJcbiAgICAgIDogZmFsc2U7XG4gIH07XG5cbiAgcnVudGltZS5tYXJrID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgdmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50YCB0byBkZXRlcm1pbmUgaWYgdGhlIHlpZWxkZWQgdmFsdWUgaXNcbiAgLy8gbWVhbnQgdG8gYmUgYXdhaXRlZC4gU29tZSBtYXkgY29uc2lkZXIgdGhlIG5hbWUgb2YgdGhpcyBtZXRob2QgdG9vXG4gIC8vIGN1dGVzeSwgYnV0IHRoZXkgYXJlIGN1cm11ZGdlb25zLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBBd2FpdEFyZ3VtZW50KGFyZyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gQXdhaXRBcmd1bWVudChhcmcpIHtcbiAgICB0aGlzLmFyZyA9IGFyZztcbiAgfVxuXG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IoZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChnZW5lcmF0b3JbbWV0aG9kXSwgZ2VuZXJhdG9yLCBhcmcpO1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgcmVqZWN0KHJlY29yZC5hcmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlY29yZC5hcmc7XG4gICAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXdhaXRBcmd1bWVudCkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUuYXJnKS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJuZXh0XCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgZXJyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbih1bndyYXBwZWQpIHtcbiAgICAgICAgICAvLyBXaGVuIGEgeWllbGRlZCBQcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgZmluYWwgdmFsdWUgYmVjb21lc1xuICAgICAgICAgIC8vIHRoZSAudmFsdWUgb2YgdGhlIFByb21pc2U8e3ZhbHVlLGRvbmV9PiByZXN1bHQgZm9yIHRoZVxuICAgICAgICAgIC8vIGN1cnJlbnQgaXRlcmF0aW9uLiBJZiB0aGUgUHJvbWlzZSBpcyByZWplY3RlZCwgaG93ZXZlciwgdGhlXG4gICAgICAgICAgLy8gcmVzdWx0IGZvciB0aGlzIGl0ZXJhdGlvbiB3aWxsIGJlIHJlamVjdGVkIHdpdGggdGhlIHNhbWVcbiAgICAgICAgICAvLyByZWFzb24uIE5vdGUgdGhhdCByZWplY3Rpb25zIG9mIHlpZWxkZWQgUHJvbWlzZXMgYXJlIG5vdFxuICAgICAgICAgIC8vIHRocm93biBiYWNrIGludG8gdGhlIGdlbmVyYXRvciBmdW5jdGlvbiwgYXMgaXMgdGhlIGNhc2VcbiAgICAgICAgICAvLyB3aGVuIGFuIGF3YWl0ZWQgUHJvbWlzZSBpcyByZWplY3RlZC4gVGhpcyBkaWZmZXJlbmNlIGluXG4gICAgICAgICAgLy8gYmVoYXZpb3IgYmV0d2VlbiB5aWVsZCBhbmQgYXdhaXQgaXMgaW1wb3J0YW50LCBiZWNhdXNlIGl0XG4gICAgICAgICAgLy8gYWxsb3dzIHRoZSBjb25zdW1lciB0byBkZWNpZGUgd2hhdCB0byBkbyB3aXRoIHRoZSB5aWVsZGVkXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIChzd2FsbG93IGl0IGFuZCBjb250aW51ZSwgbWFudWFsbHkgLnRocm93IGl0IGJhY2tcbiAgICAgICAgICAvLyBpbnRvIHRoZSBnZW5lcmF0b3IsIGFiYW5kb24gaXRlcmF0aW9uLCB3aGF0ZXZlcikuIFdpdGhcbiAgICAgICAgICAvLyBhd2FpdCwgYnkgY29udHJhc3QsIHRoZXJlIGlzIG5vIG9wcG9ydHVuaXR5IHRvIGV4YW1pbmUgdGhlXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIHJlYXNvbiBvdXRzaWRlIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIHNvIHRoZVxuICAgICAgICAgIC8vIG9ubHkgb3B0aW9uIGlzIHRvIHRocm93IGl0IGZyb20gdGhlIGF3YWl0IGV4cHJlc3Npb24sIGFuZFxuICAgICAgICAgIC8vIGxldCB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhbmRsZSB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHVud3JhcHBlZDtcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHByb2Nlc3MuZG9tYWluKSB7XG4gICAgICBpbnZva2UgPSBwcm9jZXNzLmRvbWFpbi5iaW5kKGludm9rZSk7XG4gICAgfVxuXG4gICAgdmFyIHByZXZpb3VzUHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIGVucXVldWUobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuXG4gIC8vIE5vdGUgdGhhdCBzaW1wbGUgYXN5bmMgZnVuY3Rpb25zIGFyZSBpbXBsZW1lbnRlZCBvbiB0b3Agb2ZcbiAgLy8gQXN5bmNJdGVyYXRvciBvYmplY3RzOyB0aGV5IGp1c3QgcmV0dXJuIGEgUHJvbWlzZSBmb3IgdGhlIHZhbHVlIG9mXG4gIC8vIHRoZSBmaW5hbCByZXN1bHQgcHJvZHVjZWQgYnkgdGhlIGl0ZXJhdG9yLlxuICBydW50aW1lLmFzeW5jID0gZnVuY3Rpb24oaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKFxuICAgICAgd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdClcbiAgICApO1xuXG4gICAgcmV0dXJuIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbihvdXRlckZuKVxuICAgICAgPyBpdGVyIC8vIElmIG91dGVyRm4gaXMgYSBnZW5lcmF0b3IsIHJldHVybiB0aGUgZnVsbCBpdGVyYXRvci5cbiAgICAgIDogaXRlci5uZXh0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTtcbiAgICAgICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KSB7XG4gICAgdmFyIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydDtcblxuICAgIHJldHVybiBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcpIHtcbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVFeGVjdXRpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZ1wiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUNvbXBsZXRlZCkge1xuICAgICAgICBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCZSBmb3JnaXZpbmcsIHBlciAyNS4zLjMuMy4zIG9mIHRoZSBzcGVjOlxuICAgICAgICAvLyBodHRwczovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtZ2VuZXJhdG9ycmVzdW1lXG4gICAgICAgIHJldHVybiBkb25lUmVzdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IGNvbnRleHQuZGVsZWdhdGU7XG4gICAgICAgIGlmIChkZWxlZ2F0ZSkge1xuICAgICAgICAgIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIgfHxcbiAgICAgICAgICAgICAgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiICYmIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0gPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgIC8vIEEgcmV0dXJuIG9yIHRocm93ICh3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gdGhyb3dcbiAgICAgICAgICAgIC8vIG1ldGhvZCkgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLlxuICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGFcbiAgICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICAgIHZhciByZXR1cm5NZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltcInJldHVyblwiXTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5NZXRob2QpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKHJldHVybk1ldGhvZCwgZGVsZWdhdGUuaXRlcmF0b3IsIGFyZyk7XG4gICAgICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJldHVybiBtZXRob2QgdGhyZXcgYW4gZXhjZXB0aW9uLCBsZXQgdGhhdFxuICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBwcmV2YWlsIG92ZXIgdGhlIG9yaWdpbmFsIHJldHVybiBvciB0aHJvdy5cbiAgICAgICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgICAgIC8vIENvbnRpbnVlIHdpdGggdGhlIG91dGVyIHJldHVybiwgbm93IHRoYXQgdGhlIGRlbGVnYXRlXG4gICAgICAgICAgICAgIC8vIGl0ZXJhdG9yIGhhcyBiZWVuIHRlcm1pbmF0ZWQuXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChcbiAgICAgICAgICAgIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0sXG4gICAgICAgICAgICBkZWxlZ2F0ZS5pdGVyYXRvcixcbiAgICAgICAgICAgIGFyZ1xuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIExpa2UgcmV0dXJuaW5nIGdlbmVyYXRvci50aHJvdyh1bmNhdWdodCksIGJ1dCB3aXRob3V0IHRoZVxuICAgICAgICAgICAgLy8gb3ZlcmhlYWQgb2YgYW4gZXh0cmEgZnVuY3Rpb24gY2FsbC5cbiAgICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICAgIGFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBEZWxlZ2F0ZSBnZW5lcmF0b3IgcmFuIGFuZCBoYW5kbGVkIGl0cyBvd24gZXhjZXB0aW9ucyBzb1xuICAgICAgICAgIC8vIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB0aGUgbWV0aG9kIHdhcywgd2UgY29udGludWUgYXMgaWYgaXQgaXNcbiAgICAgICAgICAvLyBcIm5leHRcIiB3aXRoIGFuIHVuZGVmaW5lZCBhcmcuXG4gICAgICAgICAgbWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgdmFyIGluZm8gPSByZWNvcmQuYXJnO1xuICAgICAgICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgICAgICAgIGNvbnRleHRbZGVsZWdhdGUucmVzdWx0TmFtZV0gPSBpbmZvLnZhbHVlO1xuICAgICAgICAgICAgY29udGV4dC5uZXh0ID0gZGVsZWdhdGUubmV4dExvYztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCkge1xuICAgICAgICAgICAgY29udGV4dC5zZW50ID0gYXJnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0LnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAgIC8vIHRoZW4gbGV0IHRoYXQgY2F0Y2ggYmxvY2sgaGFuZGxlIHRoZSBleGNlcHRpb24gbm9ybWFsbHkuXG4gICAgICAgICAgICBtZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmVcbiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWRcbiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcblxuICAgICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmVcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHtcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmRlbGVnYXRlICYmIG1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICAgICAgLy8gRGVsaWJlcmF0ZWx5IGZvcmdldCB0aGUgbGFzdCBzZW50IHZhbHVlIHNvIHRoYXQgd2UgZG9uJ3RcbiAgICAgICAgICAgICAgLy8gYWNjaWRlbnRhbGx5IHBhc3MgaXQgb24gdG8gdGhlIGRlbGVnYXRlLlxuICAgICAgICAgICAgICBhcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgIC8vIERpc3BhdGNoIHRoZSBleGNlcHRpb24gYnkgbG9vcGluZyBiYWNrIGFyb3VuZCB0byB0aGVcbiAgICAgICAgICAvLyBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGFyZykgY2FsbCBhYm92ZS5cbiAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0geyB0cnlMb2M6IGxvY3NbMF0gfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6IFwicm9vdFwiIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgcnVudGltZS5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIHJ1bnRpbWUudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24oc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICB0aGlzLnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KTtcblxuICAgICAgaWYgKCFza2lwVGVtcFJlc2V0KSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcykge1xuICAgICAgICAgIC8vIE5vdCBzdXJlIGFib3V0IHRoZSBvcHRpbWFsIG9yZGVyIG9mIHRoZXNlIGNvbmRpdGlvbnM6XG4gICAgICAgICAgaWYgKG5hbWUuY2hhckF0KDApID09PSBcInRcIiAmJlxuICAgICAgICAgICAgICBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJlxuICAgICAgICAgICAgICAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cbiAgICAgIHZhciByb290RW50cnkgPSB0aGlzLnRyeUVudHJpZXNbMF07XG4gICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uO1xuICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJvb3RSZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5ydmFsO1xuICAgIH0sXG5cbiAgICBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24oZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICAgIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgZnVuY3Rpb24gaGFuZGxlKGxvYywgY2F1Z2h0KSB7XG4gICAgICAgIHJlY29yZC50eXBlID0gXCJ0aHJvd1wiO1xuICAgICAgICByZWNvcmQuYXJnID0gZXhjZXB0aW9uO1xuICAgICAgICBjb250ZXh0Lm5leHQgPSBsb2M7XG4gICAgICAgIHJldHVybiAhIWNhdWdodDtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IFwicm9vdFwiKSB7XG4gICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBvdXRzaWRlIG9mIGFueSB0cnkgYmxvY2sgdGhhdCBjb3VsZCBoYW5kbGVcbiAgICAgICAgICAvLyBpdCwgc28gc2V0IHRoZSBjb21wbGV0aW9uIHZhbHVlIG9mIHRoZSBlbnRpcmUgZnVuY3Rpb24gdG9cbiAgICAgICAgICAvLyB0aHJvdyB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJldHVybiBoYW5kbGUoXCJlbmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldikge1xuICAgICAgICAgIHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCBcImNhdGNoTG9jXCIpO1xuICAgICAgICAgIHZhciBoYXNGaW5hbGx5ID0gaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKTtcblxuICAgICAgICAgIGlmIChoYXNDYXRjaCAmJiBoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYWJydXB0OiBmdW5jdGlvbih0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKSAmJlxuICAgICAgICAgICAgdGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgIHZhciBmaW5hbGx5RW50cnkgPSBlbnRyeTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZmluYWxseUVudHJ5ICYmXG4gICAgICAgICAgKHR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgICB0eXBlID09PSBcImNvbnRpbnVlXCIpICYmXG4gICAgICAgICAgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiZcbiAgICAgICAgICBhcmcgPD0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgLy8gSWdub3JlIHRoZSBmaW5hbGx5IGVudHJ5IGlmIGNvbnRyb2wgaXMgbm90IGp1bXBpbmcgdG8gYVxuICAgICAgICAvLyBsb2NhdGlvbiBvdXRzaWRlIHRoZSB0cnkvY2F0Y2ggYmxvY2suXG4gICAgICAgIGZpbmFsbHlFbnRyeSA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9O1xuICAgICAgcmVjb3JkLnR5cGUgPSB0eXBlO1xuICAgICAgcmVjb3JkLmFyZyA9IGFyZztcblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSkge1xuICAgICAgICB0aGlzLm5leHQgPSBmaW5hbGx5RW50cnkuZmluYWxseUxvYztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfSxcblxuICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZWNvcmQsIGFmdGVyTG9jKSB7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgIHJlY29yZC50eXBlID09PSBcImNvbnRpbnVlXCIpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZztcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgdGhpcy5ydmFsID0gcmVjb3JkLmFyZztcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGZpbmlzaDogZnVuY3Rpb24oZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbih0cnlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSB0cnlMb2MpIHtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRocm93bjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUaGUgY29udGV4dC5jYXRjaCBtZXRob2QgbXVzdCBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgbG9jYXRpb25cbiAgICAgIC8vIGFyZ3VtZW50IHRoYXQgY29ycmVzcG9uZHMgdG8gYSBrbm93biBjYXRjaCBibG9jay5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuXG4gICAgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24oaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG59KShcbiAgLy8gQW1vbmcgdGhlIHZhcmlvdXMgdHJpY2tzIGZvciBvYnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbFxuICAvLyBvYmplY3QsIHRoaXMgc2VlbXMgdG8gYmUgdGhlIG1vc3QgcmVsaWFibGUgdGVjaG5pcXVlIHRoYXQgZG9lcyBub3RcbiAgLy8gdXNlIGluZGlyZWN0IGV2YWwgKHdoaWNoIHZpb2xhdGVzIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5KS5cbiAgdHlwZW9mIGdsb2JhbCA9PT0gXCJvYmplY3RcIiA/IGdsb2JhbCA6XG4gIHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgPyB3aW5kb3cgOlxuICB0eXBlb2Ygc2VsZiA9PT0gXCJvYmplY3RcIiA/IHNlbGYgOiB0aGlzXG4pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIGZhdm9yaXRlcyBibG9ja1xuICAgICAqIEBjbGFzc1xuICAgICAqL1xuICAgIGNsYXNzIEZhdm9yaXRlcyB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1biBpbml0IHdoZW4gZG9tIGlzIHJlYWR5XG4gICAgICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIGxldCByZWFkeSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudHMgYW5kIGluaXRpYWxpemVcbiAgICAgICAgICovXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmZhdm9yaXRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZScpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmF2b3JpdGVzID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIGxldCBwcm9kdWN0cyA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9kdWN0Jyk7XG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gcHJvZHVjdHMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT0gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZhdm9yaXRlcyk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmF2b3JpdGVzO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9ucyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zaXRpb25zJyk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fd3JhcHBlci1pbm5lcicpO1xuXG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uID0gdGhpcy5mYXZvcml0ZXMucXVlcnlTZWxlY3RvcignLmZhdm9yaXRlX19idXR0b25fbmV4dCcpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX3ByZXYnKTtcbiAgICAgICAgICAgIHRoaXMubWVudSA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fbWVudScpO1xuXG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5uZXh0LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucHJldi5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5tYXJnaW4gPSAyMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gcHJvZHVjdHNbMF0ub2Zmc2V0V2lkdGggKyB0aGlzLm1hcmdpbjtcbiAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoK3RoaXMubWFyZ2luKS90aGlzLndpZHRoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lPj10aGlzLmNvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnZmF2b3JpdGVfX21lbnVfaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50aW1lciA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9ucykge1xuICAgICAgICAgICAgICAgIGxldCB0cmFuc0VuZEV2ZW50TmFtZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnV2Via2l0VHJhbnNpdGlvbic6ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdNb3pUcmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ09UcmFuc2l0aW9uJzogJ29UcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdtc1RyYW5zaXRpb24nOiAnTVNUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNFbmRFdmVudE5hbWVzW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSwgdGhpcy5zdG9wQW5pbWF0aW9uLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgKi9cbiAgICAgICAgc3RhcnRBbmltYXRpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgKi9cbiAgICAgICAgc3RvcEFuaW1hdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50aW1lciAhPSBudWxsKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAqL1xuICAgICAgICBkcm9wQW5pbWF0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAyNTApO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlbGVjdCBuZXh0IHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICovXG4gICAgICAgIG5leHQgKCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50Kys7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IHRoaXMuY291bnQtdGhpcy5pbmxpbmUrMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2VsZWN0IHByZXZpb3VzIHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICovXG4gICAgICAgIHByZXYgKCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50LS07XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5jb3VudC10aGlzLmlubGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWNvdW50IG9uIHJlc2l6ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVzaXplICgpIHtcbiAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoK3RoaXMubWFyZ2luKS90aGlzLndpZHRoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lPj10aGlzLmNvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBzY3JvbGwgKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpXSA9ICd0cmFuc2xhdGVYKCcgKyAoLXRoaXMud2lkdGggKiAodGhpcy5jdXJyZW50KSkgKyAncHgpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gKC10aGlzLndpZHRoICogKHRoaXMuY3VycmVudCkpICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmV3IEZhdm9yaXRlcztcblxufSkoKVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIG5hdmlnYXRpb24gb24gbG93IHJlc29sdXRpb25cbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cbiAgICBjbGFzcyBOYXZpZ2F0aW9uIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUnVuIGluaXQgd2hlbiBkb20gaXMgcmVhZHlcbiAgICAgICAgICogQGNvbnN0cnVjdHNcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBhbmQgaW5pdGlhbGl6ZVxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdCAoKSB7XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbicpO1xuICAgICAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvbiA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgbGFiZWxzID0gdGhpcy5uYXZpZ2F0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZpZ2F0aW9uX19sYWJlbCcpO1xuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGxhYmVscywgbGFiZWwgPT4ge1xuICAgICAgICAgICAgICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuRHJvcGRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy50b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbl9fdG9nZ2xlJyk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlTmF2aWdhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTaG93IGFuZCBoaWRlIG5hdmlnYXRpb24gb24gbW9iaWxlXG4gICAgICAgICAqL1xuICAgICAgICB0b2dnbGVOYXZpZ2F0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX29wZW4nKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlLmJsdXIoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9vcGVuJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2hvdyBhbmQgaGlkZSBkcm9wZG93blxuICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCDigJTCoGNsaWNrIGV2ZW50LCBzbyB3ZSBtYXkgZ2V0IGRyb3Bkb3duIHRvIG9wZW5cbiAgICAgICAgICovXG4gICAgICAgIG9wZW5Ecm9wZG93biAoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fbGFiZWxfb3BlbicpO1xuICAgICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fY29udGFpbmVyX29wZW4nKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgbmV3IE5hdmlnYXRpb247XG59KSgpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIHNjcm9sbGVyXG4gICAgICogQGNsYXNzXG4gICAgICovXG4gICAgY2xhc3MgU2Nyb2xsZXIge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdW4gaW5pdCB3aGVuIGRvbSBpcyByZWFkeVxuICAgICAgICAgKiBAY29uc3RydWN0c1xuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgZXZlbnRzIGFuZCBpbml0aWFsaXplXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcicpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxlciA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fd3JhcHBlci1pbm5lcicpO1xuICAgICAgICAgICAgdGhpcy5zbGlkZXMgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVyX19zbGlkZScpO1xuICAgICAgICAgICAgdGhpcy5jb3VudCA9IHRoaXMuc2xpZGVzLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5zbGlkZXMpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLndyYXBwZXI7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2xpZGVzO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcm9sbGVyO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9ucyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zaXRpb25zJyk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3BhZ2luYXRvcicpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX19wcmV2Jyk7XG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX25leHQnKTtcblxuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblByZXZTbGlkZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5OZXh0U2xpZGUuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGxldCBmaXJzdF9zbGlkZSA9IHRoaXMuc2xpZGVzWzBdLmNsb25lTm9kZSh0cnVlKVxuICAgICAgICAgICAgICAgICwgbGFzdF9zbGlkZSA9IHRoaXMuc2xpZGVzW3RoaXMuY291bnQgLSAxXS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAgICAgICAgIGZpcnN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgbGFzdF9zbGlkZS5jbGFzc0xpc3QuYWRkKCdjbG9uZWQnKTtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZChmaXJzdF9zbGlkZSk7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIuaW5zZXJ0QmVmb3JlKGxhc3Rfc2xpZGUsIHRoaXMuc2xpZGVzWzBdKTtcblxuICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jb3VudDtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24odGhpcy5jb3VudCAtIGluZGV4IC0gMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gMDtcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yX2J1dHRvbnMgPSB0aGlzLnBhZ2luYXRvci5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZXJfX3BhZ2UnKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zWzBdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50Jyk7XG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRhbnNpdGlvbl90aW1lciA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnT1RyYW5zaXRpb24nOiAnb1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ21zVHJhbnNpdGlvbic6ICdNU1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc0VuZEV2ZW50TmFtZXNbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldLCB0aGlzLmNoZWNrSW5kZXguYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKS5kZWxheSgpLnRoZW4odGhpcy50dXJuT24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVkLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogTW92ZSB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlVG9DdXJyZW50KCkge1xuICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1vdmUgdG8gZmlyc3Qgc2xpZGVcbiAgICAgICAgICovXG4gICAgICAgIG1vdmVUb0ZpcnN0KCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSAwO1xuICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNb3ZlIHRvIGxhc3Qgc2xpZGVcbiAgICAgICAgICovXG4gICAgICAgIG1vdmVUb0xhc3QoKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHRoaXMuY291bnQgLSAxO1xuICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUdXJuIG9uIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICovXG4gICAgICAgIHR1cm5PbigpIHtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0gPSBNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpICsgJyAuMjVzJztcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFR1cm4gb2ZmIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICovXG4gICAgICAgIHR1cm5PZmYoKSB7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldID0gJ25vbmUnO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2hvdyBzbGlkZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXjCoOKAlCBzbGlkZSBudW1iZXJcbiAgICAgICAgICovXG4gICAgICAgIG1vdmUoaW5kZXgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zZm9ybXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgKC10aGlzLndyYXBwZXIub2Zmc2V0V2lkdGggKiAoaW5kZXggKyAxKSkgKyAncHgpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gKC10aGlzLndyYXBwZXIub2Zmc2V0V2lkdGggKiAoaW5kZXggKyAxKSkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJld2luZCBzbGlkZXMgb24gcmVzaXplXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyByZXNpemVkKCkge1xuICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgIHRoaXMubW92ZVRvQ3VycmVudCgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGF5LCBzbyBicm93c2VyIG1heSByZWJ1aWxkIERPTSBhbmQgQ1NTXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBtaWxsaXNlY29uZHMg4oCUIGRlbGF5IGR1cmF0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBkZWxheShtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXdpbmQgc2xpZGVzXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBjaGVja0luZGV4KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9wYWdlID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9MYXN0KCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50X3BhZ2UgPT0gdGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGVsYXkoMjUpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFuaW1hdGlvbiBmbGFnXG4gICAgICAgICAqL1xuICAgICAgICBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgYW5pbWF0aW9uIGZsYWdcbiAgICAgICAgICovXG4gICAgICAgIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAqL1xuICAgICAgICBkcm9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAodGhpcy50aW1lcikgIT0gJ3VuZGVmaW5lZCcpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAzNTApO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZSBwYWdpbmF0b3IgYnV0dG9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCDigJTCoHNsaWRlIG51bWJlclxuICAgICAgICAgKi9cbiAgICAgICAgY3JlYXRlQnV0dG9uKGluZGV4KSB7XG4gICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyksIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTUEFOJyk7XG4gICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlJywgaW5kZXgpO1xuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbGVyX19wYWdlJyk7XG4gICAgICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNjcm9sbFRvU2xpZGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRvci5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBvcGVuU2xpZGUoKSB7XG4gICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgaWYoIXRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YW5zaXRpb25fdGltZXIhPW51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRhbnNpdGlvbl90aW1lcik7XG4gICAgICAgICAgICAgICAgdGhpcy50YW5zaXRpb25fdGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuY2hlY2tJbmRleC5iaW5kKHRoaXMpLCAyNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBwcmV2aW91cyBzbGlkZVxuICAgICAgICAgKi9cbiAgICAgICAgb3BlblByZXZTbGlkZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZS0tO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBuZXh0IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBvcGVuTmV4dFNsaWRlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlKys7XG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIHRoaXMub3BlblNsaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2Nyb2xsIHRvIHNlbGVjdGVkIHNsaWRlXG4gICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IOKAlCBjbGljayBldmVudCwgc28gd2UgbWF5IGdldCBwYWdpbmF0b3IgYnV0dG9uXG4gICAgICAgICAqL1xuICAgICAgICBzY3JvbGxUb1NsaWRlKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHBhcnNlSW50KGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScpLCAxMCk7XG4gICAgICAgICAgICBidXR0b24uYmx1cigpO1xuICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNb3ZlIHNjcm9sbGVyIHRvIHNlbGVjdGVkIHNsaWRlIGFuZCBzZXQgYnV0dG9ucyBzdGF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVwb3NTbGlkZSgpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZXJfX3BhZ2VfY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zW01hdGgubWluKE1hdGgubWF4KHRoaXMuY3VycmVudF9wYWdlLCAwKSwgdGhpcy5jb3VudCAtIDEpXTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZXJfX3BhZ2VfY3VycmVudCcsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIG5ldyBTY3JvbGxlcjtcbn0pKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbihmdW5jdGlvbigpIHtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgQ2xhc3MgaGFuZGxlIHN1YnNjcmlwdGlvbiBwcm9jZXNzXG4gICAgICovXG4gICAgY2xhc3MgU3Vic2NyaWJlIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTdGFydCBpbml0aWFsaXphdGlvbiBvbiBkb21sb2FkXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZGluZyBldmVudHMgYW5kIHByb3BlcnRpZXNcbiAgICAgICAgICovXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5mb3JtID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMuaW5wdXQgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fZW1haWwnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19tZXNzYWdlID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19mYWlsID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX2ZhaWwnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19wcm9ncmVzcyA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9pbi1wcm9ncmVzcycpO1xuXG4gICAgICAgICAgICB0aGlzLmZvcm0uc2V0QXR0cmlidXRlKCdub3ZhbGlkYXRlJywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy52YWxpZGF0ZUZvcm0uYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFZhbGlkYXRpbmcgdXNlciBpbnB1dFxuICAgICAgICAgKi9cbiAgICAgICAgdmFsaWRhdGVGb3JtKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBsZXQgZW1haWxfcmVnZXggPSBuZXcgUmVnRXhwKFwiXihbYS16QS1aMC05X1xcLlxcLV0pK1xcQCgoW2EtekEtWjAtOVxcLV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyRcIik7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgKHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDAgJiYgZW1haWxfcmVnZXgudGVzdCh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKSkgPT09IGZhbHNlIHx8IHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICB8fCAodGhpcy5pbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdmYWlsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgRE9ORSA9IDRcbiAgICAgICAgICAgICAgICAsIE9LID0gMjAwXG4gICAgICAgICAgICAgICAgLCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICAgICAgICAgICwgc2VuZGVyID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdqcy9zdWJzY3JpYmUuanNvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNlbmQobmV3IEZvcm1EYXRhKHRoaXMuZm9ybSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5jb2RlICsgJzogJyArIHhoci5zdGF0dXNUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdwcm9ncmVzcycpO1xuICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5zdWNjZXNzLmJpbmQodGhpcykpLmNhdGNoKHRoaXMuZmFpbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gcmVxdWVzdCBoYXZlIHN1Y2NlZWRlZFxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBzZXJ2ZXIgYW5zd2VyXG4gICAgICAgICAqL1xuICAgICAgICBzdWNjZXNzIChtZXNzYWdlKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShtZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcyl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdmYWlsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBmYWlsZWRcbiAgICAgICAgICogQHBhcmFtIHtFcnJvcn0gZXJyb3IgZXJyb3Igb2JqZWN0XG4gICAgICAgICAqL1xuICAgICAgICBmYWlsIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTZXQgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdGF0ZSBuZXcgc3RhdGVcbiAgICAgICAgICovXG4gICAgICAgIHNldFN0YXRlIChzdGF0ZSkge1xuXG4gICAgICAgICAgICBsZXQgZmFpbCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImZhaWxcIjpcbiAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicHJvZ3Jlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9mYWlsJywgZmFpbCk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5jbGFzc0xpc3QudG9nZ2xlKCdzdWJzY3JpYmVfcHJvZ3Jlc3MnLCBwcm9ncmVzcyk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBuZXcgU3Vic2NyaWJlO1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuKGZ1bmN0aW9uKCkge1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDbGFzcyBoYW5kbGUgdGFicyBsb2FkaW5nXG4gICAgICovXG4gICAgY2xhc3MgVGFicyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFicycpO1xuICAgICAgICAgICAgaWYgKHRoaXMud2lkZ2V0ID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIGxldCBET05FID0gNFxuICAgICAgICAgICAgICAgICwgT0sgPSAyMDBcbiAgICAgICAgICAgICAgICAsIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG4gICAgICAgICAgICAgICAgLCBzZW5kZXIgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub3BlbignR0VUJywgJ2pzL3RhYnMuanNvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSBET05FKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gT0spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoeGhyLmNvZGUgKyAnOiAnICsgeGhyLnN0YXR1c1RleHQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNlbmRlci50aGVuKHRoaXMuYnVpbGQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEJ1aWxkIHdpZGdldFxuICAgICAgICAgKi9cbiAgICAgICAgYnVpbGQgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShtZXNzYWdlLnJlcGxhY2UoL1xcbi9nLCBcIlxcXFxuXCIpLnJlcGxhY2UoL1xcci9nLCBcIlxcXFxyXCIpLnJlcGxhY2UoL1xcdC9nLCBcIlxcXFx0XCIpLnJlcGxhY2UoL1xcZi9nLCBcIlxcXFxmXCIpKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpZGdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMud2lkZ2V0KTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53aWRnZXQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ01FTlUnKTtcbiAgICAgICAgICAgIG1lbnUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3Rvb2xiYXInKTtcbiAgICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZCgndGFic19fbWVudScpO1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQobWVudSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IHRhYiBvZiBkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJylcbiAgICAgICAgICAgICAgICAgICAgLCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTRUNUSU9OJylcbiAgICAgICAgICAgICAgICAgICAgLCB0ZXh0ID0gdGFiLkNvbnRlbnQuc3BsaXQoJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcsIHRhYi5UaXRsZSk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0YWIuVGl0bGUpKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5UYWIuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChidXR0b24pO1xuXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS10YWInLCB0YWIuVGl0bGUpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCd0YWJzX190YWInKTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IHBhcmFncmFwaCBvZiB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnUCcpO1xuICAgICAgICAgICAgICAgICAgICBwLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHBhcmFncmFwaCkpO1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKS5jbGljaygpO1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuY2xhc3NMaXN0LmFkZCgndGFic19idWlsZGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBvcGVuVGFiIChldmVudCkge1xuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXRcbiAgICAgICAgICAgICAgICAsIHRhcmdldCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX3RhYl9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X2J1dHRvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX19idXR0b25fY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IGJ1dHRvbjtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fYnV0dG9uX2N1cnJlbnQnLCB0cnVlKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYiA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYj0nICsgdGFyZ2V0ICsgJ10nKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX3RhYl9jdXJyZW50JywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXcgVGFicztcbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

"use strict";function _typeof(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function i(i,o){try{var a=e[i](o),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(r,s)}var r=i.bind(null,"next"),s=i.bind(null,"throw");r()})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t){function e(t,e,n,r){var s=Object.create((e||i).prototype),o=new f(r||[]);return s._invoke=c(t,n,o),s}function n(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(i){return{type:"throw",arg:i}}}function i(){}function r(){}function s(){}function o(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function a(t){this.arg=t}function u(t){function e(i,r,s,o){var u=n(t[i],t,r);if("throw"!==u.type){var c=u.arg,l=c.value;return l instanceof a?Promise.resolve(l.arg).then(function(t){e("next",t,s,o)},function(t){e("throw",t,s,o)}):Promise.resolve(l).then(function(t){c.value=t,s(c)},o)}o(u.arg)}function i(t,n){function i(){return new Promise(function(i,r){e(t,n,i,r)})}return r=r?r.then(i,i):i()}"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.domain&&(e=process.domain.bind(e));var r;this._invoke=i}function c(t,e,i){var r=k;return function(s,o){if(r===x)throw new Error("Generator is already running");if(r===S){if("throw"===s)throw o;return p()}for(;;){var a=i.delegate;if(a){if("return"===s||"throw"===s&&a.iterator[s]===v){i.delegate=null;var u=a.iterator["return"];if(u){var c=n(u,a.iterator,o);if("throw"===c.type){s="throw",o=c.arg;continue}}if("return"===s)continue}var c=n(a.iterator[s],a.iterator,o);if("throw"===c.type){i.delegate=null,s="throw",o=c.arg;continue}s="next",o=v;var l=c.arg;if(!l.done)return r=L,l;i[a.resultName]=l.value,i.next=a.nextLoc,i.delegate=null}if("next"===s)r===L?i.sent=o:i.sent=v;else if("throw"===s){if(r===k)throw r=S,o;i.dispatchException(o)&&(s="next",o=v)}else"return"===s&&i.abrupt("return",o);r=x;var c=n(t,e,i);if("normal"===c.type){r=i.done?S:L;var l={value:c.arg,done:i.done};if(c.arg!==E)return l;i.delegate&&"next"===s&&(o=v)}else"throw"===c.type&&(r=S,s="throw",o=c.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function f(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function d(t){if(t){var e=t[g];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(m.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=v,r.done=!0,r};return i.next=i}}return{next:p}}function p(){return{value:v,done:!0}}var v,m=Object.prototype.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},g=y.iterator||"@@iterator",b=y.toStringTag||"@@toStringTag",_="object"===("undefined"==typeof module?"undefined":_typeof(module)),w=t.regeneratorRuntime;if(w)return void(_&&(module.exports=w));w=t.regeneratorRuntime=_?module.exports:{},w.wrap=e;var k="suspendedStart",L="suspendedYield",x="executing",S="completed",E={},T=s.prototype=i.prototype;r.prototype=T.constructor=s,s.constructor=r,s[b]=r.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return e?e===r||"GeneratorFunction"===(e.displayName||e.name):!1},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(T),t},w.awrap=function(t){return new a(t)},o(u.prototype),w.async=function(t,n,i,r){var s=new u(e(t,n,i,r));return w.isGeneratorFunction(n)?s:s.next().then(function(t){return t.done?t.value:s.next()})},o(T),T[g]=function(){return this},T[b]="Generator",T.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},w.values=d,f.prototype={constructor:f,reset:function(t){if(this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return s.type="throw",s.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var o=m.call(r,"catchLoc"),a=m.call(r,"finallyLoc");if(o&&a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&m.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?this.next=r.finallyLoc:this.complete(s),E},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),E}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;h(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},E}}}("object"===("undefined"==typeof global?"undefined":_typeof(global))?global:"object"===("undefined"==typeof window?"undefined":_typeof(window))?window:"object"===("undefined"==typeof self?"undefined":_typeof(self))?self:void 0);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.favorites=document.querySelector(".favorite"),null!==this.favorites){var t=this.favorites.querySelectorAll(".product");if(this.count=t.length,0==this.count)return this.favorites.parentNode.removeChild(this.favorites),delete this.count,void delete this.favorites;if(this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.wrapper=this.favorites.querySelector(".favorite__wrapper-inner"),this.next_button=this.favorites.querySelector(".favorite__button_next"),this.prev_button=this.favorites.querySelector(".favorite__button_prev"),this.menu=this.favorites.querySelector(".favorite__menu"),this.next_button.addEventListener("click",this.next.bind(this)),this.prev_button.addEventListener("click",this.prev.bind(this)),this.margin=20,this.current=0,this.width=t[0].offsetWidth+this.margin,this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?this.menu.classList.toggle("favorite__menu_hidden",!0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.animation=!1,this.timer=null,this.transitions){var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(e[Modernizr.prefixed("transition")],this.stopAnimation.bind(this))}window.addEventListener("resize",this.resize.bind(this))}}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"stopAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.animation=!1}},{key:"dropAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),250)}},{key:"next",value:function(){this.current++,this.current==this.count-this.inline+1&&(this.current=0),this.scroll(),this.next_button.blur()}},{key:"prev",value:function(){this.current--,-1==this.current&&(this.current=this.count-this.inline),this.scroll(),this.prev_button.blur()}},{key:"resize",value:function(){this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?(this.menu.classList.toggle("favorite__menu_hidden",!0),this.current=0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.scroll()}},{key:"scroll",value:function(){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.width*this.current+"px)":this.wrapper.style.right=-this.width*this.current+"px",this.dropAnimation()}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.navigation=document.querySelector(".navigation"),null!==this.navigation){var e=this.navigation.querySelectorAll(".navigation__label");[].forEach.call(e,function(e){e.addEventListener("click",t.openDropdown.bind(t))}),this.toggle=document.querySelector(".navigation__toggle"),this.toggle.addEventListener("click",this.toggleNavigation.bind(this))}}},{key:"toggleNavigation",value:function(){this.navigation.classList.toggle("navigation_open"),this.toggle.blur(),document.body.classList.toggle("navigation_open")}},{key:"openDropdown",value:function(t){t.currentTarget.classList.toggle("navigation__label_open"),t.currentTarget.nextElementSibling.classList.toggle("navigation__container_open")}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.scroller=document.querySelector(".scroller"),null!==this.scroller){if(this.wrapper=this.scroller.querySelector(".scroller__wrapper-inner"),this.slides=this.wrapper.querySelectorAll(".scroller__slide"),this.count=this.slides.length,0===this.count)return this.scroller.parentNode.removeChild(this.slides),delete this.wrapper,delete this.slides,delete this.scroller,void delete this.count;this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.paginator=this.scroller.querySelector(".scroller__paginator"),this.prev_button=this.scroller.querySelector(".scroller__prev"),this.next_button=this.scroller.querySelector(".scroller__next"),this.prev_button.addEventListener("click",this.openPrevSlide.bind(this)),this.next_button.addEventListener("click",this.openNextSlide.bind(this));var t=this.slides[0].cloneNode(!0),e=this.slides[this.count-1].cloneNode(!0);t.classList.add("cloned"),e.classList.add("cloned"),this.wrapper.appendChild(t),this.wrapper.insertBefore(e,this.slides[0]);for(var n=this.count;n--;)this.createButton(this.count-n-1);if(this.current_page=0,this.paginator_buttons=this.paginator.querySelectorAll(".scroller__page"),this.current_button=this.paginator_buttons[0],this.current_button.classList.add("scroller__page_current"),this.animation=!1,this.tansition_timer=null,this.transitions){var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(i[Modernizr.prefixed("transition")],this.checkIndex.bind(this))}this.moveToFirst().delay().then(this.turnOn.bind(this)),window.addEventListener("resize",this.resized.bind(this))}}},{key:"moveToCurrent",value:function(){return this.move(this.current_page),this}},{key:"moveToFirst",value:function(){return this.current_page=0,this.reposSlide(),this}},{key:"moveToLast",value:function(){return this.current_page=this.count-1,this.reposSlide(),this}},{key:"turnOn",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]=Modernizr.prefixed("transform")+" .25s",this}},{key:"turnOff",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]="none",this}},{key:"move",value:function(t){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.wrapper.offsetWidth*(t+1)+"px)":this.wrapper.style.right=-this.wrapper.offsetWidth*(t+1)+"px"}},{key:"resized",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.turnOff(),t.next=3,this.delay(25);case 3:return this.moveToCurrent(),t.next=6,this.delay(25);case 6:this.turnOn();case 7:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"delay",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){setTimeout(e,t)}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"checkIndex",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!=this.current_page){t.next=10;break}return this.turnOff(),t.next=4,this.delay(25);case 4:return this.moveToLast(),t.next=7,this.delay(25);case 7:this.turnOn(),t.next=18;break;case 10:if(this.current_page!=this.count){t.next=18;break}return this.turnOff(),t.next=14,this.delay(25);case 14:return this.moveToFirst(),t.next=17,this.delay(25);case 17:this.turnOn();case 18:this.stopAnimation();case 19:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stopAnimation",value:function(){this.animation=!1}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"dropAnimation",value:function(){"undefined"!=typeof this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),350)}},{key:"createButton",value:function(t){var e=document.createElement("BUTTON"),n=document.createElement("SPAN");e.setAttribute("type","button"),e.setAttribute("data-page",t),e.classList.add("scroller__page"),e.appendChild(n),e.addEventListener("click",this.scrollToSlide.bind(this)),this.paginator.appendChild(e)}},{key:"openSlide",value:function(){this.reposSlide(),this.dropAnimation(),this.transitions||(null!=this.tansition_timer&&clearTimeout(this.tansition_timer),this.tansition_timer=setTimeout(this.checkIndex.bind(this),250))}},{key:"openPrevSlide",value:function(){this.animation!==!0&&(this.startAnimation(),this.current_page--,this.prev_button.blur(),this.openSlide())}},{key:"openNextSlide",value:function(){this.animation!==!0&&(this.startAnimation(),this.current_page++,this.next_button.blur(),this.openSlide())}},{key:"scrollToSlide",value:function(t){if(this.animation!==!0){this.startAnimation();var e=t.currentTarget;this.current_page=parseInt(e.getAttribute("data-page"),10),e.blur(),this.openSlide()}}},{key:"reposSlide",value:function(){this.current_button.classList.toggle("scroller__page_current",!1),this.current_button=this.paginator_buttons[Math.min(Math.max(this.current_page,0),this.count-1)],this.current_button.classList.toggle("scroller__page_current",!0),this.move(this.current_page)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.widget=document.querySelector(".tabs"),null!==this.widget){var t=4,e=200,n=new XMLHttpRequest,i=new Promise(function(i,r){try{n.open("GET","js/tabs.json"),n.send(),n.onreadystatechange=function(){n.readyState===t&&(n.status===e?i(n.response):r(new Error(n.code+": "+n.statusText)))}}catch(s){r(s)}});i.then(this.build.bind(this))}}},{key:"build",value:function(t){var e=JSON.parse(t.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f"));if(this.current_button=null,this.current_tab=null,0==e.length)return this.widget.parentNode.removeChild(this.widget),void delete this.widget;var n=document.createElement("MENU");n.setAttribute("type","toolbar"),n.classList.add("tabs__menu"),this.widget.appendChild(n);var i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var u=o.value,c=document.createElement("BUTTON"),l=document.createElement("SECTION"),h=u.Content.split("\n\n");c.setAttribute("type","button"),c.setAttribute("data-target",u.Title),c.classList.add("tabs__button"),c.appendChild(document.createTextNode(u.Title)),c.addEventListener("click",this.openTab.bind(this)),n.appendChild(c),l.setAttribute("data-tab",u.Title),l.classList.add("tabs__tab");var f=!0,d=!1,p=void 0;try{for(var v,m=h[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var y=v.value,g=document.createElement("P");g.appendChild(document.createTextNode(y)),l.appendChild(g)}}catch(b){d=!0,p=b}finally{try{!f&&m["return"]&&m["return"]()}finally{if(d)throw p}}this.widget.appendChild(l)}}catch(b){r=!0,s=b}finally{try{!i&&a["return"]&&a["return"]()}finally{if(r)throw s}}n.querySelector("button").click(),this.widget.classList.add("tabs_builded")}},{key:"openTab",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-target");null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!1),null!=this.current_button&&this.current_button.classList.toggle("tabs__button_current",!1),this.current_button=e,this.current_button.classList.toggle("tabs__button_current",!0),this.current_tab=this.widget.querySelector("[data-tab="+n+"]"),null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!0)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){this.form=document.querySelector(".subscribe"),null!==this.form&&(this.input=this.form.querySelector(".subscribe__email"),this.success_message=this.form.querySelector(".subscribe__state_success"),this.success_fail=this.form.querySelector(".subscribe__state_fail"),this.success_progress=this.form.querySelector(".subscribe__state_in-progress"),this.form.setAttribute("novalidate",!0),this.form.addEventListener("submit",this.validateForm.bind(this)))}},{key:"validateForm",value:function(t){var e=this;t.preventDefault();var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$");if(this.input.value.trim().length>0&&n.test(this.input.value.trim())===!1||0===this.input.value.trim().length||0===this.input.value.trim().length)return void this.setState("fail");var i=4,r=200,s=new XMLHttpRequest,o=new Promise(function(t,n){try{s.open("GET","js/subscribe.json"),s.send(new FormData(e.form)),s.onreadystatechange=function(){s.readyState===i&&(e.form.reset(),e.setState(),s.status===r?t(s.response):n(new Error(s.code+": "+s.statusText)))}}catch(o){n(o)}});this.setState("progress"),o.then(this.success.bind(this))["catch"](this.fail.bind(this))}},{key:"success",value:function(t){var e=JSON.parse(t);e.success?this.setState("success"):this.setState("fail")}},{key:"fail",value:function(t){this.setState("fail")}},{key:"setState",value:function(t){var e=!1,n=!1,i=!1;switch(t){case"fail":e=!0,this.input.focus();break;case"success":n=!0,this.input.blur();break;case"progress":i=!0}this.form.classList.toggle("subscribe_fail",e),this.form.classList.toggle("subscribe_success",n),this.form.classList.toggle("subscribe_progress",i)}}]),t}();new t}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiLCJydW50aW1lLmpzIiwiZmF2b3JpdGUuanMiLCJuYXZpZ2F0aW9uLmpzIiwic2Nyb2xsZXIuanMiLCJ0YWJzLmpzIiwic3Vic2NyaWJlLmpzIl0sIm5hbWVzIjpbIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJjb25zdHJ1Y3RvciIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfYXN5bmNUb0dlbmVyYXRvciIsImZuIiwiZ2VuIiwiYXBwbHkiLCJ0aGlzIiwiYXJndW1lbnRzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdGVwIiwia2V5IiwiYXJnIiwiaW5mbyIsInZhbHVlIiwiZXJyb3IiLCJkb25lIiwidGhlbiIsImNhbGxOZXh0IiwiY2FsbFRocm93IiwiYmluZCIsImdsb2JhbCIsIndyYXAiLCJpbm5lckZuIiwib3V0ZXJGbiIsInNlbGYiLCJ0cnlMb2NzTGlzdCIsImdlbmVyYXRvciIsIk9iamVjdCIsImNyZWF0ZSIsIkdlbmVyYXRvciIsInByb3RvdHlwZSIsImNvbnRleHQiLCJDb250ZXh0IiwiX2ludm9rZSIsIm1ha2VJbnZva2VNZXRob2QiLCJ0cnlDYXRjaCIsInR5cGUiLCJjYWxsIiwiZXJyIiwiR2VuZXJhdG9yRnVuY3Rpb24iLCJHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSIsImRlZmluZUl0ZXJhdG9yTWV0aG9kcyIsImZvckVhY2giLCJtZXRob2QiLCJBd2FpdEFyZ3VtZW50IiwiQXN5bmNJdGVyYXRvciIsImludm9rZSIsInJlY29yZCIsInJlc3VsdCIsInVud3JhcHBlZCIsImVucXVldWUiLCJjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyIsInByZXZpb3VzUHJvbWlzZSIsInByb2Nlc3MiLCJkb21haW4iLCJzdGF0ZSIsIkdlblN0YXRlU3VzcGVuZGVkU3RhcnQiLCJHZW5TdGF0ZUV4ZWN1dGluZyIsIkVycm9yIiwiR2VuU3RhdGVDb21wbGV0ZWQiLCJkb25lUmVzdWx0IiwiZGVsZWdhdGUiLCJpdGVyYXRvciIsInVuZGVmaW5lZCIsInJldHVybk1ldGhvZCIsIkdlblN0YXRlU3VzcGVuZGVkWWllbGQiLCJyZXN1bHROYW1lIiwibmV4dCIsIm5leHRMb2MiLCJzZW50IiwiZGlzcGF0Y2hFeGNlcHRpb24iLCJhYnJ1cHQiLCJDb250aW51ZVNlbnRpbmVsIiwicHVzaFRyeUVudHJ5IiwibG9jcyIsImVudHJ5IiwidHJ5TG9jIiwiY2F0Y2hMb2MiLCJmaW5hbGx5TG9jIiwiYWZ0ZXJMb2MiLCJ0cnlFbnRyaWVzIiwicHVzaCIsInJlc2V0VHJ5RW50cnkiLCJjb21wbGV0aW9uIiwicmVzZXQiLCJ2YWx1ZXMiLCJpdGVyYWJsZSIsIml0ZXJhdG9yTWV0aG9kIiwiaXRlcmF0b3JTeW1ib2wiLCJpc05hTiIsImxlbmd0aCIsImkiLCJoYXNPd24iLCJoYXNPd25Qcm9wZXJ0eSIsIiRTeW1ib2wiLCJ0b1N0cmluZ1RhZ1N5bWJvbCIsInRvU3RyaW5nVGFnIiwiaW5Nb2R1bGUiLCJtb2R1bGUiLCJydW50aW1lIiwicmVnZW5lcmF0b3JSdW50aW1lIiwiZXhwb3J0cyIsIkdwIiwiZGlzcGxheU5hbWUiLCJpc0dlbmVyYXRvckZ1bmN0aW9uIiwiZ2VuRnVuIiwiY3RvciIsIm5hbWUiLCJtYXJrIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJhd3JhcCIsImFzeW5jIiwiaXRlciIsInRvU3RyaW5nIiwia2V5cyIsIm9iamVjdCIsInJldmVyc2UiLCJwb3AiLCJza2lwVGVtcFJlc2V0IiwicHJldiIsImNoYXJBdCIsInNsaWNlIiwic3RvcCIsInJvb3RFbnRyeSIsInJvb3RSZWNvcmQiLCJydmFsIiwiZXhjZXB0aW9uIiwiaGFuZGxlIiwibG9jIiwiY2F1Z2h0IiwiaGFzQ2F0Y2giLCJoYXNGaW5hbGx5IiwiZmluYWxseUVudHJ5IiwiY29tcGxldGUiLCJmaW5pc2giLCJjYXRjaCIsInRocm93biIsImRlbGVnYXRlWWllbGQiLCJ3aW5kb3ciLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJGYXZvcml0ZXMiLCJyZWFkeSIsImRvY3VtZW50IiwicmVhZHlTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbml0IiwiZmF2b3JpdGVzIiwicXVlcnlTZWxlY3RvciIsInByb2R1Y3RzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvdW50IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidHJhbnNpdGlvbnMiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInRyYW5zZm9ybXMiLCJ3cmFwcGVyIiwibmV4dF9idXR0b24iLCJwcmV2X2J1dHRvbiIsIm1lbnUiLCJtYXJnaW4iLCJjdXJyZW50Iiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImlubGluZSIsIk1hdGgiLCJmbG9vciIsInRvZ2dsZSIsImFuaW1hdGlvbiIsInRpbWVyIiwidHJhbnNFbmRFdmVudE5hbWVzIiwiV2Via2l0VHJhbnNpdGlvbiIsIk1velRyYW5zaXRpb24iLCJPVHJhbnNpdGlvbiIsIm1zVHJhbnNpdGlvbiIsInRyYW5zaXRpb24iLCJNb2Rlcm5penIiLCJwcmVmaXhlZCIsInN0b3BBbmltYXRpb24iLCJyZXNpemUiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsIiwiYmx1ciIsInN0eWxlIiwicmlnaHQiLCJkcm9wQW5pbWF0aW9uIiwiTmF2aWdhdGlvbiIsIl90aGlzIiwibmF2aWdhdGlvbiIsImxhYmVscyIsImxhYmVsIiwib3BlbkRyb3Bkb3duIiwidG9nZ2xlTmF2aWdhdGlvbiIsImJvZHkiLCJldmVudCIsImN1cnJlbnRUYXJnZXQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJTY3JvbGxlciIsInNjcm9sbGVyIiwic2xpZGVzIiwicGFnaW5hdG9yIiwib3BlblByZXZTbGlkZSIsIm9wZW5OZXh0U2xpZGUiLCJmaXJzdF9zbGlkZSIsImNsb25lTm9kZSIsImxhc3Rfc2xpZGUiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsImluZGV4IiwiY3JlYXRlQnV0dG9uIiwiY3VycmVudF9wYWdlIiwicGFnaW5hdG9yX2J1dHRvbnMiLCJjdXJyZW50X2J1dHRvbiIsInRhbnNpdGlvbl90aW1lciIsImNoZWNrSW5kZXgiLCJtb3ZlVG9GaXJzdCIsImRlbGF5IiwidHVybk9uIiwicmVzaXplZCIsIm1vdmUiLCJyZXBvc1NsaWRlIiwicmVmIiwiX2NhbGxlZSIsIl9jb250ZXh0IiwidHVybk9mZiIsIm1vdmVUb0N1cnJlbnQiLCJfY2FsbGVlMiIsIm1pbGxpc2Vjb25kcyIsIl9jb250ZXh0MiIsIl94IiwiX2NhbGxlZTMiLCJfY29udGV4dDMiLCJtb3ZlVG9MYXN0IiwiYnV0dG9uIiwiY3JlYXRlRWxlbWVudCIsInNwYW4iLCJzZXRBdHRyaWJ1dGUiLCJzY3JvbGxUb1NsaWRlIiwic3RhcnRBbmltYXRpb24iLCJvcGVuU2xpZGUiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsIm1pbiIsIm1heCIsIlRhYnMiLCJ3aWRnZXQiLCJET05FIiwiT0siLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInNlbmRlciIsIm9wZW4iLCJzZW5kIiwib25yZWFkeXN0YXRlY2hhbmdlIiwic3RhdHVzIiwicmVzcG9uc2UiLCJjb2RlIiwic3RhdHVzVGV4dCIsImJ1aWxkIiwibWVzc2FnZSIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJyZXBsYWNlIiwiY3VycmVudF90YWIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwidGFiIiwiY29udGFpbmVyIiwidGV4dCIsIkNvbnRlbnQiLCJzcGxpdCIsIlRpdGxlIiwiY3JlYXRlVGV4dE5vZGUiLCJvcGVuVGFiIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwicGFyYWdyYXBoIiwicCIsImNsaWNrIiwiU3Vic2NyaWJlIiwiZm9ybSIsImlucHV0Iiwic3VjY2Vzc19tZXNzYWdlIiwic3VjY2Vzc19mYWlsIiwic3VjY2Vzc19wcm9ncmVzcyIsInZhbGlkYXRlRm9ybSIsInByZXZlbnREZWZhdWx0IiwiZW1haWxfcmVnZXgiLCJSZWdFeHAiLCJ0cmltIiwidGVzdCIsInNldFN0YXRlIiwiRm9ybURhdGEiLCJzdWNjZXNzIiwiZmFpbCIsInByb2dyZXNzIiwiZm9jdXMiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsU0FBU0EsU0FBUUMsR0FBTyxNQUFPQSxJQUF5QixtQkFBWEMsU0FBMEJELEVBQUlFLGNBQWdCRCxPQUFTLGVBQWtCRCxHQW1vQnRILFFBQVNHLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQTZMaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBa0ZoSCxRQUFTQyxtQkFBa0JDLEdBQU0sTUFBTyxZQUFjLEdBQUlDLEdBQU1ELEVBQUdFLE1BQU1DLEtBQU1DLFVBQVksT0FBTyxJQUFJQyxTQUFRLFNBQVVDLEVBQVNDLEdBQTRGLFFBQVNDLEdBQUtDLEVBQUtDLEdBQU8sSUFBTSxHQUFJQyxHQUFPVixFQUFJUSxHQUFLQyxHQUFVRSxFQUFRRCxFQUFLQyxNQUFTLE1BQU9DLEdBQXdCLFdBQWZOLEdBQU9NLEdBQXNCRixFQUFLRyxLQUFRUixFQUFRTSxHQUFpQlAsUUFBUUMsUUFBUU0sR0FBT0csS0FBS0MsRUFBVUMsR0FBL1IsR0FBSUQsR0FBV1IsRUFBS1UsS0FBSyxLQUFNLFFBQWFELEVBQVlULEVBQUtVLEtBQUssS0FBTSxRQUF1T0YsUUFF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U01qaERGcVEsR0FDTCxHQUFJbE8sR0FBU29PLEtBQUtDLE1BQU1ILEVBQ3BCbE8sR0FBTzJRLFFBQ1B2VCxLQUFLcVQsU0FBUyxXQUVkclQsS0FBS3FULFNBQVMsV04yaERsQi9TLElBQUssT0FDTEcsTUFBTyxTTXBoRExDLEdBQ0ZWLEtBQUtxVCxTQUFTLFdONmhEZC9TLElBQUssV0FDTEcsTUFBTyxTTXZoREQwQyxHQUVOLEdBQUlxUSxJQUFPLEVBQ1BELEdBQVUsRUFDVkUsR0FBVyxDQUVmLFFBQVF0USxHQUNKLElBQUssT0FDRHFRLEdBQU8sRUFDUHhULEtBQUsyUyxNQUFNZSxPQUNYLE1BQU0sS0FDTCxVQUNESCxHQUFVLEVBQ1Z2VCxLQUFLMlMsTUFBTTNHLE1BQ1gsTUFBTSxLQUNMLFdBQ0R5SCxHQUFXLEVBSW5CelQsS0FBSzBTLEtBQUt4SSxVQUFVYyxPQUFPLGlCQUFrQndJLEdBQzdDeFQsS0FBSzBTLEtBQUt4SSxVQUFVYyxPQUFPLG9CQUFxQnVJLEdBQ2hEdlQsS0FBSzBTLEtBQUt4SSxVQUFVYyxPQUFPLHFCQUFzQnlJLE9BdEhuRGhCLElBMEhOLElBQUlBIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH1cblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9tYXN0ZXIvTElDRU5TRSBmaWxlLiBBblxuICogYWRkaXRpb25hbCBncmFudCBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluXG4gKiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKi9cblxuIShmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuICB2YXIgdW5kZWZpbmVkOyAvLyBNb3JlIGNvbXByZXNzaWJsZSB0aGFuIHZvaWQgMC5cbiAgdmFyICRTeW1ib2wgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgPyBTeW1ib2wgOiB7fTtcbiAgdmFyIGl0ZXJhdG9yU3ltYm9sID0gJFN5bWJvbC5pdGVyYXRvciB8fCBcIkBAaXRlcmF0b3JcIjtcbiAgdmFyIHRvU3RyaW5nVGFnU3ltYm9sID0gJFN5bWJvbC50b1N0cmluZ1RhZyB8fCBcIkBAdG9TdHJpbmdUYWdcIjtcblxuICB2YXIgaW5Nb2R1bGUgPSAodHlwZW9mIG1vZHVsZSA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG1vZHVsZSkpID09PSBcIm9iamVjdFwiO1xuICB2YXIgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWU7XG4gIGlmIChydW50aW1lKSB7XG4gICAgaWYgKGluTW9kdWxlKSB7XG4gICAgICAvLyBJZiByZWdlbmVyYXRvclJ1bnRpbWUgaXMgZGVmaW5lZCBnbG9iYWxseSBhbmQgd2UncmUgaW4gYSBtb2R1bGUsXG4gICAgICAvLyBtYWtlIHRoZSBleHBvcnRzIG9iamVjdCBpZGVudGljYWwgdG8gcmVnZW5lcmF0b3JSdW50aW1lLlxuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBydW50aW1lO1xuICAgIH1cbiAgICAvLyBEb24ndCBib3RoZXIgZXZhbHVhdGluZyB0aGUgcmVzdCBvZiB0aGlzIGZpbGUgaWYgdGhlIHJ1bnRpbWUgd2FzXG4gICAgLy8gYWxyZWFkeSBkZWZpbmVkIGdsb2JhbGx5LlxuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIERlZmluZSB0aGUgcnVudGltZSBnbG9iYWxseSAoYXMgZXhwZWN0ZWQgYnkgZ2VuZXJhdGVkIGNvZGUpIGFzIGVpdGhlclxuICAvLyBtb2R1bGUuZXhwb3J0cyAoaWYgd2UncmUgaW4gYSBtb2R1bGUpIG9yIGEgbmV3LCBlbXB0eSBvYmplY3QuXG4gIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lID0gaW5Nb2R1bGUgPyBtb2R1bGUuZXhwb3J0cyA6IHt9O1xuXG4gIGZ1bmN0aW9uIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBJZiBvdXRlckZuIHByb3ZpZGVkLCB0aGVuIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yLlxuICAgIHZhciBnZW5lcmF0b3IgPSBPYmplY3QuY3JlYXRlKChvdXRlckZuIHx8IEdlbmVyYXRvcikucHJvdG90eXBlKTtcbiAgICB2YXIgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTtcblxuICAgIC8vIFRoZSAuX2ludm9rZSBtZXRob2QgdW5pZmllcyB0aGUgaW1wbGVtZW50YXRpb25zIG9mIHRoZSAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMuXG4gICAgZ2VuZXJhdG9yLl9pbnZva2UgPSBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuXG4gICAgcmV0dXJuIGdlbmVyYXRvcjtcbiAgfVxuICBydW50aW1lLndyYXAgPSB3cmFwO1xuXG4gIC8vIFRyeS9jYXRjaCBoZWxwZXIgdG8gbWluaW1pemUgZGVvcHRpbWl6YXRpb25zLiBSZXR1cm5zIGEgY29tcGxldGlvblxuICAvLyByZWNvcmQgbGlrZSBjb250ZXh0LnRyeUVudHJpZXNbaV0uY29tcGxldGlvbi4gVGhpcyBpbnRlcmZhY2UgY291bGRcbiAgLy8gaGF2ZSBiZWVuIChhbmQgd2FzIHByZXZpb3VzbHkpIGRlc2lnbmVkIHRvIHRha2UgYSBjbG9zdXJlIHRvIGJlXG4gIC8vIGludm9rZWQgd2l0aG91dCBhcmd1bWVudHMsIGJ1dCBpbiBhbGwgdGhlIGNhc2VzIHdlIGNhcmUgYWJvdXQgd2VcbiAgLy8gYWxyZWFkeSBoYXZlIGFuIGV4aXN0aW5nIG1ldGhvZCB3ZSB3YW50IHRvIGNhbGwsIHNvIHRoZXJlJ3Mgbm8gbmVlZFxuICAvLyB0byBjcmVhdGUgYSBuZXcgZnVuY3Rpb24gb2JqZWN0LiBXZSBjYW4gZXZlbiBnZXQgYXdheSB3aXRoIGFzc3VtaW5nXG4gIC8vIHRoZSBtZXRob2QgdGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQsIHNpbmNlIHRoYXQgaGFwcGVucyB0byBiZSB0cnVlXG4gIC8vIGluIGV2ZXJ5IGNhc2UsIHNvIHdlIGRvbid0IGhhdmUgdG8gdG91Y2ggdGhlIGFyZ3VtZW50cyBvYmplY3QuIFRoZVxuICAvLyBvbmx5IGFkZGl0aW9uYWwgYWxsb2NhdGlvbiByZXF1aXJlZCBpcyB0aGUgY29tcGxldGlvbiByZWNvcmQsIHdoaWNoXG4gIC8vIGhhcyBhIHN0YWJsZSBzaGFwZSBhbmQgc28gaG9wZWZ1bGx5IHNob3VsZCBiZSBjaGVhcCB0byBhbGxvY2F0ZS5cbiAgZnVuY3Rpb24gdHJ5Q2F0Y2goZm4sIG9iaiwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwibm9ybWFsXCIsIGFyZzogZm4uY2FsbChvYmosIGFyZykgfTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwidGhyb3dcIiwgYXJnOiBlcnIgfTtcbiAgICB9XG4gIH1cblxuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRTdGFydCA9IFwic3VzcGVuZGVkU3RhcnRcIjtcbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkWWllbGQgPSBcInN1c3BlbmRlZFlpZWxkXCI7XG4gIHZhciBHZW5TdGF0ZUV4ZWN1dGluZyA9IFwiZXhlY3V0aW5nXCI7XG4gIHZhciBHZW5TdGF0ZUNvbXBsZXRlZCA9IFwiY29tcGxldGVkXCI7XG5cbiAgLy8gUmV0dXJuaW5nIHRoaXMgb2JqZWN0IGZyb20gdGhlIGlubmVyRm4gaGFzIHRoZSBzYW1lIGVmZmVjdCBhc1xuICAvLyBicmVha2luZyBvdXQgb2YgdGhlIGRpc3BhdGNoIHN3aXRjaCBzdGF0ZW1lbnQuXG4gIHZhciBDb250aW51ZVNlbnRpbmVsID0ge307XG5cbiAgLy8gRHVtbXkgY29uc3RydWN0b3IgZnVuY3Rpb25zIHRoYXQgd2UgdXNlIGFzIHRoZSAuY29uc3RydWN0b3IgYW5kXG4gIC8vIC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgcHJvcGVydGllcyBmb3IgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIEdlbmVyYXRvclxuICAvLyBvYmplY3RzLiBGb3IgZnVsbCBzcGVjIGNvbXBsaWFuY2UsIHlvdSBtYXkgd2lzaCB0byBjb25maWd1cmUgeW91clxuICAvLyBtaW5pZmllciBub3QgdG8gbWFuZ2xlIHRoZSBuYW1lcyBvZiB0aGVzZSB0d28gZnVuY3Rpb25zLlxuICBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge31cblxuICB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPSBHZW5lcmF0b3IucHJvdG90eXBlO1xuICBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHcC5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZVt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IFwiR2VuZXJhdG9yRnVuY3Rpb25cIjtcblxuICAvLyBIZWxwZXIgZm9yIGRlZmluaW5nIHRoZSAubmV4dCwgLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzIG9mIHRoZVxuICAvLyBJdGVyYXRvciBpbnRlcmZhY2UgaW4gdGVybXMgb2YgYSBzaW5nbGUgLl9pbnZva2UgbWV0aG9kLlxuICBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHMocHJvdG90eXBlKSB7XG4gICAgW1wibmV4dFwiLCBcInRocm93XCIsIFwicmV0dXJuXCJdLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgcHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbiAoYXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uIChnZW5GdW4pIHtcbiAgICB2YXIgY3RvciA9IHR5cGVvZiBnZW5GdW4gPT09IFwiZnVuY3Rpb25cIiAmJiBnZW5GdW4uY29uc3RydWN0b3I7XG4gICAgcmV0dXJuIGN0b3IgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgIC8vIEZvciB0aGUgbmF0aXZlIEdlbmVyYXRvckZ1bmN0aW9uIGNvbnN0cnVjdG9yLCB0aGUgYmVzdCB3ZSBjYW5cbiAgICAvLyBkbyBpcyB0byBjaGVjayBpdHMgLm5hbWUgcHJvcGVydHkuXG4gICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiIDogZmFsc2U7XG4gIH07XG5cbiAgcnVudGltZS5tYXJrID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgaWYgKCEodG9TdHJpbmdUYWdTeW1ib2wgaW4gZ2VuRnVuKSkge1xuICAgICAgICBnZW5GdW5bdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuICAgICAgfVxuICAgIH1cbiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7XG4gICAgcmV0dXJuIGdlbkZ1bjtcbiAgfTtcblxuICAvLyBXaXRoaW4gdGhlIGJvZHkgb2YgYW55IGFzeW5jIGZ1bmN0aW9uLCBgYXdhaXQgeGAgaXMgdHJhbnNmb3JtZWQgdG9cbiAgLy8gYHlpZWxkIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh4KWAsIHNvIHRoYXQgdGhlIHJ1bnRpbWUgY2FuIHRlc3RcbiAgLy8gYHZhbHVlIGluc3RhbmNlb2YgQXdhaXRBcmd1bWVudGAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuIFNvbWUgbWF5IGNvbnNpZGVyIHRoZSBuYW1lIG9mIHRoaXMgbWV0aG9kIHRvb1xuICAvLyBjdXRlc3ksIGJ1dCB0aGV5IGFyZSBjdXJtdWRnZW9ucy5cbiAgcnVudGltZS5hd3JhcCA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgICByZXR1cm4gbmV3IEF3YWl0QXJndW1lbnQoYXJnKTtcbiAgfTtcblxuICBmdW5jdGlvbiBBd2FpdEFyZ3VtZW50KGFyZykge1xuICAgIHRoaXMuYXJnID0gYXJnO1xuICB9XG5cbiAgZnVuY3Rpb24gQXN5bmNJdGVyYXRvcihnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZztcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZS5hcmcpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJuZXh0XCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGludm9rZShcInRocm93XCIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHVud3JhcHBlZCkge1xuICAgICAgICAgIC8vIFdoZW4gYSB5aWVsZGVkIFByb21pc2UgaXMgcmVzb2x2ZWQsIGl0cyBmaW5hbCB2YWx1ZSBiZWNvbWVzXG4gICAgICAgICAgLy8gdGhlIC52YWx1ZSBvZiB0aGUgUHJvbWlzZTx7dmFsdWUsZG9uZX0+IHJlc3VsdCBmb3IgdGhlXG4gICAgICAgICAgLy8gY3VycmVudCBpdGVyYXRpb24uIElmIHRoZSBQcm9taXNlIGlzIHJlamVjdGVkLCBob3dldmVyLCB0aGVcbiAgICAgICAgICAvLyByZXN1bHQgZm9yIHRoaXMgaXRlcmF0aW9uIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgc2FtZVxuICAgICAgICAgIC8vIHJlYXNvbi4gTm90ZSB0aGF0IHJlamVjdGlvbnMgb2YgeWllbGRlZCBQcm9taXNlcyBhcmUgbm90XG4gICAgICAgICAgLy8gdGhyb3duIGJhY2sgaW50byB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBhcyBpcyB0aGUgY2FzZVxuICAgICAgICAgIC8vIHdoZW4gYW4gYXdhaXRlZCBQcm9taXNlIGlzIHJlamVjdGVkLiBUaGlzIGRpZmZlcmVuY2UgaW5cbiAgICAgICAgICAvLyBiZWhhdmlvciBiZXR3ZWVuIHlpZWxkIGFuZCBhd2FpdCBpcyBpbXBvcnRhbnQsIGJlY2F1c2UgaXRcbiAgICAgICAgICAvLyBhbGxvd3MgdGhlIGNvbnN1bWVyIHRvIGRlY2lkZSB3aGF0IHRvIGRvIHdpdGggdGhlIHlpZWxkZWRcbiAgICAgICAgICAvLyByZWplY3Rpb24gKHN3YWxsb3cgaXQgYW5kIGNvbnRpbnVlLCBtYW51YWxseSAudGhyb3cgaXQgYmFja1xuICAgICAgICAgIC8vIGludG8gdGhlIGdlbmVyYXRvciwgYWJhbmRvbiBpdGVyYXRpb24sIHdoYXRldmVyKS4gV2l0aFxuICAgICAgICAgIC8vIGF3YWl0LCBieSBjb250cmFzdCwgdGhlcmUgaXMgbm8gb3Bwb3J0dW5pdHkgdG8gZXhhbWluZSB0aGVcbiAgICAgICAgICAvLyByZWplY3Rpb24gcmVhc29uIG91dHNpZGUgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiwgc28gdGhlXG4gICAgICAgICAgLy8gb25seSBvcHRpb24gaXMgdG8gdGhyb3cgaXQgZnJvbSB0aGUgYXdhaXQgZXhwcmVzc2lvbiwgYW5kXG4gICAgICAgICAgLy8gbGV0IHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24gaGFuZGxlIHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmVzdWx0LnZhbHVlID0gdW53cmFwcGVkO1xuICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoKHR5cGVvZiBwcm9jZXNzID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YocHJvY2VzcykpID09PSBcIm9iamVjdFwiICYmIHByb2Nlc3MuZG9tYWluKSB7XG4gICAgICBpbnZva2UgPSBwcm9jZXNzLmRvbWFpbi5iaW5kKGludm9rZSk7XG4gICAgfVxuXG4gICAgdmFyIHByZXZpb3VzUHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIGVucXVldWUobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwcmV2aW91c1Byb21pc2UgPVxuICAgICAgLy8gSWYgZW5xdWV1ZSBoYXMgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIHdlIHdhbnQgdG8gd2FpdCB1bnRpbFxuICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAvLyBzbyB0aGF0IHJlc3VsdHMgYXJlIGFsd2F5cyBkZWxpdmVyZWQgaW4gdGhlIGNvcnJlY3Qgb3JkZXIuIElmXG4gICAgICAvLyBlbnF1ZXVlIGhhcyBub3QgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIGl0IGlzIGltcG9ydGFudCB0b1xuICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAvLyBzbyB0aGF0IHRoZSBhc3luYyBnZW5lcmF0b3IgZnVuY3Rpb24gaGFzIHRoZSBvcHBvcnR1bml0eSB0byBkb1xuICAgICAgLy8gYW55IG5lY2Vzc2FyeSBzZXR1cCBpbiBhIHByZWRpY3RhYmxlIHdheS4gVGhpcyBwcmVkaWN0YWJpbGl0eVxuICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgIC8vIGV4ZWN1dG9yIGNhbGxiYWNrLCBhbmQgd2h5IGFzeW5jIGZ1bmN0aW9ucyBzeW5jaHJvbm91c2x5XG4gICAgICAvLyBleGVjdXRlIGNvZGUgYmVmb3JlIHRoZSBmaXJzdCBhd2FpdC4gU2luY2Ugd2UgaW1wbGVtZW50IHNpbXBsZVxuICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgIC8vIGltcG9ydGFudCB0byBnZXQgdGhpcyByaWdodCwgZXZlbiB0aG91Z2ggaXQgcmVxdWlyZXMgY2FyZS5cbiAgICAgIHByZXZpb3VzUHJvbWlzZSA/IHByZXZpb3VzUHJvbWlzZS50aGVuKGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLFxuICAgICAgLy8gQXZvaWQgcHJvcGFnYXRpbmcgZmFpbHVyZXMgdG8gUHJvbWlzZXMgcmV0dXJuZWQgYnkgbGF0ZXJcbiAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgfVxuXG4gICAgLy8gRGVmaW5lIHRoZSB1bmlmaWVkIGhlbHBlciBtZXRob2QgdGhhdCBpcyB1c2VkIHRvIGltcGxlbWVudCAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIChzZWUgZGVmaW5lSXRlcmF0b3JNZXRob2RzKS5cbiAgICB0aGlzLl9pbnZva2UgPSBlbnF1ZXVlO1xuICB9XG5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKTtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgcnVudGltZS5hc3luYyA9IGZ1bmN0aW9uIChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIHZhciBpdGVyID0gbmV3IEFzeW5jSXRlcmF0b3Iod3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkpO1xuXG4gICAgcmV0dXJuIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbihvdXRlckZuKSA/IGl0ZXIgLy8gSWYgb3V0ZXJGbiBpcyBhIGdlbmVyYXRvciwgcmV0dXJuIHRoZSBmdWxsIGl0ZXJhdG9yLlxuICAgIDogaXRlci5uZXh0KCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTtcbiAgICB9KTtcbiAgfTtcblxuICBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIHtcbiAgICB2YXIgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZykge1xuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlQ29tcGxldGVkKSB7XG4gICAgICAgIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJlIGZvcmdpdmluZywgcGVyIDI1LjMuMy4zLjMgb2YgdGhlIHNwZWM6XG4gICAgICAgIC8vIGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1nZW5lcmF0b3JyZXN1bWVcbiAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTtcbiAgICAgIH1cblxuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gY29udGV4dC5kZWxlZ2F0ZTtcbiAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJyZXR1cm5cIiB8fCBtZXRob2QgPT09IFwidGhyb3dcIiAmJiBkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2RdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIEEgcmV0dXJuIG9yIHRocm93ICh3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gdGhyb3dcbiAgICAgICAgICAgIC8vIG1ldGhvZCkgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLlxuICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGFcbiAgICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICAgIHZhciByZXR1cm5NZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltcInJldHVyblwiXTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5NZXRob2QpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKHJldHVybk1ldGhvZCwgZGVsZWdhdGUuaXRlcmF0b3IsIGFyZyk7XG4gICAgICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJldHVybiBtZXRob2QgdGhyZXcgYW4gZXhjZXB0aW9uLCBsZXQgdGhhdFxuICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBwcmV2YWlsIG92ZXIgdGhlIG9yaWdpbmFsIHJldHVybiBvciB0aHJvdy5cbiAgICAgICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgICAgIC8vIENvbnRpbnVlIHdpdGggdGhlIG91dGVyIHJldHVybiwgbm93IHRoYXQgdGhlIGRlbGVnYXRlXG4gICAgICAgICAgICAgIC8vIGl0ZXJhdG9yIGhhcyBiZWVuIHRlcm1pbmF0ZWQuXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2RdLCBkZWxlZ2F0ZS5pdGVyYXRvciwgYXJnKTtcblxuICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gTGlrZSByZXR1cm5pbmcgZ2VuZXJhdG9yLnRocm93KHVuY2F1Z2h0KSwgYnV0IHdpdGhvdXQgdGhlXG4gICAgICAgICAgICAvLyBvdmVyaGVhZCBvZiBhbiBleHRyYSBmdW5jdGlvbiBjYWxsLlxuICAgICAgICAgICAgbWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIERlbGVnYXRlIGdlbmVyYXRvciByYW4gYW5kIGhhbmRsZWQgaXRzIG93biBleGNlcHRpb25zIHNvXG4gICAgICAgICAgLy8gcmVnYXJkbGVzcyBvZiB3aGF0IHRoZSBtZXRob2Qgd2FzLCB3ZSBjb250aW51ZSBhcyBpZiBpdCBpc1xuICAgICAgICAgIC8vIFwibmV4dFwiIHdpdGggYW4gdW5kZWZpbmVkIGFyZy5cbiAgICAgICAgICBtZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICBhcmcgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICB2YXIgaW5mbyA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgaWYgKGluZm8uZG9uZSkge1xuICAgICAgICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7XG4gICAgICAgICAgICBjb250ZXh0Lm5leHQgPSBkZWxlZ2F0ZS5uZXh0TG9jO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7XG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkKSB7XG4gICAgICAgICAgICBjb250ZXh0LnNlbnQgPSBhcmc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2VudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAgIC8vIHRoZW4gbGV0IHRoYXQgY2F0Y2ggYmxvY2sgaGFuZGxlIHRoZSBleGNlcHRpb24gbm9ybWFsbHkuXG4gICAgICAgICAgICBtZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgYXJnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlID0gR2VuU3RhdGVFeGVjdXRpbmc7XG5cbiAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIpIHtcbiAgICAgICAgICAvLyBJZiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGZyb20gaW5uZXJGbiwgd2UgbGVhdmUgc3RhdGUgPT09XG4gICAgICAgICAgLy8gR2VuU3RhdGVFeGVjdXRpbmcgYW5kIGxvb3AgYmFjayBmb3IgYW5vdGhlciBpbnZvY2F0aW9uLlxuICAgICAgICAgIHN0YXRlID0gY29udGV4dC5kb25lID8gR2VuU3RhdGVDb21wbGV0ZWQgOiBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuXG4gICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICB2YWx1ZTogcmVjb3JkLmFyZyxcbiAgICAgICAgICAgIGRvbmU6IGNvbnRleHQuZG9uZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAocmVjb3JkLmFyZyA9PT0gQ29udGludWVTZW50aW5lbCkge1xuICAgICAgICAgICAgaWYgKGNvbnRleHQuZGVsZWdhdGUgJiYgbWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgICAgICAvLyBEZWxpYmVyYXRlbHkgZm9yZ2V0IHRoZSBsYXN0IHNlbnQgdmFsdWUgc28gdGhhdCB3ZSBkb24ndFxuICAgICAgICAgICAgICAvLyBhY2NpZGVudGFsbHkgcGFzcyBpdCBvbiB0byB0aGUgZGVsZWdhdGUuXG4gICAgICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgIC8vIERpc3BhdGNoIHRoZSBleGNlcHRpb24gYnkgbG9vcGluZyBiYWNrIGFyb3VuZCB0byB0aGVcbiAgICAgICAgICAvLyBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGFyZykgY2FsbCBhYm92ZS5cbiAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEdwW3RvU3RyaW5nVGFnU3ltYm9sXSA9IFwiR2VuZXJhdG9yXCI7XG5cbiAgR3AudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBHZW5lcmF0b3JdXCI7XG4gIH07XG5cbiAgZnVuY3Rpb24gcHVzaFRyeUVudHJ5KGxvY3MpIHtcbiAgICB2YXIgZW50cnkgPSB7IHRyeUxvYzogbG9jc1swXSB9O1xuXG4gICAgaWYgKDEgaW4gbG9jcykge1xuICAgICAgZW50cnkuY2F0Y2hMb2MgPSBsb2NzWzFdO1xuICAgIH1cblxuICAgIGlmICgyIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmZpbmFsbHlMb2MgPSBsb2NzWzJdO1xuICAgICAgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdO1xuICAgIH1cblxuICAgIHRoaXMudHJ5RW50cmllcy5wdXNoKGVudHJ5KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHtcbiAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbiB8fCB7fTtcbiAgICByZWNvcmQudHlwZSA9IFwibm9ybWFsXCI7XG4gICAgZGVsZXRlIHJlY29yZC5hcmc7XG4gICAgZW50cnkuY29tcGxldGlvbiA9IHJlY29yZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBUaGUgcm9vdCBlbnRyeSBvYmplY3QgKGVmZmVjdGl2ZWx5IGEgdHJ5IHN0YXRlbWVudCB3aXRob3V0IGEgY2F0Y2hcbiAgICAvLyBvciBhIGZpbmFsbHkgYmxvY2spIGdpdmVzIHVzIGEgcGxhY2UgdG8gc3RvcmUgdmFsdWVzIHRocm93biBmcm9tXG4gICAgLy8gbG9jYXRpb25zIHdoZXJlIHRoZXJlIGlzIG5vIGVuY2xvc2luZyB0cnkgc3RhdGVtZW50LlxuICAgIHRoaXMudHJ5RW50cmllcyA9IFt7IHRyeUxvYzogXCJyb290XCIgfV07XG4gICAgdHJ5TG9jc0xpc3QuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpO1xuICAgIHRoaXMucmVzZXQodHJ1ZSk7XG4gIH1cblxuICBydW50aW1lLmtleXMgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSxcbiAgICAgICAgICAgIG5leHQgPSBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICAgIHdoaWxlICgrK2kgPCBpdGVyYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChpdGVyYWJsZSwgaSkpIHtcbiAgICAgICAgICAgICAgbmV4dC52YWx1ZSA9IGl0ZXJhYmxlW2ldO1xuICAgICAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbmV4dC52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBuZXh0LmRvbmUgPSB0cnVlO1xuXG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGFuIGl0ZXJhdG9yIHdpdGggbm8gdmFsdWVzLlxuICAgIHJldHVybiB7IG5leHQ6IGRvbmVSZXN1bHQgfTtcbiAgfVxuICBydW50aW1lLnZhbHVlcyA9IHZhbHVlcztcblxuICBmdW5jdGlvbiBkb25lUmVzdWx0KCkge1xuICAgIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgfVxuXG4gIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KHNraXBUZW1wUmVzZXQpIHtcbiAgICAgIHRoaXMucHJldiA9IDA7XG4gICAgICB0aGlzLm5leHQgPSAwO1xuICAgICAgdGhpcy5zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICB0aGlzLmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSk7XG5cbiAgICAgIGlmICghc2tpcFRlbXBSZXNldCkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHtcbiAgICAgICAgICAvLyBOb3Qgc3VyZSBhYm91dCB0aGUgb3B0aW1hbCBvcmRlciBvZiB0aGVzZSBjb25kaXRpb25zOlxuICAgICAgICAgIGlmIChuYW1lLmNoYXJBdCgwKSA9PT0gXCJ0XCIgJiYgaGFzT3duLmNhbGwodGhpcywgbmFtZSkgJiYgIWlzTmFOKCtuYW1lLnNsaWNlKDEpKSkge1xuICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cbiAgICAgIHZhciByb290RW50cnkgPSB0aGlzLnRyeUVudHJpZXNbMF07XG4gICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uO1xuICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJvb3RSZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5ydmFsO1xuICAgIH0sXG5cbiAgICBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24gZGlzcGF0Y2hFeGNlcHRpb24oZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICAgIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgZnVuY3Rpb24gaGFuZGxlKGxvYywgY2F1Z2h0KSB7XG4gICAgICAgIHJlY29yZC50eXBlID0gXCJ0aHJvd1wiO1xuICAgICAgICByZWNvcmQuYXJnID0gZXhjZXB0aW9uO1xuICAgICAgICBjb250ZXh0Lm5leHQgPSBsb2M7XG4gICAgICAgIHJldHVybiAhIWNhdWdodDtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IFwicm9vdFwiKSB7XG4gICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBvdXRzaWRlIG9mIGFueSB0cnkgYmxvY2sgdGhhdCBjb3VsZCBoYW5kbGVcbiAgICAgICAgICAvLyBpdCwgc28gc2V0IHRoZSBjb21wbGV0aW9uIHZhbHVlIG9mIHRoZSBlbnRpcmUgZnVuY3Rpb24gdG9cbiAgICAgICAgICAvLyB0aHJvdyB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJldHVybiBoYW5kbGUoXCJlbmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldikge1xuICAgICAgICAgIHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCBcImNhdGNoTG9jXCIpO1xuICAgICAgICAgIHZhciBoYXNGaW5hbGx5ID0gaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKTtcblxuICAgICAgICAgIGlmIChoYXNDYXRjaCAmJiBoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NhdGNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYWJydXB0OiBmdW5jdGlvbiBhYnJ1cHQodHlwZSwgYXJnKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKSAmJiB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkgJiYgKHR5cGUgPT09IFwiYnJlYWtcIiB8fCB0eXBlID09PSBcImNvbnRpbnVlXCIpICYmIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmIGFyZyA8PSBmaW5hbGx5RW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAvLyBJZ25vcmUgdGhlIGZpbmFsbHkgZW50cnkgaWYgY29udHJvbCBpcyBub3QganVtcGluZyB0byBhXG4gICAgICAgIC8vIGxvY2F0aW9uIG91dHNpZGUgdGhlIHRyeS9jYXRjaCBibG9jay5cbiAgICAgICAgZmluYWxseUVudHJ5ID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlY29yZCA9IGZpbmFsbHlFbnRyeSA/IGZpbmFsbHlFbnRyeS5jb21wbGV0aW9uIDoge307XG4gICAgICByZWNvcmQudHlwZSA9IHR5cGU7XG4gICAgICByZWNvcmQuYXJnID0gYXJnO1xuXG4gICAgICBpZiAoZmluYWxseUVudHJ5KSB7XG4gICAgICAgIHRoaXMubmV4dCA9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jb21wbGV0ZShyZWNvcmQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9LFxuXG4gICAgY29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKHJlY29yZCwgYWZ0ZXJMb2MpIHtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJicmVha1wiIHx8IHJlY29yZC50eXBlID09PSBcImNvbnRpbnVlXCIpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZztcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgdGhpcy5ydmFsID0gcmVjb3JkLmFyZztcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGZpbmlzaDogZnVuY3Rpb24gZmluaXNoKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykge1xuICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpO1xuICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24gX2NhdGNoKHRyeUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IHRyeUxvYykge1xuICAgICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICB2YXIgdGhyb3duID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhyb3duO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBjb250ZXh0LmNhdGNoIG1ldGhvZCBtdXN0IG9ubHkgYmUgY2FsbGVkIHdpdGggYSBsb2NhdGlvblxuICAgICAgLy8gYXJndW1lbnQgdGhhdCBjb3JyZXNwb25kcyB0byBhIGtub3duIGNhdGNoIGJsb2NrLlxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWxsZWdhbCBjYXRjaCBhdHRlbXB0XCIpO1xuICAgIH0sXG5cbiAgICBkZWxlZ2F0ZVlpZWxkOiBmdW5jdGlvbiBkZWxlZ2F0ZVlpZWxkKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlID0ge1xuICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSxcbiAgICAgICAgbmV4dExvYzogbmV4dExvY1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuICB9O1xufSkoXG4vLyBBbW9uZyB0aGUgdmFyaW91cyB0cmlja3MgZm9yIG9idGFpbmluZyBhIHJlZmVyZW5jZSB0byB0aGUgZ2xvYmFsXG4vLyBvYmplY3QsIHRoaXMgc2VlbXMgdG8gYmUgdGhlIG1vc3QgcmVsaWFibGUgdGVjaG5pcXVlIHRoYXQgZG9lcyBub3Rcbi8vIHVzZSBpbmRpcmVjdCBldmFsICh3aGljaCB2aW9sYXRlcyBDb250ZW50IFNlY3VyaXR5IFBvbGljeSkuXG4odHlwZW9mIGdsb2JhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGdsb2JhbCkpID09PSBcIm9iamVjdFwiID8gZ2xvYmFsIDogKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZih3aW5kb3cpKSA9PT0gXCJvYmplY3RcIiA/IHdpbmRvdyA6ICh0eXBlb2Ygc2VsZiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHNlbGYpKSA9PT0gXCJvYmplY3RcIiA/IHNlbGYgOiB1bmRlZmluZWQpO1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb250cm9scyBmYXZvcml0ZXMgYmxvY2tcbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cblxuICAgIHZhciBGYXZvcml0ZXMgPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdW4gaW5pdCB3aGVuIGRvbSBpcyByZWFkeVxuICAgICAgICAgKiBAY29uc3RydWN0c1xuICAgICAgICAgKi9cblxuICAgICAgICBmdW5jdGlvbiBGYXZvcml0ZXMoKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmF2b3JpdGVzKTtcblxuICAgICAgICAgICAgdmFyIHJlYWR5ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudHMgYW5kIGluaXRpYWxpemVcbiAgICAgICAgICovXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKEZhdm9yaXRlcywgW3tcbiAgICAgICAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZhdm9yaXRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZhdm9yaXRlcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2R1Y3RzID0gdGhpcy5mYXZvcml0ZXMucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gcHJvZHVjdHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvdW50ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZhdm9yaXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5mYXZvcml0ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY3NzdHJhbnNpdGlvbnMnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX3dyYXBwZXItaW5uZXInKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24gPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX2J1dHRvbl9uZXh0Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX3ByZXYnKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX21lbnUnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm5leHQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucHJldi5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFyZ2luID0gMjA7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gcHJvZHVjdHNbMF0ub2Zmc2V0V2lkdGggKyB0aGlzLm1hcmdpbjtcbiAgICAgICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCArIHRoaXMubWFyZ2luKSAvIHRoaXMud2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lID49IHRoaXMuY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNFbmRFdmVudE5hbWVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1dlYmtpdFRyYW5zaXRpb24nOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnTW96VHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdPVHJhbnNpdGlvbic6ICdvVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXNUcmFuc2l0aW9uJzogJ01TVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc0VuZEV2ZW50TmFtZXNbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldLCB0aGlzLnN0b3BBbmltYXRpb24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZXQgYW5pbWF0aW9uIGZsYWdcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzdGFydEFuaW1hdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmUgYW5pbWF0aW9uIGZsYWdcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzdG9wQW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lciAhPSBudWxsKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmUgYW5pbWF0aW9uIGZsYWcgYnkgdGltZW91dFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImRyb3BBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcm9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCh0aGlzLnN0b3BBbmltYXRpb24uYmluZCh0aGlzKSwgMjUwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTZWxlY3QgbmV4dCBzbGlkZSBhbmQgc2Nyb2xsXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwibmV4dFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudCA9PSB0aGlzLmNvdW50IC0gdGhpcy5pbmxpbmUgKyAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2VsZWN0IHByZXZpb3VzIHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJwcmV2XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcHJldigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQtLTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMuY291bnQgLSB0aGlzLmlubGluZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGwoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZWNvdW50IG9uIHJlc2l6ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInJlc2l6ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCArIHRoaXMubWFyZ2luKSAvIHRoaXMud2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lID49IHRoaXMuY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2Nyb2xsIHRvIGN1cnJlbnQgc2xpZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzY3JvbGxcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGwoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgLXRoaXMud2lkdGggKiB0aGlzLmN1cnJlbnQgKyAncHgpJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUucmlnaHQgPSAtdGhpcy53aWR0aCAqIHRoaXMuY3VycmVudCArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIEZhdm9yaXRlcztcbiAgICB9KSgpO1xuXG4gICAgbmV3IEZhdm9yaXRlcygpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29udHJvbHMgbmF2aWdhdGlvbiBvbiBsb3cgcmVzb2x1dGlvblxuICAgICAqIEBjbGFzc1xuICAgICAqL1xuXG4gICAgdmFyIE5hdmlnYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdW4gaW5pdCB3aGVuIGRvbSBpcyByZWFkeVxuICAgICAgICAgKiBAY29uc3RydWN0c1xuICAgICAgICAgKi9cblxuICAgICAgICBmdW5jdGlvbiBOYXZpZ2F0aW9uKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdmlnYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBhbmQgaW5pdGlhbGl6ZVxuICAgICAgICAgKi9cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoTmF2aWdhdGlvbiwgW3tcbiAgICAgICAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb24nKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYXZpZ2F0aW9uID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFiZWxzID0gdGhpcy5uYXZpZ2F0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZpZ2F0aW9uX19sYWJlbCcpO1xuICAgICAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChsYWJlbHMsIGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIF90aGlzLm9wZW5Ecm9wZG93bi5iaW5kKF90aGlzKSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX190b2dnbGUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlTmF2aWdhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTaG93IGFuZCBoaWRlIG5hdmlnYXRpb24gb24gbW9iaWxlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwidG9nZ2xlTmF2aWdhdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU5hdmlnYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fb3BlbicpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlLmJsdXIoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fb3BlbicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNob3cgYW5kIGhpZGUgZHJvcGRvd25cbiAgICAgICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IOKAlMKgY2xpY2sgZXZlbnQsIHNvIHdlIG1heSBnZXQgZHJvcGRvd24gdG8gb3BlblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5Ecm9wZG93blwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5Ecm9wZG93bihldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fbGFiZWxfb3BlbicpO1xuICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fX2NvbnRhaW5lcl9vcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gTmF2aWdhdGlvbjtcbiAgICB9KSgpO1xuXG4gICAgbmV3IE5hdmlnYXRpb24oKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGNhbGxOZXh0ID0gc3RlcC5iaW5kKG51bGwsIFwibmV4dFwiKTsgdmFyIGNhbGxUaHJvdyA9IHN0ZXAuYmluZChudWxsLCBcInRocm93XCIpOyBmdW5jdGlvbiBzdGVwKGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihjYWxsTmV4dCwgY2FsbFRocm93KTsgfSB9IGNhbGxOZXh0KCk7IH0pOyB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29udHJvbHMgc2Nyb2xsZXJcbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cblxuICAgIHZhciBTY3JvbGxlciA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1biBpbml0IHdoZW4gZG9tIGlzIHJlYWR5XG4gICAgICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICAgICAqL1xuXG4gICAgICAgIGZ1bmN0aW9uIFNjcm9sbGVyKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNjcm9sbGVyKTtcblxuICAgICAgICAgICAgdmFyIHJlYWR5ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudHMgYW5kIGluaXRpYWxpemVcbiAgICAgICAgICovXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFNjcm9sbGVyLCBbe1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXInKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbGVyID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fd3JhcHBlci1pbm5lcicpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2xpZGVzID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY3JvbGxlcl9fc2xpZGUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zbGlkZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuc2xpZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMud3JhcHBlcjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2xpZGVzO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JvbGxlcjtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY3NzdHJhbnNpdGlvbnMnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2luYXRvciA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX19wYWdpbmF0b3InKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3ByZXYnKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX25leHQnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5QcmV2U2xpZGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3Blbk5leHRTbGlkZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgIHZhciBmaXJzdF9zbGlkZSA9IHRoaXMuc2xpZGVzWzBdLmNsb25lTm9kZSh0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgbGFzdF9zbGlkZSA9IHRoaXMuc2xpZGVzW3RoaXMuY291bnQgLSAxXS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBmaXJzdF9zbGlkZS5jbGFzc0xpc3QuYWRkKCdjbG9uZWQnKTtcbiAgICAgICAgICAgICAgICBsYXN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZChmaXJzdF9zbGlkZSk7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmluc2VydEJlZm9yZShsYXN0X3NsaWRlLCB0aGlzLnNsaWRlc1swXSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlQnV0dG9uKHRoaXMuY291bnQgLSBpbmRleCAtIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2luYXRvcl9idXR0b25zID0gdGhpcy5wYWdpbmF0b3IucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVyX19wYWdlJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IHRoaXMucGFnaW5hdG9yX2J1dHRvbnNbMF07XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50Jyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMudGFuc2l0aW9uX3RpbWVyID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc0VuZEV2ZW50TmFtZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnV2Via2l0VHJhbnNpdGlvbic6ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdNb3pUcmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ09UcmFuc2l0aW9uJzogJ29UcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdtc1RyYW5zaXRpb24nOiAnTVNUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKHRyYW5zRW5kRXZlbnROYW1lc1tNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0sIHRoaXMuY2hlY2tJbmRleC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVUb0ZpcnN0KCkuZGVsYXkoKS50aGVuKHRoaXMudHVybk9uLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTW92ZSB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwibW92ZVRvQ3VycmVudFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUb0N1cnJlbnQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBNb3ZlIHRvIGZpcnN0IHNsaWRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwibW92ZVRvRmlyc3RcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlVG9GaXJzdCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTW92ZSB0byBsYXN0IHNsaWRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwibW92ZVRvTGFzdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUb0xhc3QoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSB0aGlzLmNvdW50IC0gMTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUdXJuIG9uIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJ0dXJuT25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0dXJuT24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSA9IE1vZGVybml6ci5wcmVmaXhlZCgndHJhbnNmb3JtJykgKyAnIC4yNXMnO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFR1cm4gb2ZmIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJ0dXJuT2ZmXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHVybk9mZigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNob3cgc2xpZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleMKg4oCUIHNsaWRlIG51bWJlclxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm1vdmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpICsgJ3B4KSc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogUmV3aW5kIHNsaWRlcyBvbiByZXNpemVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJyZXNpemVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVUb0N1cnJlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVsYXkoMjUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHVybk9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc2l6ZWQoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSkoKVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIERlbGF5LCBzbyBicm93c2VyIG1heSByZWJ1aWxkIERPTSBhbmQgQ1NTXG4gICAgICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gbWlsbGlzZWNvbmRzIOKAlCBkZWxheSBkdXJhdGlvblxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImRlbGF5XCIsXG4gICAgICAgICAgICB2YWx1ZTogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBkZWxheShfeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pKClcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZXdpbmQgc2xpZGVzXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiY2hlY2tJbmRleFwiLFxuICAgICAgICAgICAgdmFsdWU6IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZiA9IF9hc3luY1RvR2VuZXJhdG9yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5jdXJyZW50X3BhZ2UgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9MYXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5jdXJyZW50X3BhZ2UgPT0gdGhpcy5jb3VudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHVybk9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBjaGVja0luZGV4KCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pKClcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSZW1vdmUgYW5pbWF0aW9uIGZsYWdcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzdG9wQW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNldCBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0YXJ0QW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnRBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiZHJvcEFuaW1hdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyb3BBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRpbWVyICE9ICd1bmRlZmluZWQnKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQodGhpcy5zdG9wQW5pbWF0aW9uLmJpbmQodGhpcyksIDM1MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ3JlYXRlIHBhZ2luYXRvciBidXR0b25cbiAgICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCDigJTCoHNsaWRlIG51bWJlclxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImNyZWF0ZUJ1dHRvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUJ1dHRvbihpbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKSxcbiAgICAgICAgICAgICAgICAgICAgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NQQU4nKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnc2Nyb2xsZXJfX3BhZ2UnKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zY3JvbGxUb1NsaWRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yLmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2Nyb2xsIHRvIGN1cnJlbnQgc2xpZGVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJvcGVuU2xpZGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuU2xpZGUoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kcm9wQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhbnNpdGlvbl90aW1lciAhPSBudWxsKSBjbGVhclRpbWVvdXQodGhpcy50YW5zaXRpb25fdGltZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhbnNpdGlvbl90aW1lciA9IHNldFRpbWVvdXQodGhpcy5jaGVja0luZGV4LmJpbmQodGhpcyksIDI1MCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNjcm9sbCB0byBwcmV2aW91cyBzbGlkZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5QcmV2U2xpZGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuUHJldlNsaWRlKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlLS07XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY3JvbGwgdG8gbmV4dCBzbGlkZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5OZXh0U2xpZGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuTmV4dFNsaWRlKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlKys7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY3JvbGwgdG8gc2VsZWN0ZWQgc2xpZGVcbiAgICAgICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IOKAlCBjbGljayBldmVudCwgc28gd2UgbWF5IGdldCBwYWdpbmF0b3IgYnV0dG9uXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic2Nyb2xsVG9TbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvU2xpZGUoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHBhcnNlSW50KGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScpLCAxMCk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE1vdmUgc2Nyb2xsZXIgdG8gc2VsZWN0ZWQgc2xpZGUgYW5kIHNldCBidXR0b25zIHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwicmVwb3NTbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9zU2xpZGUoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zW01hdGgubWluKE1hdGgubWF4KHRoaXMuY3VycmVudF9wYWdlLCAwKSwgdGhpcy5jb3VudCAtIDEpXTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmUodGhpcy5jdXJyZW50X3BhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNjcm9sbGVyO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgU2Nyb2xsZXIoKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDbGFzcyBoYW5kbGUgdGFicyBsb2FkaW5nXG4gICAgICovXG5cbiAgICB2YXIgVGFicyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gVGFicygpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUYWJzKTtcblxuICAgICAgICAgICAgdmFyIHJlYWR5ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZGluZyBldmVudHMgYW5kIHByb3BlcnRpZXNcbiAgICAgICAgICovXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFRhYnMsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFicycpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLndpZGdldCA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgdmFyIERPTkUgPSA0LFxuICAgICAgICAgICAgICAgICAgICBPSyA9IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlciA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnanMvdGFicy5qc29uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5jb2RlICsgJzogJyArIHhoci5zdGF0dXNUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5idWlsZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gQnVpbGQgd2lkZ2V0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiYnVpbGRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZChtZXNzYWdlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UobWVzc2FnZS5yZXBsYWNlKC9cXG4vZywgXCJcXFxcblwiKS5yZXBsYWNlKC9cXHIvZywgXCJcXFxcclwiKS5yZXBsYWNlKC9cXHQvZywgXCJcXFxcdFwiKS5yZXBsYWNlKC9cXGYvZywgXCJcXFxcZlwiKSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy53aWRnZXQpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53aWRnZXQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ01FTlUnKTtcbiAgICAgICAgICAgICAgICBtZW51LnNldEF0dHJpYnV0ZSgndHlwZScsICd0b29sYmFyJyk7XG4gICAgICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QuYWRkKCd0YWJzX19tZW51Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQobWVudSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gZGF0YVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWIgPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NFQ1RJT04nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGFiLkNvbnRlbnQuc3BsaXQoJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnLCB0YWIuVGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2J1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRhYi5UaXRsZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuVGFiLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChidXR0b24pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRhYicsIHRhYi5UaXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgndGFic19fdGFiJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0ZXh0W1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhZ3JhcGggPSBfc3RlcDIudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdQJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocGFyYWdyYXBoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gZXJyO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKS5jbGljaygpO1xuICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LmNsYXNzTGlzdC5hZGQoJ3RhYnNfYnVpbGRlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwib3BlblRhYlwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5UYWIoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX190YWJfY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X2J1dHRvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fYnV0dG9uX2N1cnJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IGJ1dHRvbjtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX2J1dHRvbl9jdXJyZW50JywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gdGhpcy53aWRnZXQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiPScgKyB0YXJnZXQgKyAnXScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX190YWJfY3VycmVudCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBUYWJzO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgVGFicygpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQGNsYXNzIENsYXNzIGhhbmRsZSBzdWJzY3JpcHRpb24gcHJvY2Vzc1xuICAgICAqL1xuXG4gICAgdmFyIFN1YnNjcmliZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gU3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1YnNjcmliZSk7XG5cbiAgICAgICAgICAgIHZhciByZWFkeSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhTdWJzY3JpYmUsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvcm0gPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fZW1haWwnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3NfbWVzc2FnZSA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9zdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzX2ZhaWwgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfZmFpbCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19wcm9ncmVzcyA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9pbi1wcm9ncmVzcycpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLnNldEF0dHJpYnV0ZSgnbm92YWxpZGF0ZScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnZhbGlkYXRlRm9ybS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gVmFsaWRhdGluZyB1c2VyIGlucHV0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwidmFsaWRhdGVGb3JtXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZW1haWxfcmVnZXggPSBuZXcgUmVnRXhwKFwiXihbYS16QS1aMC05X1xcLlxcLV0pK1xcQCgoW2EtekEtWjAtOVxcLV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyRcIik7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDAgJiYgZW1haWxfcmVnZXgudGVzdCh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKSkgPT09IGZhbHNlIHx8IHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMCB8fCB0aGlzLmlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIERPTkUgPSA0LFxuICAgICAgICAgICAgICAgICAgICBPSyA9IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlciA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnanMvc3Vic2NyaWJlLmpzb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZW5kKG5ldyBGb3JtRGF0YShfdGhpcy5mb3JtKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gRE9ORSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb3JtLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSBPSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuY29kZSArICc6ICcgKyB4aHIuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5zdWNjZXNzLmJpbmQodGhpcykpLmNhdGNoKHRoaXMuZmFpbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gcmVxdWVzdCBoYXZlIHN1Y2NlZWRlZFxuICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2Ugc2VydmVyIGFuc3dlclxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBmYWlsZWRcbiAgICAgICAgICAgICAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIGVycm9yIG9iamVjdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImZhaWxcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmYWlsKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvbiBTZXQgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RhdGUgbmV3IHN0YXRlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic2V0U3RhdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdGF0ZShzdGF0ZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGZhaWwgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZmFpbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInByb2dyZXNzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX2ZhaWwnLCBmYWlsKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3Byb2dyZXNzJywgcHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFN1YnNjcmliZTtcbiAgICB9KSgpO1xuXG4gICAgbmV3IFN1YnNjcmliZSgpO1xufSkoKTsiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBodHRwczovL3Jhdy5naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL21hc3Rlci9MSUNFTlNFIGZpbGUuIEFuXG4gKiBhZGRpdGlvbmFsIGdyYW50IG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW5cbiAqIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4hKGZ1bmN0aW9uKGdsb2JhbCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbiAgdmFyIHVuZGVmaW5lZDsgLy8gTW9yZSBjb21wcmVzc2libGUgdGhhbiB2b2lkIDAuXG4gIHZhciAkU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiID8gU3ltYm9sIDoge307XG4gIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCI7XG4gIHZhciB0b1N0cmluZ1RhZ1N5bWJvbCA9ICRTeW1ib2wudG9TdHJpbmdUYWcgfHwgXCJAQHRvU3RyaW5nVGFnXCI7XG5cbiAgdmFyIGluTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIjtcbiAgdmFyIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lO1xuICBpZiAocnVudGltZSkge1xuICAgIGlmIChpbk1vZHVsZSkge1xuICAgICAgLy8gSWYgcmVnZW5lcmF0b3JSdW50aW1lIGlzIGRlZmluZWQgZ2xvYmFsbHkgYW5kIHdlJ3JlIGluIGEgbW9kdWxlLFxuICAgICAgLy8gbWFrZSB0aGUgZXhwb3J0cyBvYmplY3QgaWRlbnRpY2FsIHRvIHJlZ2VuZXJhdG9yUnVudGltZS5cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gcnVudGltZTtcbiAgICB9XG4gICAgLy8gRG9uJ3QgYm90aGVyIGV2YWx1YXRpbmcgdGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGlmIHRoZSBydW50aW1lIHdhc1xuICAgIC8vIGFscmVhZHkgZGVmaW5lZCBnbG9iYWxseS5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBEZWZpbmUgdGhlIHJ1bnRpbWUgZ2xvYmFsbHkgKGFzIGV4cGVjdGVkIGJ5IGdlbmVyYXRlZCBjb2RlKSBhcyBlaXRoZXJcbiAgLy8gbW9kdWxlLmV4cG9ydHMgKGlmIHdlJ3JlIGluIGEgbW9kdWxlKSBvciBhIG5ldywgZW1wdHkgb2JqZWN0LlxuICBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZSA9IGluTW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgOiB7fTtcblxuICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gSWYgb3V0ZXJGbiBwcm92aWRlZCwgdGhlbiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvci5cbiAgICB2YXIgZ2VuZXJhdG9yID0gT2JqZWN0LmNyZWF0ZSgob3V0ZXJGbiB8fCBHZW5lcmF0b3IpLnByb3RvdHlwZSk7XG4gICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7XG5cbiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cbiAgcnVudGltZS53cmFwID0gd3JhcDtcblxuICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm5vcm1hbFwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcInRocm93XCIsIGFyZzogZXJyIH07XG4gICAgfVxuICB9XG5cbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSBcInN1c3BlbmRlZFN0YXJ0XCI7XG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gXCJzdXNwZW5kZWRZaWVsZFwiO1xuICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSBcImV4ZWN1dGluZ1wiO1xuICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSBcImNvbXBsZXRlZFwiO1xuXG4gIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXNcbiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50LlxuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZFxuICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXJcbiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG5cbiAgdmFyIEdwID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGVbdG9TdHJpbmdUYWdTeW1ib2xdID0gR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG5cbiAgLy8gSGVscGVyIGZvciBkZWZpbmluZyB0aGUgLm5leHQsIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcyBvZiB0aGVcbiAgLy8gSXRlcmF0b3IgaW50ZXJmYWNlIGluIHRlcm1zIG9mIGEgc2luZ2xlIC5faW52b2tlIG1ldGhvZC5cbiAgZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3JNZXRob2RzKHByb3RvdHlwZSkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgcHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgdmFyIGN0b3IgPSB0eXBlb2YgZ2VuRnVuID09PSBcImZ1bmN0aW9uXCIgJiYgZ2VuRnVuLmNvbnN0cnVjdG9yO1xuICAgIHJldHVybiBjdG9yXG4gICAgICA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8XG4gICAgICAgIC8vIEZvciB0aGUgbmF0aXZlIEdlbmVyYXRvckZ1bmN0aW9uIGNvbnN0cnVjdG9yLCB0aGUgYmVzdCB3ZSBjYW5cbiAgICAgICAgLy8gZG8gaXMgdG8gY2hlY2sgaXRzIC5uYW1lIHByb3BlcnR5LlxuICAgICAgICAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSBcIkdlbmVyYXRvckZ1bmN0aW9uXCJcbiAgICAgIDogZmFsc2U7XG4gIH07XG5cbiAgcnVudGltZS5tYXJrID0gZnVuY3Rpb24oZ2VuRnVuKSB7XG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgdmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50YCB0byBkZXRlcm1pbmUgaWYgdGhlIHlpZWxkZWQgdmFsdWUgaXNcbiAgLy8gbWVhbnQgdG8gYmUgYXdhaXRlZC4gU29tZSBtYXkgY29uc2lkZXIgdGhlIG5hbWUgb2YgdGhpcyBtZXRob2QgdG9vXG4gIC8vIGN1dGVzeSwgYnV0IHRoZXkgYXJlIGN1cm11ZGdlb25zLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBBd2FpdEFyZ3VtZW50KGFyZyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gQXdhaXRBcmd1bWVudChhcmcpIHtcbiAgICB0aGlzLmFyZyA9IGFyZztcbiAgfVxuXG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IoZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChnZW5lcmF0b3JbbWV0aG9kXSwgZ2VuZXJhdG9yLCBhcmcpO1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgcmVqZWN0KHJlY29yZC5hcmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlY29yZC5hcmc7XG4gICAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXdhaXRBcmd1bWVudCkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUuYXJnKS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJuZXh0XCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgZXJyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbih1bndyYXBwZWQpIHtcbiAgICAgICAgICAvLyBXaGVuIGEgeWllbGRlZCBQcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgZmluYWwgdmFsdWUgYmVjb21lc1xuICAgICAgICAgIC8vIHRoZSAudmFsdWUgb2YgdGhlIFByb21pc2U8e3ZhbHVlLGRvbmV9PiByZXN1bHQgZm9yIHRoZVxuICAgICAgICAgIC8vIGN1cnJlbnQgaXRlcmF0aW9uLiBJZiB0aGUgUHJvbWlzZSBpcyByZWplY3RlZCwgaG93ZXZlciwgdGhlXG4gICAgICAgICAgLy8gcmVzdWx0IGZvciB0aGlzIGl0ZXJhdGlvbiB3aWxsIGJlIHJlamVjdGVkIHdpdGggdGhlIHNhbWVcbiAgICAgICAgICAvLyByZWFzb24uIE5vdGUgdGhhdCByZWplY3Rpb25zIG9mIHlpZWxkZWQgUHJvbWlzZXMgYXJlIG5vdFxuICAgICAgICAgIC8vIHRocm93biBiYWNrIGludG8gdGhlIGdlbmVyYXRvciBmdW5jdGlvbiwgYXMgaXMgdGhlIGNhc2VcbiAgICAgICAgICAvLyB3aGVuIGFuIGF3YWl0ZWQgUHJvbWlzZSBpcyByZWplY3RlZC4gVGhpcyBkaWZmZXJlbmNlIGluXG4gICAgICAgICAgLy8gYmVoYXZpb3IgYmV0d2VlbiB5aWVsZCBhbmQgYXdhaXQgaXMgaW1wb3J0YW50LCBiZWNhdXNlIGl0XG4gICAgICAgICAgLy8gYWxsb3dzIHRoZSBjb25zdW1lciB0byBkZWNpZGUgd2hhdCB0byBkbyB3aXRoIHRoZSB5aWVsZGVkXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIChzd2FsbG93IGl0IGFuZCBjb250aW51ZSwgbWFudWFsbHkgLnRocm93IGl0IGJhY2tcbiAgICAgICAgICAvLyBpbnRvIHRoZSBnZW5lcmF0b3IsIGFiYW5kb24gaXRlcmF0aW9uLCB3aGF0ZXZlcikuIFdpdGhcbiAgICAgICAgICAvLyBhd2FpdCwgYnkgY29udHJhc3QsIHRoZXJlIGlzIG5vIG9wcG9ydHVuaXR5IHRvIGV4YW1pbmUgdGhlXG4gICAgICAgICAgLy8gcmVqZWN0aW9uIHJlYXNvbiBvdXRzaWRlIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIHNvIHRoZVxuICAgICAgICAgIC8vIG9ubHkgb3B0aW9uIGlzIHRvIHRocm93IGl0IGZyb20gdGhlIGF3YWl0IGV4cHJlc3Npb24sIGFuZFxuICAgICAgICAgIC8vIGxldCB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhbmRsZSB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHVud3JhcHBlZDtcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHByb2Nlc3MuZG9tYWluKSB7XG4gICAgICBpbnZva2UgPSBwcm9jZXNzLmRvbWFpbi5iaW5kKGludm9rZSk7XG4gICAgfVxuXG4gICAgdmFyIHByZXZpb3VzUHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIGVucXVldWUobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuXG4gIC8vIE5vdGUgdGhhdCBzaW1wbGUgYXN5bmMgZnVuY3Rpb25zIGFyZSBpbXBsZW1lbnRlZCBvbiB0b3Agb2ZcbiAgLy8gQXN5bmNJdGVyYXRvciBvYmplY3RzOyB0aGV5IGp1c3QgcmV0dXJuIGEgUHJvbWlzZSBmb3IgdGhlIHZhbHVlIG9mXG4gIC8vIHRoZSBmaW5hbCByZXN1bHQgcHJvZHVjZWQgYnkgdGhlIGl0ZXJhdG9yLlxuICBydW50aW1lLmFzeW5jID0gZnVuY3Rpb24oaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKFxuICAgICAgd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdClcbiAgICApO1xuXG4gICAgcmV0dXJuIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbihvdXRlckZuKVxuICAgICAgPyBpdGVyIC8vIElmIG91dGVyRm4gaXMgYSBnZW5lcmF0b3IsIHJldHVybiB0aGUgZnVsbCBpdGVyYXRvci5cbiAgICAgIDogaXRlci5uZXh0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTtcbiAgICAgICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KSB7XG4gICAgdmFyIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydDtcblxuICAgIHJldHVybiBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcpIHtcbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVFeGVjdXRpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZ1wiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUNvbXBsZXRlZCkge1xuICAgICAgICBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCZSBmb3JnaXZpbmcsIHBlciAyNS4zLjMuMy4zIG9mIHRoZSBzcGVjOlxuICAgICAgICAvLyBodHRwczovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtZ2VuZXJhdG9ycmVzdW1lXG4gICAgICAgIHJldHVybiBkb25lUmVzdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IGNvbnRleHQuZGVsZWdhdGU7XG4gICAgICAgIGlmIChkZWxlZ2F0ZSkge1xuICAgICAgICAgIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIgfHxcbiAgICAgICAgICAgICAgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiICYmIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0gPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgIC8vIEEgcmV0dXJuIG9yIHRocm93ICh3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gdGhyb3dcbiAgICAgICAgICAgIC8vIG1ldGhvZCkgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLlxuICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGFcbiAgICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICAgIHZhciByZXR1cm5NZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltcInJldHVyblwiXTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5NZXRob2QpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKHJldHVybk1ldGhvZCwgZGVsZWdhdGUuaXRlcmF0b3IsIGFyZyk7XG4gICAgICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJldHVybiBtZXRob2QgdGhyZXcgYW4gZXhjZXB0aW9uLCBsZXQgdGhhdFxuICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBwcmV2YWlsIG92ZXIgdGhlIG9yaWdpbmFsIHJldHVybiBvciB0aHJvdy5cbiAgICAgICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgICAgIC8vIENvbnRpbnVlIHdpdGggdGhlIG91dGVyIHJldHVybiwgbm93IHRoYXQgdGhlIGRlbGVnYXRlXG4gICAgICAgICAgICAgIC8vIGl0ZXJhdG9yIGhhcyBiZWVuIHRlcm1pbmF0ZWQuXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChcbiAgICAgICAgICAgIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0sXG4gICAgICAgICAgICBkZWxlZ2F0ZS5pdGVyYXRvcixcbiAgICAgICAgICAgIGFyZ1xuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIExpa2UgcmV0dXJuaW5nIGdlbmVyYXRvci50aHJvdyh1bmNhdWdodCksIGJ1dCB3aXRob3V0IHRoZVxuICAgICAgICAgICAgLy8gb3ZlcmhlYWQgb2YgYW4gZXh0cmEgZnVuY3Rpb24gY2FsbC5cbiAgICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICAgIGFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBEZWxlZ2F0ZSBnZW5lcmF0b3IgcmFuIGFuZCBoYW5kbGVkIGl0cyBvd24gZXhjZXB0aW9ucyBzb1xuICAgICAgICAgIC8vIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB0aGUgbWV0aG9kIHdhcywgd2UgY29udGludWUgYXMgaWYgaXQgaXNcbiAgICAgICAgICAvLyBcIm5leHRcIiB3aXRoIGFuIHVuZGVmaW5lZCBhcmcuXG4gICAgICAgICAgbWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgdmFyIGluZm8gPSByZWNvcmQuYXJnO1xuICAgICAgICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgICAgICAgIGNvbnRleHRbZGVsZWdhdGUucmVzdWx0TmFtZV0gPSBpbmZvLnZhbHVlO1xuICAgICAgICAgICAgY29udGV4dC5uZXh0ID0gZGVsZWdhdGUubmV4dExvYztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCkge1xuICAgICAgICAgICAgY29udGV4dC5zZW50ID0gYXJnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0LnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAgIC8vIHRoZW4gbGV0IHRoYXQgY2F0Y2ggYmxvY2sgaGFuZGxlIHRoZSBleGNlcHRpb24gbm9ybWFsbHkuXG4gICAgICAgICAgICBtZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmVcbiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWRcbiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcblxuICAgICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmVcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHtcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmRlbGVnYXRlICYmIG1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICAgICAgLy8gRGVsaWJlcmF0ZWx5IGZvcmdldCB0aGUgbGFzdCBzZW50IHZhbHVlIHNvIHRoYXQgd2UgZG9uJ3RcbiAgICAgICAgICAgICAgLy8gYWNjaWRlbnRhbGx5IHBhc3MgaXQgb24gdG8gdGhlIGRlbGVnYXRlLlxuICAgICAgICAgICAgICBhcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgIC8vIERpc3BhdGNoIHRoZSBleGNlcHRpb24gYnkgbG9vcGluZyBiYWNrIGFyb3VuZCB0byB0aGVcbiAgICAgICAgICAvLyBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGFyZykgY2FsbCBhYm92ZS5cbiAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0geyB0cnlMb2M6IGxvY3NbMF0gfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6IFwicm9vdFwiIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgcnVudGltZS5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIHJ1bnRpbWUudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24oc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICB0aGlzLnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KTtcblxuICAgICAgaWYgKCFza2lwVGVtcFJlc2V0KSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcykge1xuICAgICAgICAgIC8vIE5vdCBzdXJlIGFib3V0IHRoZSBvcHRpbWFsIG9yZGVyIG9mIHRoZXNlIGNvbmRpdGlvbnM6XG4gICAgICAgICAgaWYgKG5hbWUuY2hhckF0KDApID09PSBcInRcIiAmJlxuICAgICAgICAgICAgICBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJlxuICAgICAgICAgICAgICAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cbiAgICAgIHZhciByb290RW50cnkgPSB0aGlzLnRyeUVudHJpZXNbMF07XG4gICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uO1xuICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJvb3RSZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5ydmFsO1xuICAgIH0sXG5cbiAgICBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24oZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICAgIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgZnVuY3Rpb24gaGFuZGxlKGxvYywgY2F1Z2h0KSB7XG4gICAgICAgIHJlY29yZC50eXBlID0gXCJ0aHJvd1wiO1xuICAgICAgICByZWNvcmQuYXJnID0gZXhjZXB0aW9uO1xuICAgICAgICBjb250ZXh0Lm5leHQgPSBsb2M7XG4gICAgICAgIHJldHVybiAhIWNhdWdodDtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IFwicm9vdFwiKSB7XG4gICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBvdXRzaWRlIG9mIGFueSB0cnkgYmxvY2sgdGhhdCBjb3VsZCBoYW5kbGVcbiAgICAgICAgICAvLyBpdCwgc28gc2V0IHRoZSBjb21wbGV0aW9uIHZhbHVlIG9mIHRoZSBlbnRpcmUgZnVuY3Rpb24gdG9cbiAgICAgICAgICAvLyB0aHJvdyB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJldHVybiBoYW5kbGUoXCJlbmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldikge1xuICAgICAgICAgIHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCBcImNhdGNoTG9jXCIpO1xuICAgICAgICAgIHZhciBoYXNGaW5hbGx5ID0gaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKTtcblxuICAgICAgICAgIGlmIChoYXNDYXRjaCAmJiBoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYWJydXB0OiBmdW5jdGlvbih0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKSAmJlxuICAgICAgICAgICAgdGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgIHZhciBmaW5hbGx5RW50cnkgPSBlbnRyeTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZmluYWxseUVudHJ5ICYmXG4gICAgICAgICAgKHR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgICB0eXBlID09PSBcImNvbnRpbnVlXCIpICYmXG4gICAgICAgICAgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiZcbiAgICAgICAgICBhcmcgPD0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgLy8gSWdub3JlIHRoZSBmaW5hbGx5IGVudHJ5IGlmIGNvbnRyb2wgaXMgbm90IGp1bXBpbmcgdG8gYVxuICAgICAgICAvLyBsb2NhdGlvbiBvdXRzaWRlIHRoZSB0cnkvY2F0Y2ggYmxvY2suXG4gICAgICAgIGZpbmFsbHlFbnRyeSA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9O1xuICAgICAgcmVjb3JkLnR5cGUgPSB0eXBlO1xuICAgICAgcmVjb3JkLmFyZyA9IGFyZztcblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSkge1xuICAgICAgICB0aGlzLm5leHQgPSBmaW5hbGx5RW50cnkuZmluYWxseUxvYztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfSxcblxuICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZWNvcmQsIGFmdGVyTG9jKSB7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgIHJlY29yZC50eXBlID09PSBcImNvbnRpbnVlXCIpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZztcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgdGhpcy5ydmFsID0gcmVjb3JkLmFyZztcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGZpbmlzaDogZnVuY3Rpb24oZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbih0cnlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSB0cnlMb2MpIHtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRocm93bjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUaGUgY29udGV4dC5jYXRjaCBtZXRob2QgbXVzdCBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgbG9jYXRpb25cbiAgICAgIC8vIGFyZ3VtZW50IHRoYXQgY29ycmVzcG9uZHMgdG8gYSBrbm93biBjYXRjaCBibG9jay5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuXG4gICAgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24oaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG59KShcbiAgLy8gQW1vbmcgdGhlIHZhcmlvdXMgdHJpY2tzIGZvciBvYnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbFxuICAvLyBvYmplY3QsIHRoaXMgc2VlbXMgdG8gYmUgdGhlIG1vc3QgcmVsaWFibGUgdGVjaG5pcXVlIHRoYXQgZG9lcyBub3RcbiAgLy8gdXNlIGluZGlyZWN0IGV2YWwgKHdoaWNoIHZpb2xhdGVzIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5KS5cbiAgdHlwZW9mIGdsb2JhbCA9PT0gXCJvYmplY3RcIiA/IGdsb2JhbCA6XG4gIHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgPyB3aW5kb3cgOlxuICB0eXBlb2Ygc2VsZiA9PT0gXCJvYmplY3RcIiA/IHNlbGYgOiB0aGlzXG4pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIGZhdm9yaXRlcyBibG9ja1xuICAgICAqIEBjbGFzc1xuICAgICAqL1xuICAgIGNsYXNzIEZhdm9yaXRlcyB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJ1biBpbml0IHdoZW4gZG9tIGlzIHJlYWR5XG4gICAgICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIGxldCByZWFkeSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudHMgYW5kIGluaXRpYWxpemVcbiAgICAgICAgICovXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmZhdm9yaXRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZScpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmF2b3JpdGVzID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIGxldCBwcm9kdWN0cyA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9kdWN0Jyk7XG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gcHJvZHVjdHMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT0gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZhdm9yaXRlcyk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmF2b3JpdGVzO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9ucyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zaXRpb25zJyk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fd3JhcHBlci1pbm5lcicpO1xuXG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uID0gdGhpcy5mYXZvcml0ZXMucXVlcnlTZWxlY3RvcignLmZhdm9yaXRlX19idXR0b25fbmV4dCcpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX3ByZXYnKTtcbiAgICAgICAgICAgIHRoaXMubWVudSA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fbWVudScpO1xuXG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5uZXh0LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucHJldi5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5tYXJnaW4gPSAyMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gcHJvZHVjdHNbMF0ub2Zmc2V0V2lkdGggKyB0aGlzLm1hcmdpbjtcbiAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoK3RoaXMubWFyZ2luKS90aGlzLndpZHRoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lPj10aGlzLmNvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnZmF2b3JpdGVfX21lbnVfaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50aW1lciA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9ucykge1xuICAgICAgICAgICAgICAgIGxldCB0cmFuc0VuZEV2ZW50TmFtZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnV2Via2l0VHJhbnNpdGlvbic6ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdNb3pUcmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ09UcmFuc2l0aW9uJzogJ29UcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdtc1RyYW5zaXRpb24nOiAnTVNUcmFuc2l0aW9uRW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNFbmRFdmVudE5hbWVzW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSwgdGhpcy5zdG9wQW5pbWF0aW9uLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgKi9cbiAgICAgICAgc3RhcnRBbmltYXRpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZ1xuICAgICAgICAgKi9cbiAgICAgICAgc3RvcEFuaW1hdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50aW1lciAhPSBudWxsKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAqL1xuICAgICAgICBkcm9wQW5pbWF0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAyNTApO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlbGVjdCBuZXh0IHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICovXG4gICAgICAgIG5leHQgKCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50Kys7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IHRoaXMuY291bnQtdGhpcy5pbmxpbmUrMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2VsZWN0IHByZXZpb3VzIHNsaWRlIGFuZCBzY3JvbGxcbiAgICAgICAgICovXG4gICAgICAgIHByZXYgKCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50LS07XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5jb3VudC10aGlzLmlubGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWNvdW50IG9uIHJlc2l6ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVzaXplICgpIHtcbiAgICAgICAgICAgIHRoaXMuaW5saW5lID0gTWF0aC5mbG9vcigodGhpcy53cmFwcGVyLm9mZnNldFdpZHRoK3RoaXMubWFyZ2luKS90aGlzLndpZHRoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lPj10aGlzLmNvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBzY3JvbGwgKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpXSA9ICd0cmFuc2xhdGVYKCcgKyAoLXRoaXMud2lkdGggKiAodGhpcy5jdXJyZW50KSkgKyAncHgpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gKC10aGlzLndpZHRoICogKHRoaXMuY3VycmVudCkpICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmV3IEZhdm9yaXRlcztcblxufSkoKVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIG5hdmlnYXRpb24gb24gbG93IHJlc29sdXRpb25cbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cbiAgICBjbGFzcyBOYXZpZ2F0aW9uIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUnVuIGluaXQgd2hlbiBkb20gaXMgcmVhZHlcbiAgICAgICAgICogQGNvbnN0cnVjdHNcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBhbmQgaW5pdGlhbGl6ZVxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdCAoKSB7XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbicpO1xuICAgICAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvbiA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgbGFiZWxzID0gdGhpcy5uYXZpZ2F0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZpZ2F0aW9uX19sYWJlbCcpO1xuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGxhYmVscywgbGFiZWwgPT4ge1xuICAgICAgICAgICAgICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuRHJvcGRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy50b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbl9fdG9nZ2xlJyk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlTmF2aWdhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTaG93IGFuZCBoaWRlIG5hdmlnYXRpb24gb24gbW9iaWxlXG4gICAgICAgICAqL1xuICAgICAgICB0b2dnbGVOYXZpZ2F0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX29wZW4nKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlLmJsdXIoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9vcGVuJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2hvdyBhbmQgaGlkZSBkcm9wZG93blxuICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCDigJTCoGNsaWNrIGV2ZW50LCBzbyB3ZSBtYXkgZ2V0IGRyb3Bkb3duIHRvIG9wZW5cbiAgICAgICAgICovXG4gICAgICAgIG9wZW5Ecm9wZG93biAoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fbGFiZWxfb3BlbicpO1xuICAgICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fY29udGFpbmVyX29wZW4nKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgbmV3IE5hdmlnYXRpb247XG59KSgpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIHNjcm9sbGVyXG4gICAgICogQGNsYXNzXG4gICAgICovXG4gICAgY2xhc3MgU2Nyb2xsZXIge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSdW4gaW5pdCB3aGVuIGRvbSBpcyByZWFkeVxuICAgICAgICAgKiBAY29uc3RydWN0c1xuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgZXZlbnRzIGFuZCBpbml0aWFsaXplXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcicpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxlciA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fd3JhcHBlci1pbm5lcicpO1xuICAgICAgICAgICAgdGhpcy5zbGlkZXMgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVyX19zbGlkZScpO1xuICAgICAgICAgICAgdGhpcy5jb3VudCA9IHRoaXMuc2xpZGVzLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5zbGlkZXMpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLndyYXBwZXI7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2xpZGVzO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcm9sbGVyO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9ucyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zaXRpb25zJyk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3BhZ2luYXRvcicpO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX19wcmV2Jyk7XG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX25leHQnKTtcblxuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblByZXZTbGlkZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5OZXh0U2xpZGUuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGxldCBmaXJzdF9zbGlkZSA9IHRoaXMuc2xpZGVzWzBdLmNsb25lTm9kZSh0cnVlKVxuICAgICAgICAgICAgICAgICwgbGFzdF9zbGlkZSA9IHRoaXMuc2xpZGVzW3RoaXMuY291bnQgLSAxXS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAgICAgICAgIGZpcnN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgbGFzdF9zbGlkZS5jbGFzc0xpc3QuYWRkKCdjbG9uZWQnKTtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZChmaXJzdF9zbGlkZSk7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIuaW5zZXJ0QmVmb3JlKGxhc3Rfc2xpZGUsIHRoaXMuc2xpZGVzWzBdKTtcblxuICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jb3VudDtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24odGhpcy5jb3VudCAtIGluZGV4IC0gMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gMDtcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yX2J1dHRvbnMgPSB0aGlzLnBhZ2luYXRvci5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZXJfX3BhZ2UnKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zWzBdO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50Jyk7XG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRhbnNpdGlvbl90aW1lciA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnT1RyYW5zaXRpb24nOiAnb1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ21zVHJhbnNpdGlvbic6ICdNU1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc0VuZEV2ZW50TmFtZXNbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldLCB0aGlzLmNoZWNrSW5kZXguYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKS5kZWxheSgpLnRoZW4odGhpcy50dXJuT24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVkLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogTW92ZSB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlVG9DdXJyZW50KCkge1xuICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1vdmUgdG8gZmlyc3Qgc2xpZGVcbiAgICAgICAgICovXG4gICAgICAgIG1vdmVUb0ZpcnN0KCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSAwO1xuICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNb3ZlIHRvIGxhc3Qgc2xpZGVcbiAgICAgICAgICovXG4gICAgICAgIG1vdmVUb0xhc3QoKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHRoaXMuY291bnQgLSAxO1xuICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUdXJuIG9uIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICovXG4gICAgICAgIHR1cm5PbigpIHtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0gPSBNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpICsgJyAuMjVzJztcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFR1cm4gb2ZmIHNjcm9sbCBhbmltYXRpb25cbiAgICAgICAgICovXG4gICAgICAgIHR1cm5PZmYoKSB7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldID0gJ25vbmUnO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2hvdyBzbGlkZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXjCoOKAlCBzbGlkZSBudW1iZXJcbiAgICAgICAgICovXG4gICAgICAgIG1vdmUoaW5kZXgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zZm9ybXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgKC10aGlzLndyYXBwZXIub2Zmc2V0V2lkdGggKiAoaW5kZXggKyAxKSkgKyAncHgpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gKC10aGlzLndyYXBwZXIub2Zmc2V0V2lkdGggKiAoaW5kZXggKyAxKSkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJld2luZCBzbGlkZXMgb24gcmVzaXplXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyByZXNpemVkKCkge1xuICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgIHRoaXMubW92ZVRvQ3VycmVudCgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlbGF5LCBzbyBicm93c2VyIG1heSByZWJ1aWxkIERPTSBhbmQgQ1NTXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBtaWxsaXNlY29uZHMg4oCUIGRlbGF5IGR1cmF0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBkZWxheShtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXdpbmQgc2xpZGVzXG4gICAgICAgICAqL1xuICAgICAgICBhc3luYyBjaGVja0luZGV4KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9wYWdlID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9MYXN0KCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50X3BhZ2UgPT0gdGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGVsYXkoMjUpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFuaW1hdGlvbiBmbGFnXG4gICAgICAgICAqL1xuICAgICAgICBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgYW5pbWF0aW9uIGZsYWdcbiAgICAgICAgICovXG4gICAgICAgIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbmltYXRpb24gZmxhZyBieSB0aW1lb3V0XG4gICAgICAgICAqL1xuICAgICAgICBkcm9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAodGhpcy50aW1lcikgIT0gJ3VuZGVmaW5lZCcpIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAzNTApO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZSBwYWdpbmF0b3IgYnV0dG9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCDigJTCoHNsaWRlIG51bWJlclxuICAgICAgICAgKi9cbiAgICAgICAgY3JlYXRlQnV0dG9uKGluZGV4KSB7XG4gICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJyksIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTUEFOJyk7XG4gICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlJywgaW5kZXgpO1xuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbGVyX19wYWdlJyk7XG4gICAgICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNjcm9sbFRvU2xpZGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRvci5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBjdXJyZW50IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBvcGVuU2xpZGUoKSB7XG4gICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgaWYoIXRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50YW5zaXRpb25fdGltZXIhPW51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRhbnNpdGlvbl90aW1lcik7XG4gICAgICAgICAgICAgICAgdGhpcy50YW5zaXRpb25fdGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuY2hlY2tJbmRleC5iaW5kKHRoaXMpLCAyNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBwcmV2aW91cyBzbGlkZVxuICAgICAgICAgKi9cbiAgICAgICAgb3BlblByZXZTbGlkZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZS0tO1xuICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjcm9sbCB0byBuZXh0IHNsaWRlXG4gICAgICAgICAqL1xuICAgICAgICBvcGVuTmV4dFNsaWRlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlKys7XG4gICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIHRoaXMub3BlblNsaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2Nyb2xsIHRvIHNlbGVjdGVkIHNsaWRlXG4gICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IOKAlCBjbGljayBldmVudCwgc28gd2UgbWF5IGdldCBwYWdpbmF0b3IgYnV0dG9uXG4gICAgICAgICAqL1xuICAgICAgICBzY3JvbGxUb1NsaWRlKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHBhcnNlSW50KGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScpLCAxMCk7XG4gICAgICAgICAgICBidXR0b24uYmx1cigpO1xuICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNb3ZlIHNjcm9sbGVyIHRvIHNlbGVjdGVkIHNsaWRlIGFuZCBzZXQgYnV0dG9ucyBzdGF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVwb3NTbGlkZSgpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZXJfX3BhZ2VfY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zW01hdGgubWluKE1hdGgubWF4KHRoaXMuY3VycmVudF9wYWdlLCAwKSwgdGhpcy5jb3VudCAtIDEpXTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZXJfX3BhZ2VfY3VycmVudCcsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIG5ldyBTY3JvbGxlcjtcbn0pKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbihmdW5jdGlvbigpIHtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgQ2xhc3MgaGFuZGxlIHRhYnMgbG9hZGluZ1xuICAgICAqL1xuICAgIGNsYXNzIFRhYnMge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFN0YXJ0IGluaXRpYWxpemF0aW9uIG9uIGRvbWxvYWRcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIGxldCByZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkaW5nIGV2ZW50cyBhbmQgcHJvcGVydGllc1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdCgpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYnMnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLndpZGdldCA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgRE9ORSA9IDRcbiAgICAgICAgICAgICAgICAsIE9LID0gMjAwXG4gICAgICAgICAgICAgICAgLCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICAgICAgICAgICwgc2VuZGVyID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdqcy90YWJzLmpzb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gRE9ORSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5jb2RlICsgJzogJyArIHhoci5zdGF0dXNUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzZW5kZXIudGhlbih0aGlzLmJ1aWxkLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBCdWlsZCB3aWRnZXRcbiAgICAgICAgICovXG4gICAgICAgIGJ1aWxkIChtZXNzYWdlKSB7XG5cbiAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShtZXNzYWdlLnJlcGxhY2UoL1xcbi9nLCBcIlxcXFxuXCIpLnJlcGxhY2UoL1xcci9nLCBcIlxcXFxyXCIpLnJlcGxhY2UoL1xcdC9nLCBcIlxcXFx0XCIpLnJlcGxhY2UoL1xcZi9nLCBcIlxcXFxmXCIpKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpZGdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMud2lkZ2V0KTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53aWRnZXQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ01FTlUnKTtcbiAgICAgICAgICAgIG1lbnUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3Rvb2xiYXInKTtcbiAgICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZCgndGFic19fbWVudScpO1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQobWVudSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IHRhYiBvZiBkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQlVUVE9OJylcbiAgICAgICAgICAgICAgICAgICAgLCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTRUNUSU9OJylcbiAgICAgICAgICAgICAgICAgICAgLCB0ZXh0ID0gdGFiLkNvbnRlbnQuc3BsaXQoJ1xcblxcbicpO1xuXG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcsIHRhYi5UaXRsZSk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0YWIuVGl0bGUpKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5UYWIuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChidXR0b24pO1xuXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS10YWInLCB0YWIuVGl0bGUpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCd0YWJzX190YWInKTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IHBhcmFncmFwaCBvZiB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnUCcpO1xuICAgICAgICAgICAgICAgICAgICBwLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHBhcmFncmFwaCkpO1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKS5jbGljaygpO1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuY2xhc3NMaXN0LmFkZCgndGFic19idWlsZGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBvcGVuVGFiIChldmVudCkge1xuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXRcbiAgICAgICAgICAgICAgICAsIHRhcmdldCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX3RhYl9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X2J1dHRvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX19idXR0b25fY3VycmVudCcsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IGJ1dHRvbjtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fYnV0dG9uX2N1cnJlbnQnLCB0cnVlKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYiA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYj0nICsgdGFyZ2V0ICsgJ10nKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfdGFiICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX3RhYl9jdXJyZW50JywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXcgVGFicztcbn0pKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbihmdW5jdGlvbigpIHtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgQ2xhc3MgaGFuZGxlIHN1YnNjcmlwdGlvbiBwcm9jZXNzXG4gICAgICovXG4gICAgY2xhc3MgU3Vic2NyaWJlIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTdGFydCBpbml0aWFsaXphdGlvbiBvbiBkb21sb2FkXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZGluZyBldmVudHMgYW5kIHByb3BlcnRpZXNcbiAgICAgICAgICovXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5mb3JtID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMuaW5wdXQgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fZW1haWwnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19tZXNzYWdlID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19mYWlsID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX2ZhaWwnKTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19wcm9ncmVzcyA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19zdGF0ZV9pbi1wcm9ncmVzcycpO1xuXG4gICAgICAgICAgICB0aGlzLmZvcm0uc2V0QXR0cmlidXRlKCdub3ZhbGlkYXRlJywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy52YWxpZGF0ZUZvcm0uYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFZhbGlkYXRpbmcgdXNlciBpbnB1dFxuICAgICAgICAgKi9cbiAgICAgICAgdmFsaWRhdGVGb3JtKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBsZXQgZW1haWxfcmVnZXggPSBuZXcgUmVnRXhwKFwiXihbYS16QS1aMC05X1xcLlxcLV0pK1xcQCgoW2EtekEtWjAtOVxcLV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyRcIik7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgKHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDAgJiYgZW1haWxfcmVnZXgudGVzdCh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKSkgPT09IGZhbHNlIHx8IHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICB8fCAodGhpcy5pbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdmYWlsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgRE9ORSA9IDRcbiAgICAgICAgICAgICAgICAsIE9LID0gMjAwXG4gICAgICAgICAgICAgICAgLCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICAgICAgICAgICwgc2VuZGVyID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdqcy9zdWJzY3JpYmUuanNvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNlbmQobmV3IEZvcm1EYXRhKHRoaXMuZm9ybSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5jb2RlICsgJzogJyArIHhoci5zdGF0dXNUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdwcm9ncmVzcycpO1xuICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5zdWNjZXNzLmJpbmQodGhpcykpLmNhdGNoKHRoaXMuZmFpbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gcmVxdWVzdCBoYXZlIHN1Y2NlZWRlZFxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBzZXJ2ZXIgYW5zd2VyXG4gICAgICAgICAqL1xuICAgICAgICBzdWNjZXNzIChtZXNzYWdlKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShtZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcyl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnc3VjY2VzcycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdmYWlsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBmYWlsZWRcbiAgICAgICAgICogQHBhcmFtIHtFcnJvcn0gZXJyb3IgZXJyb3Igb2JqZWN0XG4gICAgICAgICAqL1xuICAgICAgICBmYWlsIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTZXQgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdGF0ZSBuZXcgc3RhdGVcbiAgICAgICAgICovXG4gICAgICAgIHNldFN0YXRlIChzdGF0ZSkge1xuXG4gICAgICAgICAgICBsZXQgZmFpbCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGZhbHNlO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImZhaWxcIjpcbiAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicHJvZ3Jlc3NcIjpcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9mYWlsJywgZmFpbCk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5jbGFzc0xpc3QudG9nZ2xlKCdzdWJzY3JpYmVfcHJvZ3Jlc3MnLCBwcm9ncmVzcyk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBuZXcgU3Vic2NyaWJlO1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

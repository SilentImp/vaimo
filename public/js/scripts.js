"use strict";function _typeof(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function i(i,o){try{var a=e[i](o),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(r,s)}var r=i.bind(null,"next"),s=i.bind(null,"throw");r()})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t){function e(t,e,n,r){var s=Object.create((e||i).prototype),o=new f(r||[]);return s._invoke=c(t,n,o),s}function n(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(i){return{type:"throw",arg:i}}}function i(){}function r(){}function s(){}function o(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function a(t){this.arg=t}function u(t){function e(i,r,s,o){var u=n(t[i],t,r);if("throw"!==u.type){var c=u.arg,l=c.value;return l instanceof a?Promise.resolve(l.arg).then(function(t){e("next",t,s,o)},function(t){e("throw",t,s,o)}):Promise.resolve(l).then(function(t){c.value=t,s(c)},o)}o(u.arg)}function i(t,n){function i(){return new Promise(function(i,r){e(t,n,i,r)})}return r=r?r.then(i,i):i()}"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.domain&&(e=process.domain.bind(e));var r;this._invoke=i}function c(t,e,i){var r=k;return function(s,o){if(r===x)throw new Error("Generator is already running");if(r===S){if("throw"===s)throw o;return p()}for(;;){var a=i.delegate;if(a){if("return"===s||"throw"===s&&a.iterator[s]===v){i.delegate=null;var u=a.iterator["return"];if(u){var c=n(u,a.iterator,o);if("throw"===c.type){s="throw",o=c.arg;continue}}if("return"===s)continue}var c=n(a.iterator[s],a.iterator,o);if("throw"===c.type){i.delegate=null,s="throw",o=c.arg;continue}s="next",o=v;var l=c.arg;if(!l.done)return r=L,l;i[a.resultName]=l.value,i.next=a.nextLoc,i.delegate=null}if("next"===s)r===L?i.sent=o:i.sent=v;else if("throw"===s){if(r===k)throw r=S,o;i.dispatchException(o)&&(s="next",o=v)}else"return"===s&&i.abrupt("return",o);r=x;var c=n(t,e,i);if("normal"===c.type){r=i.done?S:L;var l={value:c.arg,done:i.done};if(c.arg!==E)return l;i.delegate&&"next"===s&&(o=v)}else"throw"===c.type&&(r=S,s="throw",o=c.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function f(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function d(t){if(t){var e=t[g];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(m.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=v,r.done=!0,r};return i.next=i}}return{next:p}}function p(){return{value:v,done:!0}}var v,m=Object.prototype.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},g=y.iterator||"@@iterator",b=y.toStringTag||"@@toStringTag",_="object"===("undefined"==typeof module?"undefined":_typeof(module)),w=t.regeneratorRuntime;if(w)return void(_&&(module.exports=w));w=t.regeneratorRuntime=_?module.exports:{},w.wrap=e;var k="suspendedStart",L="suspendedYield",x="executing",S="completed",E={},T=s.prototype=i.prototype;r.prototype=T.constructor=s,s.constructor=r,s[b]=r.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return e?e===r||"GeneratorFunction"===(e.displayName||e.name):!1},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(T),t},w.awrap=function(t){return new a(t)},o(u.prototype),w.async=function(t,n,i,r){var s=new u(e(t,n,i,r));return w.isGeneratorFunction(n)?s:s.next().then(function(t){return t.done?t.value:s.next()})},o(T),T[g]=function(){return this},T[b]="Generator",T.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},w.values=d,f.prototype={constructor:f,reset:function(t){if(this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return s.type="throw",s.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var o=m.call(r,"catchLoc"),a=m.call(r,"finallyLoc");if(o&&a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&m.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?this.next=r.finallyLoc:this.complete(s),E},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),E}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;h(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},E}}}("object"===("undefined"==typeof global?"undefined":_typeof(global))?global:"object"===("undefined"==typeof window?"undefined":_typeof(window))?window:"object"===("undefined"==typeof self?"undefined":_typeof(self))?self:void 0);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.favorites=document.querySelector(".favorite"),null!==this.favorites){var t=this.favorites.querySelectorAll(".product");if(this.count=t.length,0==this.count)return this.favorites.parentNode.removeChild(this.favorites),delete this.count,void delete this.favorites;if(this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.wrapper=this.favorites.querySelector(".favorite__wrapper-inner"),this.next_button=this.favorites.querySelector(".favorite__button_next"),this.prev_button=this.favorites.querySelector(".favorite__button_prev"),this.menu=this.favorites.querySelector(".favorite__menu"),this.next_button.addEventListener("click",this.next.bind(this)),this.prev_button.addEventListener("click",this.prev.bind(this)),this.margin=20,this.current=0,this.width=t[0].offsetWidth+this.margin,this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?this.menu.classList.toggle("favorite__menu_hidden",!0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.animation=!1,this.timer=null,this.transitions){var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(e[Modernizr.prefixed("transition")],this.stopAnimation.bind(this))}window.addEventListener("resize",this.resize.bind(this))}}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"stopAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.animation=!1}},{key:"dropAnimation",value:function(){null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),250)}},{key:"next",value:function(t){this.current++,this.current==this.count-this.inline+1&&(this.current=0),this.scroll(),this.next_button.blur()}},{key:"prev",value:function(t){this.current--,-1==this.current&&(this.current=this.count-this.inline),this.scroll(),this.prev_button.blur()}},{key:"resize",value:function(){this.inline=Math.floor((this.wrapper.offsetWidth+this.margin)/this.width),this.inline>=this.count?(this.menu.classList.toggle("favorite__menu_hidden",!0),this.current=0):this.menu.classList.toggle("favorite__menu_hidden",!1),this.scroll()}},{key:"scroll",value:function(){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.width*this.current+"px)":this.wrapper.style.right=-this.width*this.current+"px",this.dropAnimation()}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.navigation=document.querySelector(".navigation"),null!==this.navigation){var e=this.navigation.querySelectorAll(".navigation__label");[].forEach.call(e,function(e){e.addEventListener("click",t.openDropdown.bind(t))}),this.toggle=document.querySelector(".navigation__toggle"),this.toggle.addEventListener("click",this.toggleNavigation.bind(this))}}},{key:"toggleNavigation",value:function(){this.navigation.classList.toggle("navigation_open"),this.toggle.blur(),document.body.classList.toggle("navigation_open")}},{key:"openDropdown",value:function(t){t.currentTarget.classList.toggle("navigation__label_open"),t.currentTarget.nextElementSibling.classList.toggle("navigation__container_open")}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){if(this.scroller=document.querySelector(".scroller"),null!==this.scroller){if(this.wrapper=this.scroller.querySelector(".scroller__wrapper-inner"),this.slides=this.wrapper.querySelectorAll(".scroller__slide"),this.count=this.slides.length,0===this.count)return this.scroller.parentNode.removeChild(this.slides),delete this.wrapper,delete this.slides,delete this.scroller,void delete this.count;this.transitions=document.documentElement.classList.contains("csstransitions"),this.transforms=document.documentElement.classList.contains("csstransforms"),this.paginator=this.scroller.querySelector(".scroller__paginator"),this.prev_button=this.scroller.querySelector(".scroller__prev"),this.next_button=this.scroller.querySelector(".scroller__next"),this.prev_button.addEventListener("click",this.openPrevSlide.bind(this)),this.next_button.addEventListener("click",this.openNextSlide.bind(this));var t=this.slides[0].cloneNode(!0),e=this.slides[this.count-1].cloneNode(!0);t.classList.add("cloned"),e.classList.add("cloned"),this.wrapper.appendChild(t),this.wrapper.insertBefore(e,this.slides[0]);for(var n=this.count;n--;)this.createButton(this.count-n-1);if(this.current_page=0,this.paginator_buttons=this.paginator.querySelectorAll(".scroller__page"),this.current_button=this.paginator_buttons[0],this.current_button.classList.add("scroller__page_current"),this.animation=!1,this.tansition_timer=null,this.transitions){var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.wrapper.addEventListener(i[Modernizr.prefixed("transition")],this.checkIndex.bind(this))}this.moveToFirst().delay().then(this.turnOn.bind(this)),window.addEventListener("resize",this.resized.bind(this))}}},{key:"moveToCurrent",value:function(){return this.move(this.current_page),this}},{key:"moveToFirst",value:function(){return this.current_page=0,this.reposSlide(),this}},{key:"moveToLast",value:function(){return this.current_page=this.count-1,this.reposSlide(),this}},{key:"turnOn",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]=Modernizr.prefixed("transform")+" .25s",this}},{key:"turnOff",value:function(){return this.wrapper.style[Modernizr.prefixed("transition")]="none",this}},{key:"move",value:function(t){this.transforms?this.wrapper.style[Modernizr.prefixed("transform")]="translateX("+-this.wrapper.offsetWidth*(t+1)+"px)":this.wrapper.style.right=-this.wrapper.offsetWidth*(t+1)+"px"}},{key:"resized",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.turnOff(),t.next=3,this.delay(25);case 3:return this.moveToCurrent(),t.next=6,this.delay(25);case 6:this.turnOn();case 7:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"delay",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){setTimeout(e,t)}));case 1:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"checkIndex",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!=this.current_page){t.next=10;break}return this.turnOff(),t.next=4,this.delay(25);case 4:return this.moveToLast(),t.next=7,this.delay(25);case 7:this.turnOn(),t.next=18;break;case 10:if(this.current_page!=this.count){t.next=18;break}return this.turnOff(),t.next=14,this.delay(25);case 14:return this.moveToFirst(),t.next=17,this.delay(25);case 17:this.turnOn();case 18:this.stopAnimation();case 19:case"end":return t.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stopAnimation",value:function(){this.animation=!1}},{key:"startAnimation",value:function(){this.animation=!0}},{key:"dropAnimation",value:function(){"undefined"!=typeof this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.stopAnimation.bind(this),350)}},{key:"createButton",value:function(t){var e=document.createElement("BUTTON"),n=document.createElement("SPAN");e.setAttribute("type","button"),e.setAttribute("data-page",t),e.classList.add("scroller__page"),e.appendChild(n),e.addEventListener("click",this.scrollToSlide.bind(this)),this.paginator.appendChild(e)}},{key:"openSlide",value:function(){this.reposSlide(),this.dropAnimation(),this.transitions||(null!=this.tansition_timer&&clearTimeout(this.tansition_timer),this.tansition_timer=setTimeout(this.checkIndex.bind(this),250))}},{key:"openPrevSlide",value:function(t){this.animation!==!0&&(this.startAnimation(),this.current_page--,this.prev_button.blur(),this.openSlide())}},{key:"openNextSlide",value:function(t){this.animation!==!0&&(this.startAnimation(),this.current_page++,this.next_button.blur(),this.openSlide())}},{key:"scrollToSlide",value:function(t){if(this.animation!==!0){this.startAnimation();var e=t.currentTarget;this.current_page=parseInt(e.getAttribute("data-page"),10),e.blur(),this.openSlide()}}},{key:"reposSlide",value:function(){this.current_button.classList.toggle("scroller__page_current",!1),this.current_button=this.paginator_buttons[Math.min(Math.max(this.current_page,0),this.count-1)],this.current_button.classList.toggle("scroller__page_current",!0),this.move(this.current_page)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){this.form=document.querySelector(".subscribe"),null!==this.form&&(this.input=this.form.querySelector(".subscribe__email"),this.success_message=this.form.querySelector(".subscribe__state_success"),this.success_fail=this.form.querySelector(".subscribe__state_fail"),this.success_progress=this.form.querySelector(".subscribe__state_in-progress"),this.form.setAttribute("novalidate",!0),this.form.addEventListener("submit",this.validateForm.bind(this)))}},{key:"validateForm",value:function(t){var e=this;t.preventDefault();var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$");if(this.input.value.trim().length>0&&n.test(this.input.value.trim())===!1||0===this.input.value.trim().length||0===this.input.value.trim().length)return void this.setState("fail");var i=4,r=200,s=new XMLHttpRequest,o=new Promise(function(t,n){try{s.open("POST",e.form.getAttribute("action")),s.send(new FormData(e.form)),s.onreadystatechange=function(){s.readyState===i&&(e.form.reset(),e.setState(),s.status===r?t(s.response):n(new Error(s.code+": "+s.statusText)))}}catch(o){n(o)}});this.setState("progress"),o.then(this.success.bind(this))["catch"](this.fail.bind(this))}},{key:"success",value:function(t){var e=JSON.parse(t);e.success?this.setState("success"):this.setState("fail")}},{key:"fail",value:function(t){this.setState("fail")}},{key:"setState",value:function(t){var e=!1,n=!1,i=!1;switch(t){case"fail":e=!0,this.input.focus();break;case"success":n=!0,this.input.blur();break;case"progress":i=!0}this.form.classList.toggle("subscribe_fail",e),this.form.classList.toggle("subscribe_success",n),this.form.classList.toggle("subscribe_progress",i)}}]),t}();new t}();var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.widget=document.querySelector(".tabs"),null!==this.widget){var e=4,n=200,i=new XMLHttpRequest,r=new Promise(function(r,s){try{i.open("GET",t.widget.getAttribute("data-url")),i.send(),i.onreadystatechange=function(){i.readyState===e&&(i.status===n?r(i.response):s(new Error(i.code+": "+i.statusText)))}}catch(o){s(o)}});r.then(this.build.bind(this))}}},{key:"build",value:function(t){var e=JSON.parse(t.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f"));if(this.current_button=null,this.current_tab=null,0==e.length)return this.widget.parentNode.removeChild(this.widget),void delete this.widget;var n=document.createElement("MENU");n.setAttribute("type","toolbar"),n.classList.add("tabs__menu"),this.widget.appendChild(n);var i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var u=o.value,c=document.createElement("BUTTON"),l=document.createElement("SECTION"),h=u.Content.split("\n\n");c.setAttribute("type","button"),c.setAttribute("data-target",u.Title),c.classList.add("tabs__button"),c.appendChild(document.createTextNode(u.Title)),c.addEventListener("click",this.openTab.bind(this)),n.appendChild(c),l.setAttribute("data-tab",u.Title),l.classList.add("tabs__tab");var f=!0,d=!1,p=void 0;try{for(var v,m=h[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var y=v.value,g=document.createElement("P");g.appendChild(document.createTextNode(y)),l.appendChild(g)}}catch(b){d=!0,p=b}finally{try{!f&&m["return"]&&m["return"]()}finally{if(d)throw p}}this.widget.appendChild(l)}}catch(b){r=!0,s=b}finally{try{!i&&a["return"]&&a["return"]()}finally{if(r)throw s}}n.querySelector("button").click(),this.widget.classList.add("tabs_builded")}},{key:"openTab",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-target");null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!1),null!=this.current_button&&this.current_button.classList.toggle("tabs__button_current",!1),this.current_button=e,this.current_button.classList.toggle("tabs__button_current",!0),this.current_tab=this.widget.querySelector("[data-tab="+n+"]"),null!=this.current_tab&&this.current_tab.classList.toggle("tabs__tab_current",!0)}}]),t}();new t}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiLCJydW50aW1lLmpzIiwiZmF2b3JpdGUuanMiLCJuYXZpZ2F0aW9uLmpzIiwic2Nyb2xsZXIuanMiLCJzdWJzY3JpYmUuanMiLCJ0YWJzLmpzIl0sIm5hbWVzIjpbIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJjb25zdHJ1Y3RvciIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfYXN5bmNUb0dlbmVyYXRvciIsImZuIiwiZ2VuIiwiYXBwbHkiLCJ0aGlzIiwiYXJndW1lbnRzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdGVwIiwia2V5IiwiYXJnIiwiaW5mbyIsInZhbHVlIiwiZXJyb3IiLCJkb25lIiwidGhlbiIsImNhbGxOZXh0IiwiY2FsbFRocm93IiwiYmluZCIsImdsb2JhbCIsIndyYXAiLCJpbm5lckZuIiwib3V0ZXJGbiIsInNlbGYiLCJ0cnlMb2NzTGlzdCIsImdlbmVyYXRvciIsIk9iamVjdCIsImNyZWF0ZSIsIkdlbmVyYXRvciIsInByb3RvdHlwZSIsImNvbnRleHQiLCJDb250ZXh0IiwiX2ludm9rZSIsIm1ha2VJbnZva2VNZXRob2QiLCJ0cnlDYXRjaCIsInR5cGUiLCJjYWxsIiwiZXJyIiwiR2VuZXJhdG9yRnVuY3Rpb24iLCJHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSIsImRlZmluZUl0ZXJhdG9yTWV0aG9kcyIsImZvckVhY2giLCJtZXRob2QiLCJBd2FpdEFyZ3VtZW50IiwiQXN5bmNJdGVyYXRvciIsImludm9rZSIsInJlY29yZCIsInJlc3VsdCIsInVud3JhcHBlZCIsImVucXVldWUiLCJjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyIsInByZXZpb3VzUHJvbWlzZSIsInByb2Nlc3MiLCJkb21haW4iLCJzdGF0ZSIsIkdlblN0YXRlU3VzcGVuZGVkU3RhcnQiLCJHZW5TdGF0ZUV4ZWN1dGluZyIsIkVycm9yIiwiR2VuU3RhdGVDb21wbGV0ZWQiLCJkb25lUmVzdWx0IiwiZGVsZWdhdGUiLCJpdGVyYXRvciIsInVuZGVmaW5lZCIsInJldHVybk1ldGhvZCIsIkdlblN0YXRlU3VzcGVuZGVkWWllbGQiLCJyZXN1bHROYW1lIiwibmV4dCIsIm5leHRMb2MiLCJzZW50IiwiZGlzcGF0Y2hFeGNlcHRpb24iLCJhYnJ1cHQiLCJDb250aW51ZVNlbnRpbmVsIiwicHVzaFRyeUVudHJ5IiwibG9jcyIsImVudHJ5IiwidHJ5TG9jIiwiY2F0Y2hMb2MiLCJmaW5hbGx5TG9jIiwiYWZ0ZXJMb2MiLCJ0cnlFbnRyaWVzIiwicHVzaCIsInJlc2V0VHJ5RW50cnkiLCJjb21wbGV0aW9uIiwicmVzZXQiLCJ2YWx1ZXMiLCJpdGVyYWJsZSIsIml0ZXJhdG9yTWV0aG9kIiwiaXRlcmF0b3JTeW1ib2wiLCJpc05hTiIsImxlbmd0aCIsImkiLCJoYXNPd24iLCJoYXNPd25Qcm9wZXJ0eSIsIiRTeW1ib2wiLCJ0b1N0cmluZ1RhZ1N5bWJvbCIsInRvU3RyaW5nVGFnIiwiaW5Nb2R1bGUiLCJtb2R1bGUiLCJydW50aW1lIiwicmVnZW5lcmF0b3JSdW50aW1lIiwiZXhwb3J0cyIsIkdwIiwiZGlzcGxheU5hbWUiLCJpc0dlbmVyYXRvckZ1bmN0aW9uIiwiZ2VuRnVuIiwiY3RvciIsIm5hbWUiLCJtYXJrIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJhd3JhcCIsImFzeW5jIiwiaXRlciIsInRvU3RyaW5nIiwia2V5cyIsIm9iamVjdCIsInJldmVyc2UiLCJwb3AiLCJza2lwVGVtcFJlc2V0IiwicHJldiIsImNoYXJBdCIsInNsaWNlIiwic3RvcCIsInJvb3RFbnRyeSIsInJvb3RSZWNvcmQiLCJydmFsIiwiZXhjZXB0aW9uIiwiaGFuZGxlIiwibG9jIiwiY2F1Z2h0IiwiaGFzQ2F0Y2giLCJoYXNGaW5hbGx5IiwiZmluYWxseUVudHJ5IiwiY29tcGxldGUiLCJmaW5pc2giLCJjYXRjaCIsInRocm93biIsImRlbGVnYXRlWWllbGQiLCJ3aW5kb3ciLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJGYXZvcml0ZXMiLCJyZWFkeSIsImRvY3VtZW50IiwicmVhZHlTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbml0IiwiZmF2b3JpdGVzIiwicXVlcnlTZWxlY3RvciIsInByb2R1Y3RzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvdW50IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidHJhbnNpdGlvbnMiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInRyYW5zZm9ybXMiLCJ3cmFwcGVyIiwibmV4dF9idXR0b24iLCJwcmV2X2J1dHRvbiIsIm1lbnUiLCJtYXJnaW4iLCJjdXJyZW50Iiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImlubGluZSIsIk1hdGgiLCJmbG9vciIsInRvZ2dsZSIsImFuaW1hdGlvbiIsInRpbWVyIiwidHJhbnNFbmRFdmVudE5hbWVzIiwiV2Via2l0VHJhbnNpdGlvbiIsIk1velRyYW5zaXRpb24iLCJPVHJhbnNpdGlvbiIsIm1zVHJhbnNpdGlvbiIsInRyYW5zaXRpb24iLCJNb2Rlcm5penIiLCJwcmVmaXhlZCIsInN0b3BBbmltYXRpb24iLCJyZXNpemUiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiZXZlbnQiLCJzY3JvbGwiLCJibHVyIiwic3R5bGUiLCJyaWdodCIsImRyb3BBbmltYXRpb24iLCJOYXZpZ2F0aW9uIiwiX3RoaXMiLCJuYXZpZ2F0aW9uIiwibGFiZWxzIiwibGFiZWwiLCJvcGVuRHJvcGRvd24iLCJ0b2dnbGVOYXZpZ2F0aW9uIiwiYm9keSIsImN1cnJlbnRUYXJnZXQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJTY3JvbGxlciIsInNjcm9sbGVyIiwic2xpZGVzIiwicGFnaW5hdG9yIiwib3BlblByZXZTbGlkZSIsIm9wZW5OZXh0U2xpZGUiLCJmaXJzdF9zbGlkZSIsImNsb25lTm9kZSIsImxhc3Rfc2xpZGUiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsImluZGV4IiwiY3JlYXRlQnV0dG9uIiwiY3VycmVudF9wYWdlIiwicGFnaW5hdG9yX2J1dHRvbnMiLCJjdXJyZW50X2J1dHRvbiIsInRhbnNpdGlvbl90aW1lciIsImNoZWNrSW5kZXgiLCJtb3ZlVG9GaXJzdCIsImRlbGF5IiwidHVybk9uIiwicmVzaXplZCIsIm1vdmUiLCJyZXBvc1NsaWRlIiwicmVmIiwiX2NhbGxlZSIsIl9jb250ZXh0IiwidHVybk9mZiIsIm1vdmVUb0N1cnJlbnQiLCJfY2FsbGVlMiIsIm1pbGxpc2Vjb25kcyIsIl9jb250ZXh0MiIsIl94IiwiX2NhbGxlZTMiLCJfY29udGV4dDMiLCJtb3ZlVG9MYXN0IiwiYnV0dG9uIiwiY3JlYXRlRWxlbWVudCIsInNwYW4iLCJzZXRBdHRyaWJ1dGUiLCJzY3JvbGxUb1NsaWRlIiwic3RhcnRBbmltYXRpb24iLCJvcGVuU2xpZGUiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsIm1pbiIsIm1heCIsIlN1YnNjcmliZSIsImZvcm0iLCJpbnB1dCIsInN1Y2Nlc3NfbWVzc2FnZSIsInN1Y2Nlc3NfZmFpbCIsInN1Y2Nlc3NfcHJvZ3Jlc3MiLCJ2YWxpZGF0ZUZvcm0iLCJwcmV2ZW50RGVmYXVsdCIsImVtYWlsX3JlZ2V4IiwiUmVnRXhwIiwidHJpbSIsInRlc3QiLCJzZXRTdGF0ZSIsIkRPTkUiLCJPSyIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwic2VuZGVyIiwib3BlbiIsInNlbmQiLCJGb3JtRGF0YSIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInN0YXR1cyIsInJlc3BvbnNlIiwiY29kZSIsInN0YXR1c1RleHQiLCJzdWNjZXNzIiwiZmFpbCIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJwcm9ncmVzcyIsImZvY3VzIiwiVGFicyIsIndpZGdldCIsImJ1aWxkIiwiZGF0YSIsInJlcGxhY2UiLCJjdXJyZW50X3RhYiIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJ0YWIiLCJjb250YWluZXIiLCJ0ZXh0IiwiQ29udGVudCIsInNwbGl0IiwiVGl0bGUiLCJjcmVhdGVUZXh0Tm9kZSIsIm9wZW5UYWIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJwYXJhZ3JhcGgiLCJwIiwiY2xpY2siXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsU0FBU0EsU0FBUUMsR0FBTyxNQUFPQSxJQUF5QixtQkFBWEMsU0FBMEJELEVBQUlFLGNBQWdCRCxPQUFTLGVBQWtCRCxHQW1vQnRILFFBQVNHLGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQTJJaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBd0RoSCxRQUFTQyxtQkFBa0JDLEdBQU0sTUFBTyxZQUFjLEdBQUlDLEdBQU1ELEVBQUdFLE1BQU1DLEtBQU1DLFVBQVksT0FBTyxJQUFJQyxTQUFRLFNBQVVDLEVBQVNDLEdBQTRGLFFBQVNDLEdBQUtDLEVBQUtDLEdBQU8sSUFBTSxHQUFJQyxHQUFPVixFQUFJUSxHQUFLQyxHQUFVRSxFQUFRRCxFQUFLQyxNQUFTLE1BQU9DLEdBQXdCLFdBQWZOLEdBQU9NLEdBQXNCRixFQUFLRyxLQUFRUixFQUFRTSxHQUFpQlAsUUFBUUMsUUFBUU0sR0FBT0csS0FBS0MsRUFBVUMsR0FBL1IsR0FBSUQsR0FBV1IsRUFBS1UsS0FBSyxLQUFNLFFBQWFELEVBQVlULEVBQUtVLEtBQUssS0FBTSxRQUF1T0YsUUFF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bUYsSU55MUN0QixNQUFPMVEsR0FDTHFRLEdBQW9CLEVBQ3BCQyxFQUFpQnRRLEVBQ25CLFFBQ0UsS0FDU29RLEdBQTZCSSxFQUFBQSxXQUM5QkEsRUFBQUEsWUFFTixRQUNFLEdBQUlILEVBQ0EsS0FBTUMsSU1oMkN0QmhJLEVBQUtkLGNBQWMsVUFBVWdLLFFBQzdCMVQsS0FBS2lTLE9BQU8vSCxVQUFVc0QsSUFBSSxtQk53MkMxQmxOLElBQUssVUFDTEcsTUFBTyxTTXQyQ0ZzTCxHQUNMLEdBQUlxRCxHQUFTckQsRUFBTWMsY0FDYm5FLEVBQVMwRyxFQUFPUSxhQUFhLGNBRVgsT0FBcEI1UCxLQUFLcVMsYUFDTHJTLEtBQUtxUyxZQUFZbkksVUFBVWMsT0FBTyxxQkFBcUIsR0FHaEMsTUFBdkJoTCxLQUFLK04sZ0JBQ0wvTixLQUFLK04sZUFBZTdELFVBQVVjLE9BQU8sd0JBQXdCLEdBR2pFaEwsS0FBSytOLGVBQWlCcUIsRUFDdEJwUCxLQUFLK04sZUFBZTdELFVBQVVjLE9BQU8sd0JBQXdCLEdBRTdEaEwsS0FBS3FTLFlBQWNyUyxLQUFLaVMsT0FBT3ZJLGNBQWMsYUFBZWhCLEVBQVMsS0FDN0MsTUFBcEIxSSxLQUFLcVMsYUFDTHJTLEtBQUtxUyxZQUFZbkksVUFBVWMsT0FBTyxxQkFBcUIsT0E5RzdEZ0gsSUFtSE4sSUFBSUEiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfVxuXG4vKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBodHRwczovL3Jhdy5naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL21hc3Rlci9MSUNFTlNFIGZpbGUuIEFuXG4gKiBhZGRpdGlvbmFsIGdyYW50IG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW5cbiAqIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4hKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIHZhciBpbk1vZHVsZSA9ICh0eXBlb2YgbW9kdWxlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YobW9kdWxlKSkgPT09IFwib2JqZWN0XCI7XG4gIHZhciBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZTtcbiAgaWYgKHJ1bnRpbWUpIHtcbiAgICBpZiAoaW5Nb2R1bGUpIHtcbiAgICAgIC8vIElmIHJlZ2VuZXJhdG9yUnVudGltZSBpcyBkZWZpbmVkIGdsb2JhbGx5IGFuZCB3ZSdyZSBpbiBhIG1vZHVsZSxcbiAgICAgIC8vIG1ha2UgdGhlIGV4cG9ydHMgb2JqZWN0IGlkZW50aWNhbCB0byByZWdlbmVyYXRvclJ1bnRpbWUuXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHJ1bnRpbWU7XG4gICAgfVxuICAgIC8vIERvbid0IGJvdGhlciBldmFsdWF0aW5nIHRoZSByZXN0IG9mIHRoaXMgZmlsZSBpZiB0aGUgcnVudGltZSB3YXNcbiAgICAvLyBhbHJlYWR5IGRlZmluZWQgZ2xvYmFsbHkuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRGVmaW5lIHRoZSBydW50aW1lIGdsb2JhbGx5IChhcyBleHBlY3RlZCBieSBnZW5lcmF0ZWQgY29kZSkgYXMgZWl0aGVyXG4gIC8vIG1vZHVsZS5leHBvcnRzIChpZiB3ZSdyZSBpbiBhIG1vZHVsZSkgb3IgYSBuZXcsIGVtcHR5IG9iamVjdC5cbiAgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWUgPSBpbk1vZHVsZSA/IG1vZHVsZS5leHBvcnRzIDoge307XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQsIHRoZW4gb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IuXG4gICAgdmFyIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUoKG91dGVyRm4gfHwgR2VuZXJhdG9yKS5wcm90b3R5cGUpO1xuICAgIHZhciBjb250ZXh0ID0gbmV3IENvbnRleHQodHJ5TG9jc0xpc3QgfHwgW10pO1xuXG4gICAgLy8gVGhlIC5faW52b2tlIG1ldGhvZCB1bmlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcy5cbiAgICBnZW5lcmF0b3IuX2ludm9rZSA9IG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG5cbiAgICByZXR1cm4gZ2VuZXJhdG9yO1xuICB9XG4gIHJ1bnRpbWUud3JhcCA9IHdyYXA7XG5cbiAgLy8gVHJ5L2NhdGNoIGhlbHBlciB0byBtaW5pbWl6ZSBkZW9wdGltaXphdGlvbnMuIFJldHVybnMgYSBjb21wbGV0aW9uXG4gIC8vIHJlY29yZCBsaWtlIGNvbnRleHQudHJ5RW50cmllc1tpXS5jb21wbGV0aW9uLiBUaGlzIGludGVyZmFjZSBjb3VsZFxuICAvLyBoYXZlIGJlZW4gKGFuZCB3YXMgcHJldmlvdXNseSkgZGVzaWduZWQgdG8gdGFrZSBhIGNsb3N1cmUgdG8gYmVcbiAgLy8gaW52b2tlZCB3aXRob3V0IGFyZ3VtZW50cywgYnV0IGluIGFsbCB0aGUgY2FzZXMgd2UgY2FyZSBhYm91dCB3ZVxuICAvLyBhbHJlYWR5IGhhdmUgYW4gZXhpc3RpbmcgbWV0aG9kIHdlIHdhbnQgdG8gY2FsbCwgc28gdGhlcmUncyBubyBuZWVkXG4gIC8vIHRvIGNyZWF0ZSBhIG5ldyBmdW5jdGlvbiBvYmplY3QuIFdlIGNhbiBldmVuIGdldCBhd2F5IHdpdGggYXNzdW1pbmdcbiAgLy8gdGhlIG1ldGhvZCB0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCwgc2luY2UgdGhhdCBoYXBwZW5zIHRvIGJlIHRydWVcbiAgLy8gaW4gZXZlcnkgY2FzZSwgc28gd2UgZG9uJ3QgaGF2ZSB0byB0b3VjaCB0aGUgYXJndW1lbnRzIG9iamVjdC4gVGhlXG4gIC8vIG9ubHkgYWRkaXRpb25hbCBhbGxvY2F0aW9uIHJlcXVpcmVkIGlzIHRoZSBjb21wbGV0aW9uIHJlY29yZCwgd2hpY2hcbiAgLy8gaGFzIGEgc3RhYmxlIHNoYXBlIGFuZCBzbyBob3BlZnVsbHkgc2hvdWxkIGJlIGNoZWFwIHRvIGFsbG9jYXRlLlxuICBmdW5jdGlvbiB0cnlDYXRjaChmbiwgb2JqLCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJub3JtYWxcIiwgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKSB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ0aHJvd1wiLCBhcmc6IGVyciB9O1xuICAgIH1cbiAgfVxuXG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0ID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCA9IFwic3VzcGVuZGVkWWllbGRcIjtcbiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gXCJleGVjdXRpbmdcIjtcbiAgdmFyIEdlblN0YXRlQ29tcGxldGVkID0gXCJjb21wbGV0ZWRcIjtcblxuICAvLyBSZXR1cm5pbmcgdGhpcyBvYmplY3QgZnJvbSB0aGUgaW5uZXJGbiBoYXMgdGhlIHNhbWUgZWZmZWN0IGFzXG4gIC8vIGJyZWFraW5nIG91dCBvZiB0aGUgZGlzcGF0Y2ggc3dpdGNoIHN0YXRlbWVudC5cbiAgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTtcblxuICAvLyBEdW1teSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMgdGhhdCB3ZSB1c2UgYXMgdGhlIC5jb25zdHJ1Y3RvciBhbmRcbiAgLy8gLmNvbnN0cnVjdG9yLnByb3RvdHlwZSBwcm9wZXJ0aWVzIGZvciBmdW5jdGlvbnMgdGhhdCByZXR1cm4gR2VuZXJhdG9yXG4gIC8vIG9iamVjdHMuIEZvciBmdWxsIHNwZWMgY29tcGxpYW5jZSwgeW91IG1heSB3aXNoIHRvIGNvbmZpZ3VyZSB5b3VyXG4gIC8vIG1pbmlmaWVyIG5vdCB0byBtYW5nbGUgdGhlIG5hbWVzIG9mIHRoZXNlIHR3byBmdW5jdGlvbnMuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fVxuXG4gIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdwLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlW3RvU3RyaW5nVGFnU3ltYm9sXSA9IEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuXG4gIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlXG4gIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICBwcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvciA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8XG4gICAgLy8gRm9yIHRoZSBuYXRpdmUgR2VuZXJhdG9yRnVuY3Rpb24gY29uc3RydWN0b3IsIHRoZSBiZXN0IHdlIGNhblxuICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSBcIkdlbmVyYXRvckZ1bmN0aW9uXCIgOiBmYWxzZTtcbiAgfTtcblxuICBydW50aW1lLm1hcmsgPSBmdW5jdGlvbiAoZ2VuRnVuKSB7XG4gICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikge1xuICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgdmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50YCB0byBkZXRlcm1pbmUgaWYgdGhlIHlpZWxkZWQgdmFsdWUgaXNcbiAgLy8gbWVhbnQgdG8gYmUgYXdhaXRlZC4gU29tZSBtYXkgY29uc2lkZXIgdGhlIG5hbWUgb2YgdGhpcyBtZXRob2QgdG9vXG4gIC8vIGN1dGVzeSwgYnV0IHRoZXkgYXJlIGN1cm11ZGdlb25zLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiBuZXcgQXdhaXRBcmd1bWVudChhcmcpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEF3YWl0QXJndW1lbnQoYXJnKSB7XG4gICAgdGhpcy5hcmcgPSBhcmc7XG4gIH1cblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHJlamVjdChyZWNvcmQuYXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWNvcmQuYXJnO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEF3YWl0QXJndW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlLmFyZykudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgZXJyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi4gSWYgdGhlIFByb21pc2UgaXMgcmVqZWN0ZWQsIGhvd2V2ZXIsIHRoZVxuICAgICAgICAgIC8vIHJlc3VsdCBmb3IgdGhpcyBpdGVyYXRpb24gd2lsbCBiZSByZWplY3RlZCB3aXRoIHRoZSBzYW1lXG4gICAgICAgICAgLy8gcmVhc29uLiBOb3RlIHRoYXQgcmVqZWN0aW9ucyBvZiB5aWVsZGVkIFByb21pc2VzIGFyZSBub3RcbiAgICAgICAgICAvLyB0aHJvd24gYmFjayBpbnRvIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIGFzIGlzIHRoZSBjYXNlXG4gICAgICAgICAgLy8gd2hlbiBhbiBhd2FpdGVkIFByb21pc2UgaXMgcmVqZWN0ZWQuIFRoaXMgZGlmZmVyZW5jZSBpblxuICAgICAgICAgIC8vIGJlaGF2aW9yIGJldHdlZW4geWllbGQgYW5kIGF3YWl0IGlzIGltcG9ydGFudCwgYmVjYXVzZSBpdFxuICAgICAgICAgIC8vIGFsbG93cyB0aGUgY29uc3VtZXIgdG8gZGVjaWRlIHdoYXQgdG8gZG8gd2l0aCB0aGUgeWllbGRlZFxuICAgICAgICAgIC8vIHJlamVjdGlvbiAoc3dhbGxvdyBpdCBhbmQgY29udGludWUsIG1hbnVhbGx5IC50aHJvdyBpdCBiYWNrXG4gICAgICAgICAgLy8gaW50byB0aGUgZ2VuZXJhdG9yLCBhYmFuZG9uIGl0ZXJhdGlvbiwgd2hhdGV2ZXIpLiBXaXRoXG4gICAgICAgICAgLy8gYXdhaXQsIGJ5IGNvbnRyYXN0LCB0aGVyZSBpcyBubyBvcHBvcnR1bml0eSB0byBleGFtaW5lIHRoZVxuICAgICAgICAgIC8vIHJlamVjdGlvbiByZWFzb24gb3V0c2lkZSB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBzbyB0aGVcbiAgICAgICAgICAvLyBvbmx5IG9wdGlvbiBpcyB0byB0aHJvdyBpdCBmcm9tIHRoZSBhd2FpdCBleHByZXNzaW9uLCBhbmRcbiAgICAgICAgICAvLyBsZXQgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiBoYW5kbGUgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCByZWplY3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICgodHlwZW9mIHByb2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihwcm9jZXNzKSkgPT09IFwib2JqZWN0XCIgJiYgcHJvY2Vzcy5kb21haW4pIHtcbiAgICAgIGludm9rZSA9IHByb2Nlc3MuZG9tYWluLmJpbmQoaW52b2tlKTtcbiAgICB9XG5cbiAgICB2YXIgcHJldmlvdXNQcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykge1xuICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAvLyBJZiBlbnF1ZXVlIGhhcyBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gd2Ugd2FudCB0byB3YWl0IHVudGlsXG4gICAgICAvLyBhbGwgcHJldmlvdXMgUHJvbWlzZXMgaGF2ZSBiZWVuIHJlc29sdmVkIGJlZm9yZSBjYWxsaW5nIGludm9rZSxcbiAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgIC8vIGVucXVldWUgaGFzIG5vdCBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gaXQgaXMgaW1wb3J0YW50IHRvXG4gICAgICAvLyBjYWxsIGludm9rZSBpbW1lZGlhdGVseSwgd2l0aG91dCB3YWl0aW5nIG9uIGEgY2FsbGJhY2sgdG8gZmlyZSxcbiAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAvLyBhbnkgbmVjZXNzYXJ5IHNldHVwIGluIGEgcHJlZGljdGFibGUgd2F5LiBUaGlzIHByZWRpY3RhYmlsaXR5XG4gICAgICAvLyBpcyB3aHkgdGhlIFByb21pc2UgY29uc3RydWN0b3Igc3luY2hyb25vdXNseSBpbnZva2VzIGl0c1xuICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgIC8vIGV4ZWN1dGUgY29kZSBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0LiBTaW5jZSB3ZSBpbXBsZW1lbnQgc2ltcGxlXG4gICAgICAvLyBhc3luYyBmdW5jdGlvbnMgaW4gdGVybXMgb2YgYXN5bmMgZ2VuZXJhdG9ycywgaXQgaXMgZXNwZWNpYWxseVxuICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsXG4gICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgLy8gaW52b2NhdGlvbnMgb2YgdGhlIGl0ZXJhdG9yLlxuICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcpIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuXG4gIC8vIE5vdGUgdGhhdCBzaW1wbGUgYXN5bmMgZnVuY3Rpb25zIGFyZSBpbXBsZW1lbnRlZCBvbiB0b3Agb2ZcbiAgLy8gQXN5bmNJdGVyYXRvciBvYmplY3RzOyB0aGV5IGp1c3QgcmV0dXJuIGEgUHJvbWlzZSBmb3IgdGhlIHZhbHVlIG9mXG4gIC8vIHRoZSBmaW5hbCByZXN1bHQgcHJvZHVjZWQgYnkgdGhlIGl0ZXJhdG9yLlxuICBydW50aW1lLmFzeW5jID0gZnVuY3Rpb24gKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcih3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSk7XG5cbiAgICByZXR1cm4gcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pID8gaXRlciAvLyBJZiBvdXRlckZuIGlzIGEgZ2VuZXJhdG9yLCByZXR1cm4gdGhlIGZ1bGwgaXRlcmF0b3IuXG4gICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgIHZhciBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzpcbiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZVxuICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuICAgICAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiIHx8IG1ldGhvZCA9PT0gXCJ0aHJvd1wiICYmIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gQSByZXR1cm4gb3IgdGhyb3cgKHdoZW4gdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBubyB0aHJvd1xuICAgICAgICAgICAgLy8gbWV0aG9kKSBhbHdheXMgdGVybWluYXRlcyB0aGUgeWllbGQqIGxvb3AuXG4gICAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgICAgLy8gY2hhbmNlIHRvIGNsZWFuIHVwLlxuICAgICAgICAgICAgdmFyIHJldHVybk1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW1wicmV0dXJuXCJdO1xuICAgICAgICAgICAgaWYgKHJldHVybk1ldGhvZCkge1xuICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2gocmV0dXJuTWV0aG9kLCBkZWxlZ2F0ZS5pdGVyYXRvciwgYXJnKTtcbiAgICAgICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmV0dXJuIG1ldGhvZCB0aHJldyBhbiBleGNlcHRpb24sIGxldCB0aGF0XG4gICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIHByZXZhaWwgb3ZlciB0aGUgb3JpZ2luYWwgcmV0dXJuIG9yIHRocm93LlxuICAgICAgICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICAgICAgLy8gQ29udGludWUgd2l0aCB0aGUgb3V0ZXIgcmV0dXJuLCBub3cgdGhhdCB0aGUgZGVsZWdhdGVcbiAgICAgICAgICAgICAgLy8gaXRlcmF0b3IgaGFzIGJlZW4gdGVybWluYXRlZC5cbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0sIGRlbGVnYXRlLml0ZXJhdG9yLCBhcmcpO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBMaWtlIHJldHVybmluZyBnZW5lcmF0b3IudGhyb3codW5jYXVnaHQpLCBidXQgd2l0aG91dCB0aGVcbiAgICAgICAgICAgIC8vIG92ZXJoZWFkIG9mIGFuIGV4dHJhIGZ1bmN0aW9uIGNhbGwuXG4gICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRGVsZWdhdGUgZ2VuZXJhdG9yIHJhbiBhbmQgaGFuZGxlZCBpdHMgb3duIGV4Y2VwdGlvbnMgc29cbiAgICAgICAgICAvLyByZWdhcmRsZXNzIG9mIHdoYXQgdGhlIG1ldGhvZCB3YXMsIHdlIGNvbnRpbnVlIGFzIGlmIGl0IGlzXG4gICAgICAgICAgLy8gXCJuZXh0XCIgd2l0aCBhbiB1bmRlZmluZWQgYXJnLlxuICAgICAgICAgIG1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcbiAgICAgICAgICBpZiAoaW5mby5kb25lKSB7XG4gICAgICAgICAgICBjb250ZXh0W2RlbGVnYXRlLnJlc3VsdE5hbWVdID0gaW5mby52YWx1ZTtcbiAgICAgICAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkWWllbGQpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2VudCA9IGFyZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihhcmcpKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZGlzcGF0Y2hlZCBleGNlcHRpb24gd2FzIGNhdWdodCBieSBhIGNhdGNoIGJsb2NrLFxuICAgICAgICAgICAgLy8gdGhlbiBsZXQgdGhhdCBjYXRjaCBibG9jayBoYW5kbGUgdGhlIGV4Y2VwdGlvbiBub3JtYWxseS5cbiAgICAgICAgICAgIG1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmUgPyBHZW5TdGF0ZUNvbXBsZXRlZCA6IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7XG5cbiAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgIHZhbHVlOiByZWNvcmQuYXJnLFxuICAgICAgICAgICAgZG9uZTogY29udGV4dC5kb25lXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBpZiAoY29udGV4dC5kZWxlZ2F0ZSAmJiBtZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0XG4gICAgICAgICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS5cbiAgICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZVxuICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSBjYWxsIGFib3ZlLlxuICAgICAgICAgIG1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIERlZmluZSBHZW5lcmF0b3IucHJvdG90eXBlLntuZXh0LHRocm93LHJldHVybn0gaW4gdGVybXMgb2YgdGhlXG4gIC8vIHVuaWZpZWQgLl9pbnZva2UgaGVscGVyIG1ldGhvZC5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEdwKTtcblxuICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfTtcblxuICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykge1xuICAgIHZhciBlbnRyeSA9IHsgdHJ5TG9jOiBsb2NzWzBdIH07XG5cbiAgICBpZiAoMSBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV07XG4gICAgfVxuXG4gICAgaWYgKDIgaW4gbG9jcykge1xuICAgICAgZW50cnkuZmluYWxseUxvYyA9IGxvY3NbMl07XG4gICAgICBlbnRyeS5hZnRlckxvYyA9IGxvY3NbM107XG4gICAgfVxuXG4gICAgdGhpcy50cnlFbnRyaWVzLnB1c2goZW50cnkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVzZXRUcnlFbnRyeShlbnRyeSkge1xuICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uIHx8IHt9O1xuICAgIHJlY29yZC50eXBlID0gXCJub3JtYWxcIjtcbiAgICBkZWxldGUgcmVjb3JkLmFyZztcbiAgICBlbnRyeS5jb21wbGV0aW9uID0gcmVjb3JkO1xuICB9XG5cbiAgZnVuY3Rpb24gQ29udGV4dCh0cnlMb2NzTGlzdCkge1xuICAgIC8vIFRoZSByb290IGVudHJ5IG9iamVjdCAoZWZmZWN0aXZlbHkgYSB0cnkgc3RhdGVtZW50IHdpdGhvdXQgYSBjYXRjaFxuICAgIC8vIG9yIGEgZmluYWxseSBibG9jaykgZ2l2ZXMgdXMgYSBwbGFjZSB0byBzdG9yZSB2YWx1ZXMgdGhyb3duIGZyb21cbiAgICAvLyBsb2NhdGlvbnMgd2hlcmUgdGhlcmUgaXMgbm8gZW5jbG9zaW5nIHRyeSBzdGF0ZW1lbnQuXG4gICAgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiBcInJvb3RcIiB9XTtcbiAgICB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyk7XG4gICAgdGhpcy5yZXNldCh0cnVlKTtcbiAgfVxuXG4gIHJ1bnRpbWUua2V5cyA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cbiAgICBrZXlzLnJldmVyc2UoKTtcblxuICAgIC8vIFJhdGhlciB0aGFuIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBhIG5leHQgbWV0aG9kLCB3ZSBrZWVwXG4gICAgLy8gdGhpbmdzIHNpbXBsZSBhbmQgcmV0dXJuIHRoZSBuZXh0IGZ1bmN0aW9uIGl0c2VsZi5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0ga2V5cy5wb3AoKTtcbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5O1xuICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRvIGF2b2lkIGNyZWF0aW5nIGFuIGFkZGl0aW9uYWwgb2JqZWN0LCB3ZSBqdXN0IGhhbmcgdGhlIC52YWx1ZVxuICAgICAgLy8gYW5kIC5kb25lIHByb3BlcnRpZXMgb2ZmIHRoZSBuZXh0IGZ1bmN0aW9uIG9iamVjdCBpdHNlbGYuIFRoaXNcbiAgICAgIC8vIGFsc28gZW5zdXJlcyB0aGF0IHRoZSBtaW5pZmllciB3aWxsIG5vdCBhbm9ueW1pemUgdGhlIGZ1bmN0aW9uLlxuICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlKSB7XG4gICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07XG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGl0ZXJhYmxlLm5leHQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkge1xuICAgICAgICB2YXIgaSA9IC0xLFxuICAgICAgICAgICAgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIHJ1bnRpbWUudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICB0aGlzLnNlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KTtcblxuICAgICAgaWYgKCFza2lwVGVtcFJlc2V0KSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcykge1xuICAgICAgICAgIC8vIE5vdCBzdXJlIGFib3V0IHRoZSBvcHRpbWFsIG9yZGVyIG9mIHRoZXNlIGNvbmRpdGlvbnM6XG4gICAgICAgICAgaWYgKG5hbWUuY2hhckF0KDApID09PSBcInRcIiAmJiBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJiAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblxuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG4gICAgICBpZiAocm9vdFJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcm9vdFJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcblxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiBkaXNwYXRjaEV4Y2VwdGlvbihleGNlcHRpb24pIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcbiAgICAgICAgcmV0dXJuICEhY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIG91dHNpZGUgb2YgYW55IHRyeSBibG9jayB0aGF0IGNvdWxkIGhhbmRsZVxuICAgICAgICAgIC8vIGl0LCBzbyBzZXQgdGhlIGNvbXBsZXRpb24gdmFsdWUgb2YgdGhlIGVudGlyZSBmdW5jdGlvbiB0b1xuICAgICAgICAgIC8vIHRocm93IHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIik7XG4gICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJiBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpICYmIHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB2YXIgZmluYWxseUVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSAmJiAodHlwZSA9PT0gXCJicmVha1wiIHx8IHR5cGUgPT09IFwiY29udGludWVcIikgJiYgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiYgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGFcbiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLlxuICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJlY29yZC50eXBlID0gdHlwZTtcbiAgICAgIHJlY29yZC5hcmcgPSBhcmc7XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNvbXBsZXRlKHJlY29yZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcImJyZWFrXCIgfHwgcmVjb3JkLnR5cGUgPT09IFwiY29udGludWVcIikge1xuICAgICAgICB0aGlzLm5leHQgPSByZWNvcmQuYXJnO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICB0aGlzLnJ2YWwgPSByZWNvcmQuYXJnO1xuICAgICAgICB0aGlzLm5leHQgPSBcImVuZFwiO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIiAmJiBhZnRlckxvYykge1xuICAgICAgICB0aGlzLm5leHQgPSBhZnRlckxvYztcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbiBfY2F0Y2godHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIGRlbGVnYXRlWWllbGQoaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG59KShcbi8vIEFtb25nIHRoZSB2YXJpb3VzIHRyaWNrcyBmb3Igb2J0YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBnbG9iYWxcbi8vIG9iamVjdCwgdGhpcyBzZWVtcyB0byBiZSB0aGUgbW9zdCByZWxpYWJsZSB0ZWNobmlxdWUgdGhhdCBkb2VzIG5vdFxuLy8gdXNlIGluZGlyZWN0IGV2YWwgKHdoaWNoIHZpb2xhdGVzIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5KS5cbih0eXBlb2YgZ2xvYmFsID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoZ2xvYmFsKSkgPT09IFwib2JqZWN0XCIgPyBnbG9iYWwgOiAodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHdpbmRvdykpID09PSBcIm9iamVjdFwiID8gd2luZG93IDogKHR5cGVvZiBzZWxmID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2Yoc2VsZikpID09PSBcIm9iamVjdFwiID8gc2VsZiA6IHVuZGVmaW5lZCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIHZhciBGYXZvcml0ZXMgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBGYXZvcml0ZXMoKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmF2b3JpdGVzKTtcblxuICAgICAgICAgICAgdmFyIHJlYWR5ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKEZhdm9yaXRlcywgW3tcbiAgICAgICAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZhdm9yaXRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZhdm9yaXRlcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2R1Y3RzID0gdGhpcy5mYXZvcml0ZXMucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gcHJvZHVjdHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvdW50ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZhdm9yaXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5mYXZvcml0ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY3NzdHJhbnNpdGlvbnMnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2Zvcm1zJyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX3dyYXBwZXItaW5uZXInKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24gPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX2J1dHRvbl9uZXh0Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX3ByZXYnKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX21lbnUnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm5leHQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucHJldi5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFyZ2luID0gMjA7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gcHJvZHVjdHNbMF0ub2Zmc2V0V2lkdGggKyB0aGlzLm1hcmdpbjtcbiAgICAgICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCArIHRoaXMubWFyZ2luKSAvIHRoaXMud2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lID49IHRoaXMuY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNFbmRFdmVudE5hbWVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1dlYmtpdFRyYW5zaXRpb24nOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnTW96VHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdPVHJhbnNpdGlvbic6ICdvVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXNUcmFuc2l0aW9uJzogJ01TVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc0VuZEV2ZW50TmFtZXNbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2l0aW9uJyldLCB0aGlzLnN0b3BBbmltYXRpb24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0YXJ0QW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnRBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic3RvcEFuaW1hdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3BBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGltZXIgIT0gbnVsbCkgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJkcm9wQW5pbWF0aW9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHJvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lciAhPSBudWxsKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQodGhpcy5zdG9wQW5pbWF0aW9uLmJpbmQodGhpcyksIDI1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJuZXh0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dChldmVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCsrO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnQgPT0gdGhpcy5jb3VudCAtIHRoaXMuaW5saW5lICsgMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24uYmx1cigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwicHJldlwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByZXYoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQtLTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IHRoaXMuY291bnQgLSB0aGlzLmlubGluZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGwoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInJlc2l6ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCArIHRoaXMubWFyZ2luKSAvIHRoaXMud2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5saW5lID49IHRoaXMuY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzY3JvbGxcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGwoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgLXRoaXMud2lkdGggKiB0aGlzLmN1cnJlbnQgKyAncHgpJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUucmlnaHQgPSAtdGhpcy53aWR0aCAqIHRoaXMuY3VycmVudCArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZHJvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIEZhdm9yaXRlcztcbiAgICB9KSgpO1xuXG4gICAgbmV3IEZhdm9yaXRlcygpO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIE5hdmlnYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBOYXZpZ2F0aW9uKCkge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdmlnYXRpb24pO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoTmF2aWdhdGlvbiwgW3tcbiAgICAgICAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb24nKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYXZpZ2F0aW9uID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgbGFiZWxzID0gdGhpcy5uYXZpZ2F0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZpZ2F0aW9uX19sYWJlbCcpO1xuICAgICAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChsYWJlbHMsIGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIF90aGlzLm9wZW5Ecm9wZG93bi5iaW5kKF90aGlzKSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX190b2dnbGUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlTmF2aWdhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInRvZ2dsZU5hdmlnYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVOYXZpZ2F0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX29wZW4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZS5ibHVyKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX29wZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5Ecm9wZG93blwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5Ecm9wZG93bihldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9fbGFiZWxfb3BlbicpO1xuICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fX2NvbnRhaW5lcl9vcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gTmF2aWdhdGlvbjtcbiAgICB9KSgpO1xuXG4gICAgbmV3IE5hdmlnYXRpb24oKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGNhbGxOZXh0ID0gc3RlcC5iaW5kKG51bGwsIFwibmV4dFwiKTsgdmFyIGNhbGxUaHJvdyA9IHN0ZXAuYmluZChudWxsLCBcInRocm93XCIpOyBmdW5jdGlvbiBzdGVwKGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihjYWxsTmV4dCwgY2FsbFRocm93KTsgfSB9IGNhbGxOZXh0KCk7IH0pOyB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIFNjcm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2Nyb2xsZXIoKSB7XG4gICAgICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2Nyb2xsZXIpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU2Nyb2xsZXIsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsZXIgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX193cmFwcGVyLWlubmVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zbGlkZXMgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVyX19zbGlkZScpO1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnQgPSB0aGlzLnNsaWRlcy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5zbGlkZXMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy53cmFwcGVyO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zbGlkZXM7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcm9sbGVyO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbnMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2l0aW9ucycpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtcyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zZm9ybXMnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3BhZ2luYXRvcicpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24gPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fcHJldicpO1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24gPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fbmV4dCcpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblByZXZTbGlkZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuTmV4dFNsaWRlLmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0X3NsaWRlID0gdGhpcy5zbGlkZXNbMF0uY2xvbmVOb2RlKHRydWUpLFxuICAgICAgICAgICAgICAgICAgICBsYXN0X3NsaWRlID0gdGhpcy5zbGlkZXNbdGhpcy5jb3VudCAtIDFdLmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgICAgICAgICAgIGZpcnN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgICAgIGxhc3Rfc2xpZGUuY2xhc3NMaXN0LmFkZCgnY2xvbmVkJyk7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFwcGVuZENoaWxkKGZpcnN0X3NsaWRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuaW5zZXJ0QmVmb3JlKGxhc3Rfc2xpZGUsIHRoaXMuc2xpZGVzWzBdKTtcblxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24odGhpcy5jb3VudCAtIGluZGV4IC0gMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yX2J1dHRvbnMgPSB0aGlzLnBhZ2luYXRvci5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZXJfX3BhZ2UnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gdGhpcy5wYWdpbmF0b3JfYnV0dG9uc1swXTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy50YW5zaXRpb25fdGltZXIgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnT1RyYW5zaXRpb24nOiAnb1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ21zVHJhbnNpdGlvbic6ICdNU1RyYW5zaXRpb25FbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNFbmRFdmVudE5hbWVzW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSwgdGhpcy5jaGVja0luZGV4LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKS5kZWxheSgpLnRoZW4odGhpcy50dXJuT24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm1vdmVUb0N1cnJlbnRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlVG9DdXJyZW50KCkge1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZSh0aGlzLmN1cnJlbnRfcGFnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJtb3ZlVG9GaXJzdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUb0ZpcnN0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm1vdmVUb0xhc3RcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlVG9MYXN0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gdGhpcy5jb3VudCAtIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBvc1NsaWRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJ0dXJuT25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0dXJuT24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSA9IE1vZGVybml6ci5wcmVmaXhlZCgndHJhbnNmb3JtJykgKyAnIC4yNXMnO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwidHVybk9mZlwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHR1cm5PZmYoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSA9ICdub25lJztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm1vdmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGVbTW9kZXJuaXpyLnByZWZpeGVkKCd0cmFuc2Zvcm0nKV0gPSAndHJhbnNsYXRlWCgnICsgLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpICsgJ3B4KSc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlLnJpZ2h0ID0gLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJyZXNpemVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IocmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlbGF5KDI1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVUb0N1cnJlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVsYXkoMjUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHVybk9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc2l6ZWQoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSkoKVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiZGVsYXlcIixcbiAgICAgICAgICAgIHZhbHVlOiAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWYgPSBfYXN5bmNUb0dlbmVyYXRvcihyZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlbGF5KF94KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSkoKVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiY2hlY2tJbmRleFwiLFxuICAgICAgICAgICAgdmFsdWU6IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZiA9IF9hc3luY1RvR2VuZXJhdG9yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5jdXJyZW50X3BhZ2UgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9MYXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5jdXJyZW50X3BhZ2UgPT0gdGhpcy5jb3VudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWxheSgyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHVybk9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBjaGVja0luZGV4KCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pKClcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInN0b3BBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzdGFydEFuaW1hdGlvblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcImRyb3BBbmltYXRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcm9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy50aW1lciAhPSAndW5kZWZpbmVkJykgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpLCAzNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiY3JlYXRlQnV0dG9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnV0dG9uKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpLFxuICAgICAgICAgICAgICAgICAgICBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnU1BBTicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlJywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZScpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChzcGFuKTtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNjcm9sbFRvU2xpZGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5TbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5TbGlkZSgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyb3BBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGFuc2l0aW9uX3RpbWVyICE9IG51bGwpIGNsZWFyVGltZW91dCh0aGlzLnRhbnNpdGlvbl90aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFuc2l0aW9uX3RpbWVyID0gc2V0VGltZW91dCh0aGlzLmNoZWNrSW5kZXguYmluZCh0aGlzKSwgMjUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJvcGVuUHJldlNsaWRlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlblByZXZTbGlkZShldmVudCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlLS07XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5OZXh0U2xpZGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuTmV4dFNsaWRlKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UrKztcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwic2Nyb2xsVG9TbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbFRvU2xpZGUoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IHBhcnNlSW50KGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScpLCAxMCk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwicmVwb3NTbGlkZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9zU2xpZGUoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSB0aGlzLnBhZ2luYXRvcl9idXR0b25zW01hdGgubWluKE1hdGgubWF4KHRoaXMuY3VycmVudF9wYWdlLCAwKSwgdGhpcy5jb3VudCAtIDEpXTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmUodGhpcy5jdXJyZW50X3BhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIFNjcm9sbGVyO1xuICAgIH0pKCk7XG5cbiAgICBuZXcgU2Nyb2xsZXIoKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDbGFzcyBoYW5kbGUgc3Vic2NyaXB0aW9uIHByb2Nlc3NcbiAgICAgKi9cblxuICAgIHZhciBTdWJzY3JpYmUgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFN0YXJ0IGluaXRpYWxpemF0aW9uIG9uIGRvbWxvYWRcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqL1xuXG4gICAgICAgIGZ1bmN0aW9uIFN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdWJzY3JpYmUpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZHkgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkaW5nIGV2ZW50cyBhbmQgcHJvcGVydGllc1xuICAgICAgICAgKi9cblxuICAgICAgICBfY3JlYXRlQ2xhc3MoU3Vic2NyaWJlLCBbe1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmUnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb3JtID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0ID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX2VtYWlsJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzX21lc3NhZ2UgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzc19mYWlsID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX2ZhaWwnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3NfcHJvZ3Jlc3MgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfaW4tcHJvZ3Jlc3MnKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5zZXRBdHRyaWJ1dGUoJ25vdmFsaWRhdGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy52YWxpZGF0ZUZvcm0uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQGRlc2NyaXB0aW9uIFZhbGlkYXRpbmcgdXNlciBpbnB1dFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInZhbGlkYXRlRm9ybVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlRm9ybShldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGVtYWlsX3JlZ2V4ID0gbmV3IFJlZ0V4cChcIl4oW2EtekEtWjAtOV9cXC5cXC1dKStcXEAoKFthLXpBLVowLTlcXC1dKStcXC4pKyhbYS16QS1aMC05XXsyLDR9KSskXCIpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPiAwICYmIGVtYWlsX3JlZ2V4LnRlc3QodGhpcy5pbnB1dC52YWx1ZS50cmltKCkpID09PSBmYWxzZSB8fCB0aGlzLmlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPT09IDAgfHwgdGhpcy5pbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBET05FID0gNCxcbiAgICAgICAgICAgICAgICAgICAgT0sgPSAyMDAsXG4gICAgICAgICAgICAgICAgICAgIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICAgICAgICAgICAgICBzZW5kZXIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub3BlbignUE9TVCcsIF90aGlzLmZvcm0uZ2V0QXR0cmlidXRlKCdhY3Rpb24nKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2VuZChuZXcgRm9ybURhdGEoX3RoaXMuZm9ybSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZm9ybS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gT0spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeGhyLnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoeGhyLmNvZGUgKyAnOiAnICsgeGhyLnN0YXR1c1RleHQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdwcm9ncmVzcycpO1xuICAgICAgICAgICAgICAgIHNlbmRlci50aGVuKHRoaXMuc3VjY2Vzcy5iaW5kKHRoaXMpKS5jYXRjaCh0aGlzLmZhaWwuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBzdWNjZWVkZWRcbiAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIHNlcnZlciBhbnN3ZXJcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCdmYWlsJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvbiByZXF1ZXN0IGhhdmUgZmFpbGVkXG4gICAgICAgICAgICAgKiBAcGFyYW0ge0Vycm9yfSBlcnJvciBlcnJvciBvYmplY3RcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogXCJmYWlsXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmFpbChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gU2V0IHN1YnNjcmlwdGlvbiBzdGF0ZVxuICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHN0YXRlIG5ldyBzdGF0ZVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcInNldFN0YXRlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3RhdGUoc3RhdGUpIHtcblxuICAgICAgICAgICAgICAgIHZhciBmYWlsID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImZhaWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzdWNjZXNzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwcm9ncmVzc1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9mYWlsJywgZmFpbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9zdWNjZXNzJywgc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9wcm9ncmVzcycsIHByb2dyZXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHJldHVybiBTdWJzY3JpYmU7XG4gICAgfSkoKTtcblxuICAgIG5ldyBTdWJzY3JpYmUoKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDbGFzcyBoYW5kbGUgdGFicyBsb2FkaW5nXG4gICAgICovXG5cbiAgICB2YXIgVGFicyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG5cbiAgICAgICAgZnVuY3Rpb24gVGFicygpIHtcbiAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUYWJzKTtcblxuICAgICAgICAgICAgdmFyIHJlYWR5ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZGluZyBldmVudHMgYW5kIHByb3BlcnRpZXNcbiAgICAgICAgICovXG5cbiAgICAgICAgX2NyZWF0ZUNsYXNzKFRhYnMsIFt7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYnMnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy53aWRnZXQgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHZhciBET05FID0gNCxcbiAgICAgICAgICAgICAgICAgICAgT0sgPSAyMDAsXG4gICAgICAgICAgICAgICAgICAgIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICAgICAgICAgICAgICBzZW5kZXIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub3BlbignR0VUJywgX3RoaXMud2lkZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS11cmwnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IE9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5jb2RlICsgJzogJyArIHhoci5zdGF0dXNUZXh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5idWlsZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAZGVzY3JpcHRpb24gQnVpbGQgd2lkZ2V0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6IFwiYnVpbGRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKG1lc3NhZ2UucmVwbGFjZSgvXFxuL2csIFwiXFxcXG5cIikucmVwbGFjZSgvXFxyL2csIFwiXFxcXHJcIikucmVwbGFjZSgvXFx0L2csIFwiXFxcXHRcIikucmVwbGFjZSgvXFxmL2csIFwiXFxcXGZcIikpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYiA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZGdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMud2lkZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMud2lkZ2V0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdNRU5VJyk7XG4gICAgICAgICAgICAgICAgbWVudS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndG9vbGJhcicpO1xuICAgICAgICAgICAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZCgndGFic19fbWVudScpO1xuICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LmFwcGVuZENoaWxkKG1lbnUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGRhdGFbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiID0gX3N0ZXAudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdTRUNUSU9OJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRhYi5Db250ZW50LnNwbGl0KCdcXG5cXG4nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0JywgdGFiLlRpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd0YWJzX19idXR0b24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0YWIuVGl0bGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblRhYi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS10YWInLCB0YWIuVGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX3RhYicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gdGV4dFtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMjsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IChfc3RlcDIgPSBfaXRlcmF0b3IyLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYWdyYXBoID0gX3N0ZXAyLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnUCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHBhcmFncmFwaCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1lbnUucXVlcnlTZWxlY3RvcignYnV0dG9uJykuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB0aGlzLndpZGdldC5jbGFzc0xpc3QuYWRkKCd0YWJzX2J1aWxkZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiBcIm9wZW5UYWJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuVGFiKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X3RhYiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIuY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fdGFiX2N1cnJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9idXR0b24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX2J1dHRvbl9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSBidXR0b247XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX19idXR0b25fY3VycmVudCcsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYiA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYj0nICsgdGFyZ2V0ICsgJ10nKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X3RhYiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIuY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fdGFiX2N1cnJlbnQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dKTtcblxuICAgICAgICByZXR1cm4gVGFicztcbiAgICB9KSgpO1xuXG4gICAgbmV3IFRhYnMoKTtcbn0pKCk7IiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9tYXN0ZXIvTElDRU5TRSBmaWxlLiBBblxuICogYWRkaXRpb25hbCBncmFudCBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluXG4gKiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKi9cblxuIShmdW5jdGlvbihnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIHZhciBpbk1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCI7XG4gIHZhciBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZTtcbiAgaWYgKHJ1bnRpbWUpIHtcbiAgICBpZiAoaW5Nb2R1bGUpIHtcbiAgICAgIC8vIElmIHJlZ2VuZXJhdG9yUnVudGltZSBpcyBkZWZpbmVkIGdsb2JhbGx5IGFuZCB3ZSdyZSBpbiBhIG1vZHVsZSxcbiAgICAgIC8vIG1ha2UgdGhlIGV4cG9ydHMgb2JqZWN0IGlkZW50aWNhbCB0byByZWdlbmVyYXRvclJ1bnRpbWUuXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHJ1bnRpbWU7XG4gICAgfVxuICAgIC8vIERvbid0IGJvdGhlciBldmFsdWF0aW5nIHRoZSByZXN0IG9mIHRoaXMgZmlsZSBpZiB0aGUgcnVudGltZSB3YXNcbiAgICAvLyBhbHJlYWR5IGRlZmluZWQgZ2xvYmFsbHkuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRGVmaW5lIHRoZSBydW50aW1lIGdsb2JhbGx5IChhcyBleHBlY3RlZCBieSBnZW5lcmF0ZWQgY29kZSkgYXMgZWl0aGVyXG4gIC8vIG1vZHVsZS5leHBvcnRzIChpZiB3ZSdyZSBpbiBhIG1vZHVsZSkgb3IgYSBuZXcsIGVtcHR5IG9iamVjdC5cbiAgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWUgPSBpbk1vZHVsZSA/IG1vZHVsZS5leHBvcnRzIDoge307XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQsIHRoZW4gb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IuXG4gICAgdmFyIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUoKG91dGVyRm4gfHwgR2VuZXJhdG9yKS5wcm90b3R5cGUpO1xuICAgIHZhciBjb250ZXh0ID0gbmV3IENvbnRleHQodHJ5TG9jc0xpc3QgfHwgW10pO1xuXG4gICAgLy8gVGhlIC5faW52b2tlIG1ldGhvZCB1bmlmaWVzIHRoZSBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcy5cbiAgICBnZW5lcmF0b3IuX2ludm9rZSA9IG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG5cbiAgICByZXR1cm4gZ2VuZXJhdG9yO1xuICB9XG4gIHJ1bnRpbWUud3JhcCA9IHdyYXA7XG5cbiAgLy8gVHJ5L2NhdGNoIGhlbHBlciB0byBtaW5pbWl6ZSBkZW9wdGltaXphdGlvbnMuIFJldHVybnMgYSBjb21wbGV0aW9uXG4gIC8vIHJlY29yZCBsaWtlIGNvbnRleHQudHJ5RW50cmllc1tpXS5jb21wbGV0aW9uLiBUaGlzIGludGVyZmFjZSBjb3VsZFxuICAvLyBoYXZlIGJlZW4gKGFuZCB3YXMgcHJldmlvdXNseSkgZGVzaWduZWQgdG8gdGFrZSBhIGNsb3N1cmUgdG8gYmVcbiAgLy8gaW52b2tlZCB3aXRob3V0IGFyZ3VtZW50cywgYnV0IGluIGFsbCB0aGUgY2FzZXMgd2UgY2FyZSBhYm91dCB3ZVxuICAvLyBhbHJlYWR5IGhhdmUgYW4gZXhpc3RpbmcgbWV0aG9kIHdlIHdhbnQgdG8gY2FsbCwgc28gdGhlcmUncyBubyBuZWVkXG4gIC8vIHRvIGNyZWF0ZSBhIG5ldyBmdW5jdGlvbiBvYmplY3QuIFdlIGNhbiBldmVuIGdldCBhd2F5IHdpdGggYXNzdW1pbmdcbiAgLy8gdGhlIG1ldGhvZCB0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCwgc2luY2UgdGhhdCBoYXBwZW5zIHRvIGJlIHRydWVcbiAgLy8gaW4gZXZlcnkgY2FzZSwgc28gd2UgZG9uJ3QgaGF2ZSB0byB0b3VjaCB0aGUgYXJndW1lbnRzIG9iamVjdC4gVGhlXG4gIC8vIG9ubHkgYWRkaXRpb25hbCBhbGxvY2F0aW9uIHJlcXVpcmVkIGlzIHRoZSBjb21wbGV0aW9uIHJlY29yZCwgd2hpY2hcbiAgLy8gaGFzIGEgc3RhYmxlIHNoYXBlIGFuZCBzbyBob3BlZnVsbHkgc2hvdWxkIGJlIGNoZWFwIHRvIGFsbG9jYXRlLlxuICBmdW5jdGlvbiB0cnlDYXRjaChmbiwgb2JqLCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJub3JtYWxcIiwgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKSB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJ0aHJvd1wiLCBhcmc6IGVyciB9O1xuICAgIH1cbiAgfVxuXG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0ID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCA9IFwic3VzcGVuZGVkWWllbGRcIjtcbiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gXCJleGVjdXRpbmdcIjtcbiAgdmFyIEdlblN0YXRlQ29tcGxldGVkID0gXCJjb21wbGV0ZWRcIjtcblxuICAvLyBSZXR1cm5pbmcgdGhpcyBvYmplY3QgZnJvbSB0aGUgaW5uZXJGbiBoYXMgdGhlIHNhbWUgZWZmZWN0IGFzXG4gIC8vIGJyZWFraW5nIG91dCBvZiB0aGUgZGlzcGF0Y2ggc3dpdGNoIHN0YXRlbWVudC5cbiAgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTtcblxuICAvLyBEdW1teSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMgdGhhdCB3ZSB1c2UgYXMgdGhlIC5jb25zdHJ1Y3RvciBhbmRcbiAgLy8gLmNvbnN0cnVjdG9yLnByb3RvdHlwZSBwcm9wZXJ0aWVzIGZvciBmdW5jdGlvbnMgdGhhdCByZXR1cm4gR2VuZXJhdG9yXG4gIC8vIG9iamVjdHMuIEZvciBmdWxsIHNwZWMgY29tcGxpYW5jZSwgeW91IG1heSB3aXNoIHRvIGNvbmZpZ3VyZSB5b3VyXG4gIC8vIG1pbmlmaWVyIG5vdCB0byBtYW5nbGUgdGhlIG5hbWVzIG9mIHRoZXNlIHR3byBmdW5jdGlvbnMuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fVxuXG4gIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdwLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlW3RvU3RyaW5nVGFnU3ltYm9sXSA9IEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuXG4gIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlXG4gIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgIHByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvclxuICAgICAgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgICAgICAvLyBGb3IgdGhlIG5hdGl2ZSBHZW5lcmF0b3JGdW5jdGlvbiBjb25zdHJ1Y3RvciwgdGhlIGJlc3Qgd2UgY2FuXG4gICAgICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAgICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICAgICA6IGZhbHNlO1xuICB9O1xuXG4gIHJ1bnRpbWUubWFyayA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgaWYgKCEodG9TdHJpbmdUYWdTeW1ib2wgaW4gZ2VuRnVuKSkge1xuICAgICAgICBnZW5GdW5bdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuICAgICAgfVxuICAgIH1cbiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7XG4gICAgcmV0dXJuIGdlbkZ1bjtcbiAgfTtcblxuICAvLyBXaXRoaW4gdGhlIGJvZHkgb2YgYW55IGFzeW5jIGZ1bmN0aW9uLCBgYXdhaXQgeGAgaXMgdHJhbnNmb3JtZWQgdG9cbiAgLy8gYHlpZWxkIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh4KWAsIHNvIHRoYXQgdGhlIHJ1bnRpbWUgY2FuIHRlc3RcbiAgLy8gYHZhbHVlIGluc3RhbmNlb2YgQXdhaXRBcmd1bWVudGAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuIFNvbWUgbWF5IGNvbnNpZGVyIHRoZSBuYW1lIG9mIHRoaXMgbWV0aG9kIHRvb1xuICAvLyBjdXRlc3ksIGJ1dCB0aGV5IGFyZSBjdXJtdWRnZW9ucy5cbiAgcnVudGltZS5hd3JhcCA9IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiBuZXcgQXdhaXRBcmd1bWVudChhcmcpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEF3YWl0QXJndW1lbnQoYXJnKSB7XG4gICAgdGhpcy5hcmcgPSBhcmc7XG4gIH1cblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHJlamVjdChyZWNvcmQuYXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWNvcmQuYXJnO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEF3YWl0QXJndW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlLmFyZykudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgaW52b2tlKFwibmV4dFwiLCB2YWx1ZSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGludm9rZShcInRocm93XCIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24odW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi4gSWYgdGhlIFByb21pc2UgaXMgcmVqZWN0ZWQsIGhvd2V2ZXIsIHRoZVxuICAgICAgICAgIC8vIHJlc3VsdCBmb3IgdGhpcyBpdGVyYXRpb24gd2lsbCBiZSByZWplY3RlZCB3aXRoIHRoZSBzYW1lXG4gICAgICAgICAgLy8gcmVhc29uLiBOb3RlIHRoYXQgcmVqZWN0aW9ucyBvZiB5aWVsZGVkIFByb21pc2VzIGFyZSBub3RcbiAgICAgICAgICAvLyB0aHJvd24gYmFjayBpbnRvIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIGFzIGlzIHRoZSBjYXNlXG4gICAgICAgICAgLy8gd2hlbiBhbiBhd2FpdGVkIFByb21pc2UgaXMgcmVqZWN0ZWQuIFRoaXMgZGlmZmVyZW5jZSBpblxuICAgICAgICAgIC8vIGJlaGF2aW9yIGJldHdlZW4geWllbGQgYW5kIGF3YWl0IGlzIGltcG9ydGFudCwgYmVjYXVzZSBpdFxuICAgICAgICAgIC8vIGFsbG93cyB0aGUgY29uc3VtZXIgdG8gZGVjaWRlIHdoYXQgdG8gZG8gd2l0aCB0aGUgeWllbGRlZFxuICAgICAgICAgIC8vIHJlamVjdGlvbiAoc3dhbGxvdyBpdCBhbmQgY29udGludWUsIG1hbnVhbGx5IC50aHJvdyBpdCBiYWNrXG4gICAgICAgICAgLy8gaW50byB0aGUgZ2VuZXJhdG9yLCBhYmFuZG9uIGl0ZXJhdGlvbiwgd2hhdGV2ZXIpLiBXaXRoXG4gICAgICAgICAgLy8gYXdhaXQsIGJ5IGNvbnRyYXN0LCB0aGVyZSBpcyBubyBvcHBvcnR1bml0eSB0byBleGFtaW5lIHRoZVxuICAgICAgICAgIC8vIHJlamVjdGlvbiByZWFzb24gb3V0c2lkZSB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBzbyB0aGVcbiAgICAgICAgICAvLyBvbmx5IG9wdGlvbiBpcyB0byB0aHJvdyBpdCBmcm9tIHRoZSBhd2FpdCBleHByZXNzaW9uLCBhbmRcbiAgICAgICAgICAvLyBsZXQgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiBoYW5kbGUgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCByZWplY3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiBwcm9jZXNzLmRvbWFpbikge1xuICAgICAgaW52b2tlID0gcHJvY2Vzcy5kb21haW4uYmluZChpbnZva2UpO1xuICAgIH1cblxuICAgIHZhciBwcmV2aW91c1Byb21pc2U7XG5cbiAgICBmdW5jdGlvbiBlbnF1ZXVlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwcmV2aW91c1Byb21pc2UgPVxuICAgICAgICAvLyBJZiBlbnF1ZXVlIGhhcyBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gd2Ugd2FudCB0byB3YWl0IHVudGlsXG4gICAgICAgIC8vIGFsbCBwcmV2aW91cyBQcm9taXNlcyBoYXZlIGJlZW4gcmVzb2x2ZWQgYmVmb3JlIGNhbGxpbmcgaW52b2tlLFxuICAgICAgICAvLyBzbyB0aGF0IHJlc3VsdHMgYXJlIGFsd2F5cyBkZWxpdmVyZWQgaW4gdGhlIGNvcnJlY3Qgb3JkZXIuIElmXG4gICAgICAgIC8vIGVucXVldWUgaGFzIG5vdCBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gaXQgaXMgaW1wb3J0YW50IHRvXG4gICAgICAgIC8vIGNhbGwgaW52b2tlIGltbWVkaWF0ZWx5LCB3aXRob3V0IHdhaXRpbmcgb24gYSBjYWxsYmFjayB0byBmaXJlLFxuICAgICAgICAvLyBzbyB0aGF0IHRoZSBhc3luYyBnZW5lcmF0b3IgZnVuY3Rpb24gaGFzIHRoZSBvcHBvcnR1bml0eSB0byBkb1xuICAgICAgICAvLyBhbnkgbmVjZXNzYXJ5IHNldHVwIGluIGEgcHJlZGljdGFibGUgd2F5LiBUaGlzIHByZWRpY3RhYmlsaXR5XG4gICAgICAgIC8vIGlzIHdoeSB0aGUgUHJvbWlzZSBjb25zdHJ1Y3RvciBzeW5jaHJvbm91c2x5IGludm9rZXMgaXRzXG4gICAgICAgIC8vIGV4ZWN1dG9yIGNhbGxiYWNrLCBhbmQgd2h5IGFzeW5jIGZ1bmN0aW9ucyBzeW5jaHJvbm91c2x5XG4gICAgICAgIC8vIGV4ZWN1dGUgY29kZSBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0LiBTaW5jZSB3ZSBpbXBsZW1lbnQgc2ltcGxlXG4gICAgICAgIC8vIGFzeW5jIGZ1bmN0aW9ucyBpbiB0ZXJtcyBvZiBhc3luYyBnZW5lcmF0b3JzLCBpdCBpcyBlc3BlY2lhbGx5XG4gICAgICAgIC8vIGltcG9ydGFudCB0byBnZXQgdGhpcyByaWdodCwgZXZlbiB0aG91Z2ggaXQgcmVxdWlyZXMgY2FyZS5cbiAgICAgICAgcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oXG4gICAgICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsXG4gICAgICAgICAgLy8gQXZvaWQgcHJvcGFnYXRpbmcgZmFpbHVyZXMgdG8gUHJvbWlzZXMgcmV0dXJuZWQgYnkgbGF0ZXJcbiAgICAgICAgICAvLyBpbnZvY2F0aW9ucyBvZiB0aGUgaXRlcmF0b3IuXG4gICAgICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmdcbiAgICAgICAgKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgfVxuXG4gICAgLy8gRGVmaW5lIHRoZSB1bmlmaWVkIGhlbHBlciBtZXRob2QgdGhhdCBpcyB1c2VkIHRvIGltcGxlbWVudCAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIChzZWUgZGVmaW5lSXRlcmF0b3JNZXRob2RzKS5cbiAgICB0aGlzLl9pbnZva2UgPSBlbnF1ZXVlO1xuICB9XG5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKTtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgcnVudGltZS5hc3luYyA9IGZ1bmN0aW9uKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcihcbiAgICAgIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpXG4gICAgKTtcblxuICAgIHJldHVybiBydW50aW1lLmlzR2VuZXJhdG9yRnVuY3Rpb24ob3V0ZXJGbilcbiAgICAgID8gaXRlciAvLyBJZiBvdXRlckZuIGlzIGEgZ2VuZXJhdG9yLCByZXR1cm4gdGhlIGZ1bGwgaXRlcmF0b3IuXG4gICAgICA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdC5kb25lID8gcmVzdWx0LnZhbHVlIDogaXRlci5uZXh0KCk7XG4gICAgICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgIHZhciBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzpcbiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZVxuICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuICAgICAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgICAgICBpZiAobWV0aG9kID09PSBcInJldHVyblwiIHx8XG4gICAgICAgICAgICAgIChtZXRob2QgPT09IFwidGhyb3dcIiAmJiBkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2RdID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICAvLyBBIHJldHVybiBvciB0aHJvdyAod2hlbiB0aGUgZGVsZWdhdGUgaXRlcmF0b3IgaGFzIG5vIHRocm93XG4gICAgICAgICAgICAvLyBtZXRob2QpIGFsd2F5cyB0ZXJtaW5hdGVzIHRoZSB5aWVsZCogbG9vcC5cbiAgICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgZGVsZWdhdGUgaXRlcmF0b3IgaGFzIGEgcmV0dXJuIG1ldGhvZCwgZ2l2ZSBpdCBhXG4gICAgICAgICAgICAvLyBjaGFuY2UgdG8gY2xlYW4gdXAuXG4gICAgICAgICAgICB2YXIgcmV0dXJuTWV0aG9kID0gZGVsZWdhdGUuaXRlcmF0b3JbXCJyZXR1cm5cIl07XG4gICAgICAgICAgICBpZiAocmV0dXJuTWV0aG9kKSB7XG4gICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChyZXR1cm5NZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBhcmcpO1xuICAgICAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXR1cm4gbWV0aG9kIHRocmV3IGFuIGV4Y2VwdGlvbiwgbGV0IHRoYXRcbiAgICAgICAgICAgICAgICAvLyBleGNlcHRpb24gcHJldmFpbCBvdmVyIHRoZSBvcmlnaW5hbCByZXR1cm4gb3IgdGhyb3cuXG4gICAgICAgICAgICAgICAgbWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICAgICAgICAgIGFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICAgICAgICAvLyBDb250aW51ZSB3aXRoIHRoZSBvdXRlciByZXR1cm4sIG5vdyB0aGF0IHRoZSBkZWxlZ2F0ZVxuICAgICAgICAgICAgICAvLyBpdGVyYXRvciBoYXMgYmVlbiB0ZXJtaW5hdGVkLlxuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goXG4gICAgICAgICAgICBkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2RdLFxuICAgICAgICAgICAgZGVsZWdhdGUuaXRlcmF0b3IsXG4gICAgICAgICAgICBhcmdcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBMaWtlIHJldHVybmluZyBnZW5lcmF0b3IudGhyb3codW5jYXVnaHQpLCBidXQgd2l0aG91dCB0aGVcbiAgICAgICAgICAgIC8vIG92ZXJoZWFkIG9mIGFuIGV4dHJhIGZ1bmN0aW9uIGNhbGwuXG4gICAgICAgICAgICBtZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgICBhcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRGVsZWdhdGUgZ2VuZXJhdG9yIHJhbiBhbmQgaGFuZGxlZCBpdHMgb3duIGV4Y2VwdGlvbnMgc29cbiAgICAgICAgICAvLyByZWdhcmRsZXNzIG9mIHdoYXQgdGhlIG1ldGhvZCB3YXMsIHdlIGNvbnRpbnVlIGFzIGlmIGl0IGlzXG4gICAgICAgICAgLy8gXCJuZXh0XCIgd2l0aCBhbiB1bmRlZmluZWQgYXJnLlxuICAgICAgICAgIG1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcbiAgICAgICAgICBpZiAoaW5mby5kb25lKSB7XG4gICAgICAgICAgICBjb250ZXh0W2RlbGVnYXRlLnJlc3VsdE5hbWVdID0gaW5mby52YWx1ZTtcbiAgICAgICAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkWWllbGQpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc2VudCA9IGFyZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dC5zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0KSB7XG4gICAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGFyZykpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBkaXNwYXRjaGVkIGV4Y2VwdGlvbiB3YXMgY2F1Z2h0IGJ5IGEgY2F0Y2ggYmxvY2ssXG4gICAgICAgICAgICAvLyB0aGVuIGxldCB0aGF0IGNhdGNoIGJsb2NrIGhhbmRsZSB0aGUgZXhjZXB0aW9uIG5vcm1hbGx5LlxuICAgICAgICAgICAgbWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgICBhcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgYXJnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlID0gR2VuU3RhdGVFeGVjdXRpbmc7XG5cbiAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIpIHtcbiAgICAgICAgICAvLyBJZiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGZyb20gaW5uZXJGbiwgd2UgbGVhdmUgc3RhdGUgPT09XG4gICAgICAgICAgLy8gR2VuU3RhdGVFeGVjdXRpbmcgYW5kIGxvb3AgYmFjayBmb3IgYW5vdGhlciBpbnZvY2F0aW9uLlxuICAgICAgICAgIHN0YXRlID0gY29udGV4dC5kb25lXG4gICAgICAgICAgICA/IEdlblN0YXRlQ29tcGxldGVkXG4gICAgICAgICAgICA6IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7XG5cbiAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgIHZhbHVlOiByZWNvcmQuYXJnLFxuICAgICAgICAgICAgZG9uZTogY29udGV4dC5kb25lXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBpZiAoY29udGV4dC5kZWxlZ2F0ZSAmJiBtZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0XG4gICAgICAgICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS5cbiAgICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAvLyBEaXNwYXRjaCB0aGUgZXhjZXB0aW9uIGJ5IGxvb3BpbmcgYmFjayBhcm91bmQgdG8gdGhlXG4gICAgICAgICAgLy8gY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihhcmcpIGNhbGwgYWJvdmUuXG4gICAgICAgICAgbWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICAgIGFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gRGVmaW5lIEdlbmVyYXRvci5wcm90b3R5cGUue25leHQsdGhyb3cscmV0dXJufSBpbiB0ZXJtcyBvZiB0aGVcbiAgLy8gdW5pZmllZCAuX2ludm9rZSBoZWxwZXIgbWV0aG9kLlxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoR3ApO1xuXG4gIEdwW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEdwW3RvU3RyaW5nVGFnU3ltYm9sXSA9IFwiR2VuZXJhdG9yXCI7XG5cbiAgR3AudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfTtcblxuICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykge1xuICAgIHZhciBlbnRyeSA9IHsgdHJ5TG9jOiBsb2NzWzBdIH07XG5cbiAgICBpZiAoMSBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV07XG4gICAgfVxuXG4gICAgaWYgKDIgaW4gbG9jcykge1xuICAgICAgZW50cnkuZmluYWxseUxvYyA9IGxvY3NbMl07XG4gICAgICBlbnRyeS5hZnRlckxvYyA9IGxvY3NbM107XG4gICAgfVxuXG4gICAgdGhpcy50cnlFbnRyaWVzLnB1c2goZW50cnkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVzZXRUcnlFbnRyeShlbnRyeSkge1xuICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uIHx8IHt9O1xuICAgIHJlY29yZC50eXBlID0gXCJub3JtYWxcIjtcbiAgICBkZWxldGUgcmVjb3JkLmFyZztcbiAgICBlbnRyeS5jb21wbGV0aW9uID0gcmVjb3JkO1xuICB9XG5cbiAgZnVuY3Rpb24gQ29udGV4dCh0cnlMb2NzTGlzdCkge1xuICAgIC8vIFRoZSByb290IGVudHJ5IG9iamVjdCAoZWZmZWN0aXZlbHkgYSB0cnkgc3RhdGVtZW50IHdpdGhvdXQgYSBjYXRjaFxuICAgIC8vIG9yIGEgZmluYWxseSBibG9jaykgZ2l2ZXMgdXMgYSBwbGFjZSB0byBzdG9yZSB2YWx1ZXMgdGhyb3duIGZyb21cbiAgICAvLyBsb2NhdGlvbnMgd2hlcmUgdGhlcmUgaXMgbm8gZW5jbG9zaW5nIHRyeSBzdGF0ZW1lbnQuXG4gICAgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiBcInJvb3RcIiB9XTtcbiAgICB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyk7XG4gICAgdGhpcy5yZXNldCh0cnVlKTtcbiAgfVxuXG4gIHJ1bnRpbWUua2V5cyA9IGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgfVxuICAgIGtleXMucmV2ZXJzZSgpO1xuXG4gICAgLy8gUmF0aGVyIHRoYW4gcmV0dXJuaW5nIGFuIG9iamVjdCB3aXRoIGEgbmV4dCBtZXRob2QsIHdlIGtlZXBcbiAgICAvLyB0aGluZ3Mgc2ltcGxlIGFuZCByZXR1cm4gdGhlIG5leHQgZnVuY3Rpb24gaXRzZWxmLlxuICAgIHJldHVybiBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgd2hpbGUgKGtleXMubGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzLnBvcCgpO1xuICAgICAgICBpZiAoa2V5IGluIG9iamVjdCkge1xuICAgICAgICAgIG5leHQudmFsdWUgPSBrZXk7XG4gICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVG8gYXZvaWQgY3JlYXRpbmcgYW4gYWRkaXRpb25hbCBvYmplY3QsIHdlIGp1c3QgaGFuZyB0aGUgLnZhbHVlXG4gICAgICAvLyBhbmQgLmRvbmUgcHJvcGVydGllcyBvZmYgdGhlIG5leHQgZnVuY3Rpb24gb2JqZWN0IGl0c2VsZi4gVGhpc1xuICAgICAgLy8gYWxzbyBlbnN1cmVzIHRoYXQgdGhlIG1pbmlmaWVyIHdpbGwgbm90IGFub255bWl6ZSB0aGUgZnVuY3Rpb24uXG4gICAgICBuZXh0LmRvbmUgPSB0cnVlO1xuICAgICAgcmV0dXJuIG5leHQ7XG4gICAgfTtcbiAgfTtcblxuICBmdW5jdGlvbiB2YWx1ZXMoaXRlcmFibGUpIHtcbiAgICBpZiAoaXRlcmFibGUpIHtcbiAgICAgIHZhciBpdGVyYXRvck1ldGhvZCA9IGl0ZXJhYmxlW2l0ZXJhdG9yU3ltYm9sXTtcbiAgICAgIGlmIChpdGVyYXRvck1ldGhvZCkge1xuICAgICAgICByZXR1cm4gaXRlcmF0b3JNZXRob2QuY2FsbChpdGVyYWJsZSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgaXRlcmFibGUubmV4dCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBpdGVyYWJsZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc05hTihpdGVyYWJsZS5sZW5ndGgpKSB7XG4gICAgICAgIHZhciBpID0gLTEsIG5leHQgPSBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICAgIHdoaWxlICgrK2kgPCBpdGVyYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChpdGVyYWJsZSwgaSkpIHtcbiAgICAgICAgICAgICAgbmV4dC52YWx1ZSA9IGl0ZXJhYmxlW2ldO1xuICAgICAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbmV4dC52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBuZXh0LmRvbmUgPSB0cnVlO1xuXG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGFuIGl0ZXJhdG9yIHdpdGggbm8gdmFsdWVzLlxuICAgIHJldHVybiB7IG5leHQ6IGRvbmVSZXN1bHQgfTtcbiAgfVxuICBydW50aW1lLnZhbHVlcyA9IHZhbHVlcztcblxuICBmdW5jdGlvbiBkb25lUmVzdWx0KCkge1xuICAgIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgfVxuXG4gIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKHNraXBUZW1wUmVzZXQpIHtcbiAgICAgIHRoaXMucHJldiA9IDA7XG4gICAgICB0aGlzLm5leHQgPSAwO1xuICAgICAgdGhpcy5zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICB0aGlzLmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSk7XG5cbiAgICAgIGlmICghc2tpcFRlbXBSZXNldCkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHtcbiAgICAgICAgICAvLyBOb3Qgc3VyZSBhYm91dCB0aGUgb3B0aW1hbCBvcmRlciBvZiB0aGVzZSBjb25kaXRpb25zOlxuICAgICAgICAgIGlmIChuYW1lLmNoYXJBdCgwKSA9PT0gXCJ0XCIgJiZcbiAgICAgICAgICAgICAgaGFzT3duLmNhbGwodGhpcywgbmFtZSkgJiZcbiAgICAgICAgICAgICAgIWlzTmFOKCtuYW1lLnNsaWNlKDEpKSkge1xuICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuXG4gICAgICB2YXIgcm9vdEVudHJ5ID0gdGhpcy50cnlFbnRyaWVzWzBdO1xuICAgICAgdmFyIHJvb3RSZWNvcmQgPSByb290RW50cnkuY29tcGxldGlvbjtcbiAgICAgIGlmIChyb290UmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByb290UmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucnZhbDtcbiAgICB9LFxuXG4gICAgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uKGV4Y2VwdGlvbikge1xuICAgICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgICB0aHJvdyBleGNlcHRpb247XG4gICAgICB9XG5cbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcztcbiAgICAgIGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkge1xuICAgICAgICByZWNvcmQudHlwZSA9IFwidGhyb3dcIjtcbiAgICAgICAgcmVjb3JkLmFyZyA9IGV4Y2VwdGlvbjtcbiAgICAgICAgY29udGV4dC5uZXh0ID0gbG9jO1xuICAgICAgICByZXR1cm4gISFjYXVnaHQ7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSBcInJvb3RcIikge1xuICAgICAgICAgIC8vIEV4Y2VwdGlvbiB0aHJvd24gb3V0c2lkZSBvZiBhbnkgdHJ5IGJsb2NrIHRoYXQgY291bGQgaGFuZGxlXG4gICAgICAgICAgLy8gaXQsIHNvIHNldCB0aGUgY29tcGxldGlvbiB2YWx1ZSBvZiB0aGUgZW50aXJlIGZ1bmN0aW9uIHRvXG4gICAgICAgICAgLy8gdGhyb3cgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXR1cm4gaGFuZGxlKFwiZW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHtcbiAgICAgICAgICB2YXIgaGFzQ2F0Y2ggPSBoYXNPd24uY2FsbChlbnRyeSwgXCJjYXRjaExvY1wiKTtcbiAgICAgICAgICB2YXIgaGFzRmluYWxseSA9IGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIik7XG5cbiAgICAgICAgICBpZiAoaGFzQ2F0Y2ggJiYgaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NhdGNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIGFicnVwdDogZnVuY3Rpb24odHlwZSwgYXJnKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiZcbiAgICAgICAgICAgIGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIikgJiZcbiAgICAgICAgICAgIHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB2YXIgZmluYWxseUVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSAmJlxuICAgICAgICAgICh0eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICAgdHlwZSA9PT0gXCJjb250aW51ZVwiKSAmJlxuICAgICAgICAgIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmXG4gICAgICAgICAgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGFcbiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLlxuICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJlY29yZC50eXBlID0gdHlwZTtcbiAgICAgIHJlY29yZC5hcmcgPSBhcmc7XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNvbXBsZXRlKHJlY29yZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICByZWNvcmQudHlwZSA9PT0gXCJjb250aW51ZVwiKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IHJlY29yZC5hcmc7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInJldHVyblwiKSB7XG4gICAgICAgIHRoaXMucnZhbCA9IHJlY29yZC5hcmc7XG4gICAgICAgIHRoaXMubmV4dCA9IFwiZW5kXCI7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcIm5vcm1hbFwiICYmIGFmdGVyTG9jKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IGFmdGVyTG9jO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBmaW5pc2g6IGZ1bmN0aW9uKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykge1xuICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpO1xuICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24odHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlID0ge1xuICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSxcbiAgICAgICAgbmV4dExvYzogbmV4dExvY1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuICB9O1xufSkoXG4gIC8vIEFtb25nIHRoZSB2YXJpb3VzIHRyaWNrcyBmb3Igb2J0YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBnbG9iYWxcbiAgLy8gb2JqZWN0LCB0aGlzIHNlZW1zIHRvIGJlIHRoZSBtb3N0IHJlbGlhYmxlIHRlY2huaXF1ZSB0aGF0IGRvZXMgbm90XG4gIC8vIHVzZSBpbmRpcmVjdCBldmFsICh3aGljaCB2aW9sYXRlcyBDb250ZW50IFNlY3VyaXR5IFBvbGljeSkuXG4gIHR5cGVvZiBnbG9iYWwgPT09IFwib2JqZWN0XCIgPyBnbG9iYWwgOlxuICB0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiID8gd2luZG93IDpcbiAgdHlwZW9mIHNlbGYgPT09IFwib2JqZWN0XCIgPyBzZWxmIDogdGhpc1xuKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuKGZ1bmN0aW9uICgpIHtcbiAgICBjbGFzcyBGYXZvcml0ZXMge1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGUnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZhdm9yaXRlcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgcHJvZHVjdHMgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdCcpO1xuICAgICAgICAgICAgdGhpcy5jb3VudCA9IHByb2R1Y3RzLmxlbmd0aDtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvdW50ID09IDApe1xuICAgICAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5mYXZvcml0ZXMpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZhdm9yaXRlcztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbnMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjc3N0cmFuc2l0aW9ucycpO1xuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm1zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY3NzdHJhbnNmb3JtcycpO1xuXG4gICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX3dyYXBwZXItaW5uZXInKTtcblxuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbiA9IHRoaXMuZmF2b3JpdGVzLnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZV9fYnV0dG9uX25leHQnKTtcbiAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24gPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX2J1dHRvbl9wcmV2Jyk7XG4gICAgICAgICAgICB0aGlzLm1lbnUgPSB0aGlzLmZhdm9yaXRlcy5xdWVyeVNlbGVjdG9yKCcuZmF2b3JpdGVfX21lbnUnKTtcblxuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMubmV4dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnByZXYuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIHRoaXMubWFyZ2luID0gMjA7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHByb2R1Y3RzWzBdLm9mZnNldFdpZHRoICsgdGhpcy5tYXJnaW47XG4gICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCt0aGlzLm1hcmdpbikvdGhpcy53aWR0aCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlubGluZT49dGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Zhdm9yaXRlX19tZW51X2hpZGRlbicsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBudWxsO1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdHJhbnNFbmRFdmVudE5hbWVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1dlYmtpdFRyYW5zaXRpb24nOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnTW96VHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdPVHJhbnNpdGlvbic6ICdvVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXNUcmFuc2l0aW9uJzogJ01TVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKHRyYW5zRW5kRXZlbnROYW1lc1tNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0sIHRoaXMuc3RvcEFuaW1hdGlvbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXJ0QW5pbWF0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0b3BBbmltYXRpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudGltZXIgIT0gbnVsbCkgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRyb3BBbmltYXRpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudGltZXIgIT0gbnVsbCkgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQodGhpcy5zdG9wQW5pbWF0aW9uLmJpbmQodGhpcyksIDI1MCk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXh0IChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50Kys7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IHRoaXMuY291bnQtdGhpcy5pbmxpbmUrMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjcm9sbCgpO1xuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBwcmV2IChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50LS07XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5jb3VudC10aGlzLmlubGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsKCk7XG4gICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc2l6ZSAoKSB7XG4gICAgICAgICAgICB0aGlzLmlubGluZSA9IE1hdGguZmxvb3IoKHRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCt0aGlzLm1hcmdpbikvdGhpcy53aWR0aCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlubGluZT49dGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmYXZvcml0ZV9fbWVudV9oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnZmF2b3JpdGVfX21lbnVfaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY3JvbGwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjcm9sbCAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50cmFuc2Zvcm1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNmb3JtJyldID0gJ3RyYW5zbGF0ZVgoJyArICgtdGhpcy53aWR0aCAqICh0aGlzLmN1cnJlbnQpKSArICdweCknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUucmlnaHQgPSAoLXRoaXMud2lkdGggKiAodGhpcy5jdXJyZW50KSkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kcm9wQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXcgRmF2b3JpdGVzO1xuXG59KSgpXG4iLCJcInVzZSBzdHJpY3RcIjtcbihmdW5jdGlvbiAoKSB7XG4gICAgY2xhc3MgTmF2aWdhdGlvbiB7XG5cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXQgKCkge1xuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb24nKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdmlnYXRpb24gPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgbGV0IGxhYmVscyA9IHRoaXMubmF2aWdhdGlvbi5xdWVyeVNlbGVjdG9yQWxsKCcubmF2aWdhdGlvbl9fbGFiZWwnKTtcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChsYWJlbHMsIGxhYmVsID0+IHtcbiAgICAgICAgICAgICAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlbkRyb3Bkb3duLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMudG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb25fX3RvZ2dsZScpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZU5hdmlnYXRpb24uYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICB0b2dnbGVOYXZpZ2F0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCduYXZpZ2F0aW9uX29wZW4nKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlLmJsdXIoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnbmF2aWdhdGlvbl9vcGVuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBvcGVuRHJvcGRvd24gKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fX2xhYmVsX29wZW4nKTtcbiAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoJ25hdmlnYXRpb25fX2NvbnRhaW5lcl9vcGVuJyk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIG5ldyBOYXZpZ2F0aW9uO1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuKGZ1bmN0aW9uICgpIHtcbiAgICBjbGFzcyBTY3JvbGxlciB7XG5cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyJyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbGVyID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuc2Nyb2xsZXIucXVlcnlTZWxlY3RvcignLnNjcm9sbGVyX193cmFwcGVyLWlubmVyJyk7XG4gICAgICAgICAgICB0aGlzLnNsaWRlcyA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZXJfX3NsaWRlJyk7XG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zbGlkZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNsaWRlcyk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMud3JhcHBlcjtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zbGlkZXM7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2Nyb2xsZXI7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY291bnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnY3NzdHJhbnNpdGlvbnMnKTtcbiAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtcyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2Nzc3RyYW5zZm9ybXMnKTtcblxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IgPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fcGFnaW5hdG9yJyk7XG4gICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuc2Nyb2xsZXJfX3ByZXYnKTtcbiAgICAgICAgICAgIHRoaXMubmV4dF9idXR0b24gPSB0aGlzLnNjcm9sbGVyLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGxlcl9fbmV4dCcpO1xuXG4gICAgICAgICAgICB0aGlzLnByZXZfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vcGVuUHJldlNsaWRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3Blbk5leHRTbGlkZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgbGV0IGZpcnN0X3NsaWRlID0gdGhpcy5zbGlkZXNbMF0uY2xvbmVOb2RlKHRydWUpXG4gICAgICAgICAgICAgICAgLCBsYXN0X3NsaWRlID0gdGhpcy5zbGlkZXNbdGhpcy5jb3VudCAtIDFdLmNsb25lTm9kZSh0cnVlKTtcblxuICAgICAgICAgICAgZmlyc3Rfc2xpZGUuY2xhc3NMaXN0LmFkZCgnY2xvbmVkJyk7XG4gICAgICAgICAgICBsYXN0X3NsaWRlLmNsYXNzTGlzdC5hZGQoJ2Nsb25lZCcpO1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyLmFwcGVuZENoaWxkKGZpcnN0X3NsaWRlKTtcbiAgICAgICAgICAgIHRoaXMud3JhcHBlci5pbnNlcnRCZWZvcmUobGFzdF9zbGlkZSwgdGhpcy5zbGlkZXNbMF0pO1xuXG4gICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmNvdW50O1xuICAgICAgICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbih0aGlzLmNvdW50IC0gaW5kZXggLSAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSAwO1xuICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3JfYnV0dG9ucyA9IHRoaXMucGFnaW5hdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY3JvbGxlcl9fcGFnZScpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IHRoaXMucGFnaW5hdG9yX2J1dHRvbnNbMF07XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Njcm9sbGVyX19wYWdlX2N1cnJlbnQnKTtcblxuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMudGFuc2l0aW9uX3RpbWVyID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdHJhbnNFbmRFdmVudE5hbWVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1dlYmtpdFRyYW5zaXRpb24nOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnTW96VHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdPVHJhbnNpdGlvbic6ICdvVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXNUcmFuc2l0aW9uJzogJ01TVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKHRyYW5zRW5kRXZlbnROYW1lc1tNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zaXRpb24nKV0sIHRoaXMuY2hlY2tJbmRleC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5tb3ZlVG9GaXJzdCgpLmRlbGF5KCkudGhlbih0aGlzLnR1cm5Pbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBtb3ZlVG9DdXJyZW50KCkge1xuICAgICAgICAgICAgdGhpcy5tb3ZlKHRoaXMuY3VycmVudF9wYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgbW92ZVRvRmlyc3QoKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSA9IDA7XG4gICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgbW92ZVRvTGFzdCgpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wYWdlID0gdGhpcy5jb3VudCAtIDE7XG4gICAgICAgICAgICB0aGlzLnJlcG9zU2xpZGUoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgdHVybk9uKCkge1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSA9IE1vZGVybml6ci5wcmVmaXhlZCgndHJhbnNmb3JtJykgKyAnIC4yNXMnO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICB0dXJuT2ZmKCkge1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyLnN0eWxlW01vZGVybml6ci5wcmVmaXhlZCgndHJhbnNpdGlvbicpXSA9ICdub25lJztcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgbW92ZShpbmRleCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5zdHlsZVtNb2Rlcm5penIucHJlZml4ZWQoJ3RyYW5zZm9ybScpXSA9ICd0cmFuc2xhdGVYKCcgKyAoLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpKSArICdweCknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUucmlnaHQgPSAoLXRoaXMud3JhcHBlci5vZmZzZXRXaWR0aCAqIChpbmRleCArIDEpKSArICdweCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyByZXNpemVkKCkge1xuICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgIHRoaXMubW92ZVRvQ3VycmVudCgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgZGVsYXkobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBjaGVja0luZGV4KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9wYWdlID09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlVG9MYXN0KCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgyNSk7XG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50X3BhZ2UgPT0gdGhpcy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGVsYXkoMjUpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRvRmlyc3QoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KDI1KTtcbiAgICAgICAgICAgICAgICB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICBzdG9wQW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZHJvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKHRoaXMudGltZXIpICE9ICd1bmRlZmluZWQnKSBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCh0aGlzLnN0b3BBbmltYXRpb24uYmluZCh0aGlzKSwgMzUwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZUJ1dHRvbihpbmRleCkge1xuICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0JVVFRPTicpLCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnU1BBTicpO1xuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScsIGluZGV4KTtcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdzY3JvbGxlcl9fcGFnZScpO1xuICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zY3JvbGxUb1NsaWRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9wZW5TbGlkZSgpIHtcbiAgICAgICAgICAgIHRoaXMucmVwb3NTbGlkZSgpO1xuICAgICAgICAgICAgdGhpcy5kcm9wQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBpZighdGhpcy50cmFuc2l0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhbnNpdGlvbl90aW1lciE9bnVsbCkgY2xlYXJUaW1lb3V0KHRoaXMudGFuc2l0aW9uX3RpbWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRhbnNpdGlvbl90aW1lciA9IHNldFRpbWVvdXQodGhpcy5jaGVja0luZGV4LmJpbmQodGhpcyksIDI1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBvcGVuUHJldlNsaWRlKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gPT09IHRydWUpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UtLTtcbiAgICAgICAgICAgIHRoaXMucHJldl9idXR0b24uYmx1cigpO1xuICAgICAgICAgICAgdGhpcy5vcGVuU2xpZGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9wZW5OZXh0U2xpZGUoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiA9PT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcGFnZSsrO1xuICAgICAgICAgICAgdGhpcy5uZXh0X2J1dHRvbi5ibHVyKCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5TbGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2Nyb2xsVG9TbGlkZShldmVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uID09PSB0cnVlKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW9uKCk7XG5cbiAgICAgICAgICAgIGxldCBidXR0b24gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3BhZ2UgPSBwYXJzZUludChidXR0b24uZ2V0QXR0cmlidXRlKCdkYXRhLXBhZ2UnKSwgMTApO1xuICAgICAgICAgICAgYnV0dG9uLmJsdXIoKTtcbiAgICAgICAgICAgIHRoaXMub3BlblNsaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXBvc1NsaWRlKCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbiA9IHRoaXMucGFnaW5hdG9yX2J1dHRvbnNbTWF0aC5taW4oTWF0aC5tYXgodGhpcy5jdXJyZW50X3BhZ2UsIDApLCB0aGlzLmNvdW50IC0gMSldO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdzY3JvbGxlcl9fcGFnZV9jdXJyZW50JywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLm1vdmUodGhpcy5jdXJyZW50X3BhZ2UpO1xuICAgICAgICB9XG5cbiAgICB9XG4gICAgbmV3IFNjcm9sbGVyO1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuKGZ1bmN0aW9uKCkge1xuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDbGFzcyBoYW5kbGUgc3Vic2NyaXB0aW9uIHByb2Nlc3NcbiAgICAgKi9cbiAgICBjbGFzcyBTdWJzY3JpYmUge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFN0YXJ0IGluaXRpYWxpemF0aW9uIG9uIGRvbWxvYWRcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIGxldCByZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkaW5nIGV2ZW50cyBhbmQgcHJvcGVydGllc1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdCgpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmUnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZvcm0gPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICAgICAgdGhpcy5pbnB1dCA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlX19lbWFpbCcpO1xuICAgICAgICAgICAgdGhpcy5zdWNjZXNzX21lc3NhZ2UgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfc3VjY2VzcycpO1xuICAgICAgICAgICAgdGhpcy5zdWNjZXNzX2ZhaWwgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZV9fc3RhdGVfZmFpbCcpO1xuICAgICAgICAgICAgdGhpcy5zdWNjZXNzX3Byb2dyZXNzID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmVfX3N0YXRlX2luLXByb2dyZXNzJyk7XG5cbiAgICAgICAgICAgIHRoaXMuZm9ybS5zZXRBdHRyaWJ1dGUoJ25vdmFsaWRhdGUnLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnZhbGlkYXRlRm9ybS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gVmFsaWRhdGluZyB1c2VyIGlucHV0XG4gICAgICAgICAqL1xuICAgICAgICB2YWxpZGF0ZUZvcm0oZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGxldCBlbWFpbF9yZWdleCA9IG5ldyBSZWdFeHAoXCJeKFthLXpBLVowLTlfXFwuXFwtXSkrXFxAKChbYS16QS1aMC05XFwtXSkrXFwuKSsoW2EtekEtWjAtOV17Miw0fSkrJFwiKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAodGhpcy5pbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID4gMCAmJiBlbWFpbF9yZWdleC50ZXN0KHRoaXMuaW5wdXQudmFsdWUudHJpbSgpKSA9PT0gZmFsc2UgfHwgdGhpcy5pbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgIHx8ICh0aGlzLmlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICApe1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBET05FID0gNFxuICAgICAgICAgICAgICAgICwgT0sgPSAyMDBcbiAgICAgICAgICAgICAgICAsIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG4gICAgICAgICAgICAgICAgLCBzZW5kZXIgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIub3BlbignUE9TVCcsIHRoaXMuZm9ybS5nZXRBdHRyaWJ1dGUoJ2FjdGlvbicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZW5kKG5ldyBGb3JtRGF0YSh0aGlzLmZvcm0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSBET05FKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSBPSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuY29kZSArICc6ICcgKyB4aHIuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgncHJvZ3Jlc3MnKTtcbiAgICAgICAgICAgIHNlbmRlci50aGVuKHRoaXMuc3VjY2Vzcy5iaW5kKHRoaXMpKS5jYXRjaCh0aGlzLmZhaWwuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIHJlcXVlc3QgaGF2ZSBzdWNjZWVkZWRcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2Ugc2VydmVyIGFuc3dlclxuICAgICAgICAgKi9cbiAgICAgICAgc3VjY2VzcyAobWVzc2FnZSkge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG4gICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3Mpe1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnZmFpbCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiByZXF1ZXN0IGhhdmUgZmFpbGVkXG4gICAgICAgICAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIGVycm9yIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgZmFpbCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2ZhaWwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU2V0IHN1YnNjcmlwdGlvbiBzdGF0ZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RhdGUgbmV3IHN0YXRlXG4gICAgICAgICAqL1xuICAgICAgICBzZXRTdGF0ZSAoc3RhdGUpIHtcblxuICAgICAgICAgICAgbGV0IGZhaWwgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSBmYWxzZTtcblxuICAgICAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJmYWlsXCI6XG4gICAgICAgICAgICAgICAgICAgIGZhaWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzdWNjZXNzXCI6XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmJsdXIoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInByb2dyZXNzXCI6XG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZm9ybS5jbGFzc0xpc3QudG9nZ2xlKCdzdWJzY3JpYmVfZmFpbCcsIGZhaWwpO1xuICAgICAgICAgICAgdGhpcy5mb3JtLmNsYXNzTGlzdC50b2dnbGUoJ3N1YnNjcmliZV9zdWNjZXNzJywgc3VjY2Vzcyk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnc3Vic2NyaWJlX3Byb2dyZXNzJywgcHJvZ3Jlc3MpO1xuICAgICAgICB9XG5cbiAgICB9XG4gICAgbmV3IFN1YnNjcmliZTtcbn0pKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbihmdW5jdGlvbigpIHtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgQ2xhc3MgaGFuZGxlIHRhYnMgbG9hZGluZ1xuICAgICAqL1xuICAgIGNsYXNzIFRhYnMge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFN0YXJ0IGluaXRpYWxpemF0aW9uIG9uIGRvbWxvYWRcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIGxldCByZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImxvYWRpbmdcIikgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWFkeS50aGVuKHRoaXMuaW5pdC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkaW5nIGV2ZW50cyBhbmQgcHJvcGVydGllc1xuICAgICAgICAgKi9cbiAgICAgICAgaW5pdCgpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYnMnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLndpZGdldCA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgRE9ORSA9IDRcbiAgICAgICAgICAgICAgICAsIE9LID0gMjAwXG4gICAgICAgICAgICAgICAgLCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICAgICAgICAgICwgc2VuZGVyID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHRoaXMud2lkZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS11cmwnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IERPTkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSBPSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeGhyLnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuY29kZSArICc6ICcgKyB4aHIuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2VuZGVyLnRoZW4odGhpcy5idWlsZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQnVpbGQgd2lkZ2V0XG4gICAgICAgICAqL1xuICAgICAgICBidWlsZCAobWVzc2FnZSkge1xuICAgICAgICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKG1lc3NhZ2UucmVwbGFjZSgvXFxuL2csIFwiXFxcXG5cIikucmVwbGFjZSgvXFxyL2csIFwiXFxcXHJcIikucmVwbGFjZSgvXFx0L2csIFwiXFxcXHRcIikucmVwbGFjZSgvXFxmL2csIFwiXFxcXGZcIikpO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMud2lkZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy53aWRnZXQpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLndpZGdldDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnTUVOVScpO1xuICAgICAgICAgICAgbWVudS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndG9vbGJhcicpO1xuICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QuYWRkKCd0YWJzX19tZW51Jyk7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5hcHBlbmRDaGlsZChtZW51KTtcblxuICAgICAgICAgICAgZm9yIChsZXQgdGFiIG9mIGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIGxldCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKVxuICAgICAgICAgICAgICAgICAgICAsIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NFQ1RJT04nKVxuICAgICAgICAgICAgICAgICAgICAsIHRleHQgPSB0YWIuQ29udGVudC5zcGxpdCgnXFxuXFxuJyk7XG5cbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0JywgdGFiLlRpdGxlKTtcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgndGFic19fYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRhYi5UaXRsZSkpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlblRhYi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBtZW51LmFwcGVuZENoaWxkKGJ1dHRvbik7XG5cbiAgICAgICAgICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRhYicsIHRhYi5UaXRsZSk7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX3RhYicpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgcGFyYWdyYXBoIG9mIHRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdQJyk7XG4gICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocGFyYWdyYXBoKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLndpZGdldC5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpLmNsaWNrKCk7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5jbGFzc0xpc3QuYWRkKCd0YWJzX2J1aWxkZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9wZW5UYWIgKGV2ZW50KSB7XG4gICAgICAgICAgICBsZXQgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldFxuICAgICAgICAgICAgICAgICwgdGFyZ2V0ID0gYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF90YWIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIuY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fdGFiX2N1cnJlbnQnLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRfYnV0dG9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ3RhYnNfX2J1dHRvbl9jdXJyZW50JywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gYnV0dG9uO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCd0YWJzX19idXR0b25fY3VycmVudCcsIHRydWUpO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gdGhpcy53aWRnZXQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiPScgKyB0YXJnZXQgKyAnXScpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF90YWIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIuY2xhc3NMaXN0LnRvZ2dsZSgndGFic19fdGFiX2N1cnJlbnQnLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5ldyBUYWJzO1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
